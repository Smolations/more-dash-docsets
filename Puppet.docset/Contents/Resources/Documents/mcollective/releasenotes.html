<!DOCTYPE html>
<html dir="ltr" lang="en-US">
  <head>
  	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  	<title>Release Notes — Documentation — Puppet Labs</title>
  	<link rel="alternate" type="application/atom+xml" title="Puppet Labs Documentation Updates" href="https://github.com/puppetlabs/puppet-docs/commits/master.atom">
    <link rel="alternate" type="application/atom+xml" title="Puppet Labs Blog Feed" href="http://puppetlabs.com/feed/atom/">
    <link rel='index' title='Puppet Labs Documentation' href='http://docs.puppetlabs.com' />
    <link rel='icon' href='./../favicon.ico' />


  <meta name="description" content="This is a list of release notes for various releases, you should review thesebefore upgrading as any potential problems and backward incompatible c...">



    <!-- FIXME: absolute paths -->

    <script type='text/javascript' src='./../files/javascripts/html5.js'></script>
    <script type='text/javascript' src='./../files/javascripts/jquery-1.3.2.min.js'></script>
    <script type='text/javascript' src='./../files/javascripts/drop_down.js'></script>
    <script type='text/javascript' src='./../files/javascripts/cufon-yui.js'></script>
    <script type='text/javascript' src='./../files/fonts/Klavika_400-Klavika_600.font.js'></script>
    <script type='text/javascript' src='./../files/javascripts/ampersands.js'></script>
    <script type='text/javascript' src='./../files/javascripts/navigation-accordion.js'></script>

    <script type="text/javascript" src="http://puppetlabs.com/wp-content/themes/puppetlabs/javascripts/leadcapture.js"></script>

    <!-- All in One SEO Pack 1.6.10.1 by Michael Torbert of Semper Fi Web Design[127,146] -->
    <meta name="keywords" content="Puppet, puppet labs, reductive labs, open source, system administrator, ruby, data center, automation, support" />
    <!-- /all in one seo pack -->

    <!-- Give us the option of setting a canonical URL in yaml frontmatter -NF -->
    <link rel="canonical" href="http://docs.puppetlabs.com/mcollective/releasenotes.html" />

    <!-- FIXME: absolute paths -->

    <link rel="stylesheet" type="text/css" href="./../files/stylesheets/style.css" media="screen">
    <link rel="stylesheet" type="text/css" href="./../files/stylesheets/syntax.css" media="screen"> <!-- index -->
    <link rel="stylesheet" type="text/css" href="./../files/stylesheets/adbanner.css" media="screen">

    <!--[if IE 7]>
	  <link rel="stylesheet" type="text/css" href="./../files/stylesheets/ie_7.css" media="screen"> <!-- index -->
    <![endif]-->

    <!--[if IE 8]>
	    <link rel="stylesheet" type="text/css" href="./../files/stylesheets/ie_8.css" media="screen"> <!-- index -->
    <![endif]-->

  	<script type="text/javascript">
      Cufon.replace('h1, h2', { fontWeight: '600' });
  	</script>
</head>




  <body id="puppetlabsdocs" class="docs">
  <style type="text/css">h1, h2{ visibility : hidden }</style>
  <!--[if IE 8]>
    <style type="text/css">h1, h2{ visibility : visible }</style>
  <![endif]-->

  	<header id="header">
      <div class="site-width">
    		<h1><a href="http://puppetlabs.com/"><span>Puppet Labs</span></a></h1>
        <a class="screen-reader-content" href="#content">Skip navigation</a>
        <nav>
    		<ul id="global-navigation">
          <li id="puppet-tab" class="with-submenu">
            <a href="http://puppetlabs.com/puppet/puppet-enterprise">
              <span>Products</span>
              <span class="drop-down-trigger"></span>
            </a>
            <ul>
			<li>
                <ul>
                   <a href="http://puppetlabs.com/puppet/what-is-puppet/">What is Puppet?</a>
                </ul>
              </li>
			       <li>
                <ul>
                   <a href="http://puppetlabs.com/puppet/puppet-enterprise/">Puppet Enterprise</a>
                </ul>
              </li>
            <li>
                <ul>
                   <a href="http://puppetlabs.com/puppet/whats-new/">What's New in 2.5</a>
                </ul>
              </li>
            <li>
                <ul>
                   <a href="http://puppetlabs.com/puppet/puppet-open-source/">Puppet Open Source</a>
                </ul>
              </li>
            <li>
                <ul>
                   <a href="http://puppetlabs.com/puppet/enterprise-vs-open-source/">Enterprise vs. Open Source</a>
                </ul>
              </li>
              <li>
                <ul>
                  <a href="http://forge.puppetlabs.com">Puppet Forge</a>
                </ul>
              </li>
              <li>
                <ul>
                  <a href="http://puppetlabs.com/puppet/requirements/">Components &amp; Requirements</a>
                </ul>
              </li>
              <li>
                <ul>
                  <a href="http://puppetlabs.com/puppet/faq/">FAQ</a>
                </ul>
              </li>
			  <li>
                <ul>
                  <a href="http://puppetlabs.com/puppet/how-to-buy/">How to Buy</a>
                </ul>
              </li>
            </ul>
          </li>
          <li id="solutions-tab" class="with-submenu">
            <a href="http://puppetlabs.com/solutions/">
              <span>Solutions</span>
              <span class="drop-down-trigger"></span>
            </a>
            <ul>
              <li class="page_item page-item-12296"><a href="http://puppetlabs.com/solutions/configuration-management/">Configuration Management</a></li>
<li class="page_item page-item-986"><a href="http://puppetlabs.com/solutions/virtualization-management/">Virtualization Management</a></li>
<li class="page_item page-item-993"><a href="http://puppetlabs.com/solutions/cloud-management/">Cloud Management</a></li>
<li class="page_item page-item-996"><a href="http://puppetlabs.com/solutions/it-compliance/">IT Compliance</a></li>
<li class="page_item page-item-9520"><a href="http://puppetlabs.com/solutions/devops/">DevOps</a></li>
<li class="page_item page-item-991"><a href="http://puppetlabs.com/solutions/manage-os-x-resources/">OS X Desktops</a></li>
            </ul>
          </li>
          <li id="services-tab" class="with-submenu">
            <a href="http://puppetlabs.com/services/">
              <span>Services</span>
              <span class="drop-down-trigger"></span>
            </a>
            <ul>
              <li class="page_item page-item-783"><a href="http://puppetlabs.com/services/overview/">Overview</a></li>
<li class="page_item page-item-1052"><a href="http://puppetlabs.com/services/customer-support/">Customer Support</a></li>
<li class="page_item page-item-11022"><a href="http://puppetlabs.com/services/support-plans/">Support Plans</a></li>
<li class="page_item page-item-845"><a href="http://puppetlabs.com/services/training-workshops/">On-Site Education</a></li>
<li class="page_item page-item-4899"><a href="http://puppetlabs.com/services/consulting/">Professional Services</a></li>
<li class="page_item page-item-849"><a href="http://puppetlabs.com/category/events/upcoming/">Events &amp; Workshops</a></li>
<li class="page_item page-item-851"><a href="http://puppetlabs.com/services/partners/">Partners</a></li>
            </ul>
          </li>
                    <li id="resources-tab" class="with-submenu">
            <a href="http://puppetlabs.com/resources/">
              <span>Resources</span>
              <span class="drop-down-trigger"></span>
            </a>
            <ul>
              <li class="page_item page-item-1048"><a href="http://puppetlabs.com/resources/overview-2/">Overview</a></li>
<li class="page_item page-item-1040"><a href="http://docs.puppetlabs.com">Documentation</a></li>
<li class="page_item page-item-872"><a href="http://info.puppetlabs.com/register-download">Downloads</a></li>
<li class="page_item page-item-1961"><a href="http://forge.puppetlabs.com">Puppet Forge</a></li>
<li class="page_item page-item-835"><a href="http://info.puppetlabs.com/download-whitepapers.html">White Papers</a></li>
<li class="page_item page-item-1967"><a href="http://projects.puppetlabs.com/projects/puppet/wiki">Wiki</a></li>
<li class="page_item page-item-7279"><a href="http://puppetlabs.com/resources/webinars/">Upcoming Webinars</a></li>
<li class="page_item page-item-10183"><a href="http://puppetlabs.com/resources/newsletter/">Newsletter</a></li>
<li class="page_item page-item-12263"><a href="http://puppetlabs.com/resources/tech-notes/">Tech Notes</a></li>
<li class="page_item page-item-10265"><a href="http://info.puppetlabs.com/pe2-webinar.html">Webinars</a></li>
            </ul>
          </li>

          <li id="customers-tab" class="with-submenu">
            <a href="http://puppetlabs.com/customers/companies/">
              <span>Customers</span>
              <span class="drop-down-trigger"></span>
            </a>
            <ul>
			<li>
                <ul>
                  <a href="http://puppetlabs.com/customers/companies/">Companies</a>
                </ul>
              </li>
			  <li>
                <ul>
                  <a href="http://puppetlabs.com/customers/case-studies/">Case Studies</a>
                </ul>
              </li>
			  <li>
                <ul>
                  <a href="http://puppetlabs.com/customers/product-testimonials/">Product Testimonials</a>
                </ul>
              </li>
			    <li>
                <ul>
                  <a href="http://puppetlabs.com/customers/what-customers-are-saying/">Service Testimonials</a>
                </ul>
              </li>
            </ul>
          </li>
          <li id="community-tab" class="with-submenu">
            <a href="http://puppetlabs.com/community/">
              <span>Community</span>
              <span class="drop-down-trigger"></span>
            </a>

 <ul>
			<li>
                <ul>
                  <a href="http://puppetlabs.com/community/overview/">Overview</a>
                </ul>
              </li>
			<li>
                <ul>
                  <a href="http://puppetlabs.com/blog">Blog</a>
                </ul>
              </li>
			  <li>
                <ul>
                  <a href="http://puppetlabs.com/community/puppet-camp/">Puppet Camp</a>
                </ul>
              </li>
			  <li>
                <ul>
                  <a href="http://puppetlabs.com/community/user-groups-and-devops-groups/">Puppet User Groups & DevOps Groups</a>
                </ul>
              </li>
	          <li>
                <ul>
                  <a href="http://puppetlabs.com/community/presentations/">Presentations</a>
                </ul>
              </li>
			    <li>
                <ul>
                  <a href="http://puppetlabs.com/community/videos/">Videos</a>
                </ul>
              </li>
            </ul>

          <li id="company-tab" class="with-submenu">
            <a href="http://puppetlabs.com/company/">
              <span>Company</span>
              <span class="drop-down-trigger"></span>
            </a>
            <ul>
              <li class="page_item page-item-2316"><a href="http://puppetlabs.com/company/overview/">Overview</a></li>
<li class="page_item page-item-2179"><a href="http://puppetlabs.com/company/news/">News</a>
<ul class='children'>
	<li class="page_item page-item-2338"><a href="http://puppetlabs.com/company/news/press-releases/">Press Releases</a></li>
	<li class="page_item page-item-2383"><a href="http://puppetlabs.com/company/news/media-kit/">Media Kit</a></li>
</ul>
</li>
<li class="page_item page-item-1571"><a href="http://puppetlabs.com/company/careers/">Careers</a></li>
<li class="page_item page-item-10372"><a href="http://puppetlabs.com/company/management/">Management</a></li>
<li class="page_item page-item-10311"><a href="http://puppetlabs.com/company/board-and-advisors/">Board and Advisors</a></li>
<li class="page_item page-item-10367"><a href="http://puppetlabs.com/company/investors/">Investors</a></li>
<li class="page_item page-item-2313"><a href="http://puppetlabs.com/company/contact-us/">Contact Us</a></li>
<li class="page_item page-item-10579"><a href="http://puppetlabs.com/company/awards/">Awards</a></li>
            </ul>
          </li>
    		</ul>
          <div id="misc-navigation">
			  <ul>
				<li><a href="http://puppetlabs.com/security/">Security</a></li>
				<li><a href="http://docs.puppetlabs.com">Documentation</a></li>
				<li><a href="http://puppetlabs.com/resources/customer-support/">Support</a></li>
			        <li><a href="http://projects.puppetlabs.com/">Bug Tracker</a></li>
				<li><a href="http://puppetlabs.com/company/contact/contact-us">Contact Us</a></li>
				<li><a href="http://info.puppetlabs.com/download-pe2.html" class="gateway">Download</a></li>
			  </ul>
			<form action="http://www.google.com/cse" id="cse-search-box">
			  <div>
				<input type="hidden" name="cx" value="017668764424496204839:ubligvgbenm" />
				<input type="hidden" name="ie" value="UTF-8" />
				<input type="text" name="q" class="gsc-input" size="31" />
				<input type="submit" name="sa" class="searchbtn" value="Search" />
			  </div>
			</form>
			<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&lang=en"></script>
          </div>
      </nav>
    	</div>
    </header>

      <section id="masthead">
        <div class="site-width">
          <h1>Docs: <span class="section-name">Release Notes</span></h1>
          <ul id="doc-navigation">
            <li><a href="./../index.html">Docs Home</a></li>
            <li class="with-submenu">
              <a href="#">
                <span>Quick Nav</span>
                <span class="drop-down-trigger"></span>
              </a>
               <!-- the following links can't be relative, unfortunately -->
               <!-- future: add some JS to disable this if running from file:// -->
                               <dl>
                  <dt>Puppet Documentation</dt>
                      <dd><a href="./../puppet/3/reference/index.html">Puppet 3 Reference Manual</a></dd>
                      <dd><a href="./../puppet/2.7/reference/index.html">Puppet 2.7 Reference Manual</a></dd>
                      <dd><a href="./../pe/latest/index.html">Puppet Enterprise User's Guide</a></dd>
                      <dd><a href="./../learning/index.html">Learning Puppet</a></dd>
                      <dd><a href="./../references/latest/type.html">Resource Types</a></dd>
                      <dd><a href="./../references/latest/function.html">Functions</a></dd>
                      <dd><a href="./../references/latest/configuration.html">Configuration</a></dd>
                      <dd><a href="./../references/latest/developer/index.html">Developer</a></dd>
                      <dd><a href="./../references/glossary.html">Glossary of Puppet Terms</a></dd>
                      <dd><a href="./../references/index.html">Older References</a></dd>
                  <dt>Facter</dt>
                      <dd><a href="./../facter/latest/core_facts.html">Core Facts Reference</a></dd>
                  <dt>PuppetDB</dt>
                      <dd><a href="./../puppetdb/1/index.html">PuppetDB 1 Manual</a></dd>
                  <dt>MCollective</dt>
                      <dd><a href="./../mcollective/index.html">Index</a></dd>
                      <dd><a href="./../mcollective/reference/index.html">References</a></dd>
                      <dd><a href="./../mcollective/simplerpc/index.html">Writing Plugins</a></dd>
                      <dd><a href="./../mcollective/releasenotes.html">Release Notes</a></dd>
                </dl>

            </li>
            <li><a href="./../contribute.html">Contribute</a></li>
          </ul>
        </div>
        <br />
      </section>

      <section id="content">
        <div class="site-width">
          <div class="primary-secondary-content">
            <div class="primary-content">
              <h1>Release Notes</h1>

              <p>This is a list of release notes for various releases, you should review these
before upgrading as any potential problems and backward incompatible changes
will be highlighted here.</p>

<p><a name="2_3_2">&nbsp;</a></p>

<h2 id="section">2.3.2 - 2013/07/11</h2>

<p>This is the third release in the new development series of MCollective.  This
release features enhancements and bug fixes.</p>

<p>This release is for early adopters, production users should consider the 2.2.x
series.</p>

<p>There are important steps to take before upgrading to this release, please carefully
read the updating section below.</p>

<h3 id="new-features-and-improvements">New Features and Improvements</h3>

<ul>
  <li>Correct reply-to headers are now set for both ActiveMQ and RabbitMQ</li>
  <li>Fire and forget requests are now direct addressing aware</li>
  <li>Boolean values in the config classes have now been standardised via a new <code>Util#str_to_bool</code> helper</li>
  <li>SSL certificate paths for ActiveMQ and RabbitMQ can now be set in the users shell environment</li>
  <li>Aggregate plugins are supported in the &#8216;mco plugin doc&#8217; application and bundled plugins now have usage information</li>
  <li>Default ports for ActiveMQ and RabbitMQ have changed to 61613</li>
  <li>Data returned by data plugins are pre-populated with defaults from the DDL</li>
  <li>Direct addressing is now enabled by default</li>
  <li>Argument validation in the rpc application now happens before discovery to provide more timely user feedback</li>
  <li>Improved error handling and error messages</li>
  <li>Remove the topicprefix, queueprefix, rpchelptemplate, helptemplatedir, plugin.discovery.timeout and topicsep configuration options</li>
  <li>Certain paths have more platform appropriate defaults on Windows</li>
  <li>Filter methods on the RPC client are now idempotent</li>
</ul>

<h3 id="bug-fixes">Bug Fixes</h3>

<ul>
  <li>Correctly handle discovery where data plugins return nil for a specific item</li>
  <li>The flatfile discovery method validates identities found using the same rules as the config class</li>
  <li>The Util#versioncmp function behaves correctly with semver versions where the minor is larger than 10</li>
  <li>Debian packages will now build correctly in a chroot</li>
  <li>The run() agent helper could sometimes return -1 and leave zombies, this has been improved</li>
  <li>Certain operations on a reply data item in an agent could alter the cached copy of the DDL thus affecting future agent invocations</li>
  <li>Absolute paths on Windows are detected correctly</li>
  <li>Line numbers are printed correctly in logs on Windows machines</li>
  <li>Whitespace before config keys in the config file are now ignored</li>
</ul>

<h3 id="backwards-compatibility-and-upgrading">Backwards Compatibility and Upgrading</h3>

<p>In release 2.3.1 we removed the Stomp connector, in this release we are removing a number of unused
configuration options that was used by this connector and a few others that has become pointless over
the years.</p>

<p>If you have any of the following in your configuration files you must remove them <em>before</em> upgrading
as the daemon and client will fail to start if any of them are present:</p>

<ul>
  <li>topicprefix</li>
  <li>queueprefix</li>
  <li>rpchelptemplate</li>
  <li>helptemplatedir</li>
  <li>plugin.discovery.timeout</li>
  <li>topicsep</li>
</ul>

<p>If you have in the past not configured the port for the ActiveMQ and RabbitMQ connectors the default
would have been 6163, this has now changed to 61613 to be more in line with what other projects default
to.  This means if you rely on the defaulting behaviour you might now have to specifically state the
ports.  We recommend always stating ports specifically.</p>

<h3 id="changes-since-223">Changes since 2.2.3</h3>

<table>
  <thead>
    <tr>
      <th>Date</th>
      <th>Description</th>
      <th>Ticket</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2013/07/03</td>
      <td>Improve error reporting when requesting docs for a non existing plugin</td>
      <td>21429</td>
    </tr>
    <tr>
      <td>2013/07/03</td>
      <td>Support aggregate plugins in &#8216;mco plugin doc&#8217;</td>
      <td>18414</td>
    </tr>
    <tr>
      <td>2013/07/03</td>
      <td>Allow the ActiveMQ and RabbitMQ SSL cert paths to be set using environment variables</td>
      <td>20550</td>
    </tr>
    <tr>
      <td>2013/06/23</td>
      <td>Gracefully handle whitespaces in the config file before config keys</td>
      <td>21407</td>
    </tr>
    <tr>
      <td>2013/06/19</td>
      <td>Ensure the line numbers are printed correctly on both Windows and Unix</td>
      <td>20506</td>
    </tr>
    <tr>
      <td>2013/06/19</td>
      <td>Remove the rpchelptemplate and helptemplatedir options</td>
      <td>20714</td>
    </tr>
    <tr>
      <td>2013/06/18</td>
      <td>Correctly detect Windows absolute paths</td>
      <td>21251</td>
    </tr>
    <tr>
      <td>2013/06/10</td>
      <td>Fix and centralize handling of boolean values for settings</td>
      <td>19751</td>
    </tr>
    <tr>
      <td>2013/06/06</td>
      <td>Clone the default values from the DDL to avoid accidental modifications to the cached DDL file</td>
      <td>21104</td>
    </tr>
    <tr>
      <td>2013/06/05</td>
      <td>Filter methods on the RPC Client are now idempotent</td>
      <td>20233</td>
    </tr>
    <tr>
      <td>2013/06/04</td>
      <td>run() call in an agent can return incorrect Process::Status</td>
      <td>17667</td>
    </tr>
    <tr>
      <td>2013/06/03</td>
      <td>Improve debian dependencies so packages can be rebuilt in a chroot</td>
      <td>20950</td>
    </tr>
    <tr>
      <td>2013/05/28</td>
      <td>Set expire headers in the ActiveMQ and RabbitMQ message headers</td>
      <td>19905</td>
    </tr>
    <tr>
      <td>2013/05/10</td>
      <td>Correctly detect version differences in semver version where the path level is greater 10</td>
      <td>20661</td>
    </tr>
    <tr>
      <td>2013/05/01</td>
      <td>Improve behaviour of data matchers when return values are nil</td>
      <td>20059</td>
    </tr>
    <tr>
      <td>2013/04/29</td>
      <td>Improve config defaults on windows machines</td>
      <td>20388</td>
    </tr>
    <tr>
      <td>2013/04/18</td>
      <td>Enforce valid identity names in the file discovery method</td>
      <td>20282</td>
    </tr>
    <tr>
      <td>2013/04/11</td>
      <td>Add direct addressing awareness to the fire and forget request mode</td>
      <td>17930</td>
    </tr>
    <tr>
      <td>2013/03/22</td>
      <td>Remove the topicprefix, queueprefix and topicsep options</td>
      <td>19673</td>
    </tr>
    <tr>
      <td>2013/03/21</td>
      <td>Remove the plugin.discovery.timeout setting as it&#8217;s not relevant anymore</td>
      <td>19694</td>
    </tr>
    <tr>
      <td>2013/03/21</td>
      <td>Improve error reporting from the rpc application in the light of direct_addressing</td>
      <td>19827</td>
    </tr>
    <tr>
      <td>2013/03/20</td>
      <td>Fail with a friendly error message when no libdir is set</td>
      <td>19752</td>
    </tr>
    <tr>
      <td>2013/03/14</td>
      <td>Change default RabbitMQ and ActiveMQ ports to 61613</td>
      <td>19734</td>
    </tr>
    <tr>
      <td>2013/03/13</td>
      <td>Set correct reply-to headers in the RabbitMQ connector</td>
      <td>17034</td>
    </tr>
    <tr>
      <td>2013/03/12</td>
      <td>Pre-populate the data from data plugins like agent replies</td>
      <td>19564</td>
    </tr>
    <tr>
      <td>2013/03/12</td>
      <td>Explicitly include StringIO</td>
      <td>19367</td>
    </tr>
    <tr>
      <td>2013/03/12</td>
      <td>Enable direct addressing by default</td>
      <td>19665</td>
    </tr>
    <tr>
      <td>2013/02/20</td>
      <td>Fix error code collision on PLMC18</td>
      <td>19366</td>
    </tr>
    <tr>
      <td>2013/02/15</td>
      <td>Validate arguments supplied to the RPC application and raise errors sooner</td>
      <td>19181</td>
    </tr>
  </tbody>
</table>

<p><a name="2_2_4">&nbsp;</a></p>

<h2 id="section-1">2.2.4 - 2013/05/21</h2>

<p>This is a maintenance release to the current production series of MCollective.
This release is a bug fix only release.</p>

<h3 id="bug-fixes-1">Bug Fixes</h3>

<ul>
  <li>A work around for a API behaviour change in the latest JSON gem have been added</li>
  <li>Configuration defaults on MS Windows have been improved</li>
  <li>The correct reply-to headers are now set by the RabbitMQ connector allowing async communication modes</li>
  <li>The StringIO library is now specifically required to avoid a case where the client library would fail when a non YAML fact source is set on the client</li>
  <li>The Util#versioncmp function incorrectly compared semver versions with high minor versions</li>
</ul>

<h3 id="backwards-compatibility-and-upgrading-1">Backwards Compatibility and Upgrading</h3>

<p>This release should be 100% backwards compatible with 2.2.0, 2.2.1, 2.2.2 and 2.2.3, when upgrading
from earlier releases please review the Release notes for 2.0.0.</p>

<h3 id="changes-since-223-1">Changes since 2.2.3</h3>

<table>
  <thead>
    <tr>
      <th>Date</th>
      <th>Description</th>
      <th>Ticket</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2013/05/10</td>
      <td>Correctly detect version differences in semver version where the path level is greater 10</td>
      <td>20661</td>
    </tr>
    <tr>
      <td>2013/05/07</td>
      <td>Support the latest version of the JSON gem</td>
      <td>20594</td>
    </tr>
    <tr>
      <td>2013/04/29</td>
      <td>Improve config defaults on windows machines</td>
      <td>20388</td>
    </tr>
    <tr>
      <td>2013/03/13</td>
      <td>Set correct reply-to headers in the RabbitMQ connector</td>
      <td>17034</td>
    </tr>
    <tr>
      <td>2013/03/12</td>
      <td>Explicitly include StringIO</td>
      <td>19367</td>
    </tr>
  </tbody>
</table>

<p><a name="2_3_1">&nbsp;</a></p>

<h2 id="section-2">2.3.1 - 2013/02/14</h2>

<p>This is the second release in the new development series of MCollective.  This
release features enhancements and bug fixes.</p>

<p>This release is for early adopters, production users should consider the 2.2.x
series.</p>

<h3 id="new-features-and-improvements-1">New Features and Improvements</h3>

<ul>
  <li>Initial work towards online help, improved logging and internationalization</li>
  <li>The output from <code>--help</code> has been made clearer</li>
  <li>The output of a failed reply in the default <code>printrpc</code> method has been improved</li>
</ul>

<h3 id="bug-fixes-2">Bug Fixes</h3>

<ul>
  <li>The vendored JSON gem was updated to version 1.5.5 due to CVE-2013-0269</li>
  <li>The RPC client inadvertently lost the ability to set discovery_timeout, this has been restored</li>
  <li>Plugins with underscores in their name were not packagable on Debian, we now change underscores to dashes</li>
  <li>The STOMP connector will not be maintained further and has been removed</li>
  <li>A config file reading race condition were fixed, we no longer attempt to use config details before parsing the config file thus always using defaults.</li>
  <li>Dependencies on packaged plugins have been made more specific to ensure updates work correctly</li>
  <li>When an argument to the rpc application fails to parse the command will fail instead of continue with unexpected side effects</li>
  <li>Processing of <code>--no-response</code> was broken in 2.3.0, this has been fixed</li>
</ul>

<h3 id="removed-functionality">Removed Functionality</h3>

<ul>
  <li>The STOMP adapter has been deprecated and removed</li>
</ul>

<h3 id="online-help-and-internationalization">Online Help and Internationalization</h3>

<p>Starting in this release a number of errors and messages will start showing error codes along
with the error text and we have a method for obtaining detailed information about each coded
message.</p>

<p>An example log line can be seen here:</p>

<div class="highlight"><pre><code class="console"><span class="go">puppetd.rb:26 PLMC34: setting meta data in agents have been deprecated, DDL files are now being used for this information. Please update the &#39;puppetd.rb&#39; agent</span>
</code></pre>
</div>

<p>And an example CLI error string:</p>

<div class="highlight"><pre><code class="console"><span class="gp">%</span> mco rpc rpcutil get_fact

<span class="go">The rpc application failed to run: PLMC30: Action &#39;get_fact&#39; needs a &#39;fact&#39; argument</span>

<span class="go">Use the &#39;mco doc PLMC30&#39; command for details about this error, use -v for full error backtrace details</span>
</code></pre>
</div>

<p>You can now use the <code>mco doc PLMC30</code> command to get additional information about this error
and any other error code you might see.</p>

<p>Only a small number of errors and log lines have been updated for the new system and
we will soon publish web versions of these help documents too which should help when
searching for resolution to common errors.</p>

<h3 id="backwards-compatibility-and-upgrading-2">Backwards Compatibility and Upgrading</h3>

<p>The STOMP connector has been removed, if you are using it please move to the RabbitMQ
or ActiveMQ one before upgrading.  Especially if you use Debian which would avoid the
package upgrading from failing</p>

<h3 id="changes-since-230">Changes since 2.3.0</h3>

<table>
  <thead>
    <tr>
      <th>Date</th>
      <th>Description</th>
      <th>Ticket</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><em>2013/02/14</em></td>
      <td><em>Release 2.3.1</em></td>
      <td>19265</td>
    </tr>
    <tr>
      <td>2013/02/14</td>
      <td>Initial work towards internationalization and online help</td>
      <td>18663</td>
    </tr>
    <tr>
      <td>2013/02/14</td>
      <td>Update vendored JSON gem for CVE-2013-0269</td>
      <td>19265</td>
    </tr>
    <tr>
      <td>2013/02/13</td>
      <td>Restore the ability to set a discovery timeout on a RPC client</td>
      <td>19238</td>
    </tr>
    <tr>
      <td>2013/02/12</td>
      <td>Replace underscores in plugin names with dashes to keep Debian happy</td>
      <td>19200</td>
    </tr>
    <tr>
      <td>2013/02/12</td>
      <td>Fix package building on certain Debian systems</td>
      <td>19141</td>
    </tr>
    <tr>
      <td>2013/02/12</td>
      <td>Remove the stomp connector</td>
      <td>19146</td>
    </tr>
    <tr>
      <td>2013/02/07</td>
      <td>Read the client config before trying to use any configuration options</td>
      <td>19105</td>
    </tr>
    <tr>
      <td>2013/01/22</td>
      <td>When an argument fails to parse in the rpc application fail rather than continue with unintended consequences</td>
      <td>18773</td>
    </tr>
    <tr>
      <td>2013/01/22</td>
      <td>The fix the <em>&#8211;no-response</em> argument to the rpc application that broke due to 18438</td>
      <td>18513</td>
    </tr>
    <tr>
      <td>2013/01/22</td>
      <td>Set <em>=</em> dependencies on the various packages that form a plugin rather than <em>&gt;=</em></td>
      <td>18758</td>
    </tr>
    <tr>
      <td>2013/01/21</td>
      <td>Improve presentation of the &#8211;help output for applications</td>
      <td>18447</td>
    </tr>
    <tr>
      <td>2013/01/21</td>
      <td>When a request failed via <em>reply.fail</em>, only show the message and not the half built data</td>
      <td>18434</td>
    </tr>
  </tbody>
</table>

<p><a name="2_2_3">&nbsp;</a></p>

<h2 id="section-3">2.2.3 - 2013/02/14</h2>

<p>This is a maintenance release to the current production version of MCollective.
This release is a bug fix only release.</p>

<h3 id="bug-fixes-3">Bug Fixes</h3>

<ul>
  <li>The vendored JSON gem was updated to version 1.5.5 due to CVE-2013-0269</li>
  <li>The RPC client inadvertently lost the ability to set discovery_timeout, this has been restored</li>
  <li>Plugins with underscores in their name were not packagable on Debian, we now change underscores to dashes</li>
  <li>The STOMP adapter will not be maintained past this release series, we now issue deprecation warnigns</li>
  <li>A config file reading race condition were fixed, we no longer attempt to use config details before parsing the config file thus always using defaults.</li>
  <li>Dependencies on packaged plugins have been made more specific to ensure updates work correctly</li>
</ul>

<h3 id="backwards-compatibility-and-upgrading-3">Backwards Compatibility and Upgrading</h3>

<p>This release should be 100% backwards compatible with 2.2.0, 2.2.1 and 2.2.2, when upgrading
from earlier releases please review the Release notes for 2.0.0.</p>

<p>If you packaged any plugins with a underscore in their name, future packages will have a dash
instead, this might cause upgrade problems.</p>

<p>We are deprecating the STOMP connector, if you are using this connector please consider moving to the
ActiveMQ or RabbitMQ specific ones.</p>

<h3 id="changes-since-222">Changes since 2.2.2</h3>

<table>
  <thead>
    <tr>
      <th>Date</th>
      <th>Description</th>
      <th>Ticket</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><em>2013/02/14</em></td>
      <td><em>Release 2.2.3</em></td>
      <td>19265</td>
    </tr>
    <tr>
      <td>2013/02/14</td>
      <td>Update vendored JSON gem for CVE-2013-0269</td>
      <td>19265</td>
    </tr>
    <tr>
      <td>2013/02/13</td>
      <td>Restore the ability to set a discovery timeout on a RPC client</td>
      <td>19238</td>
    </tr>
    <tr>
      <td>2013/02/12</td>
      <td>Replace underscores in plugin names with dashes to keep Debian happy</td>
      <td>19200</td>
    </tr>
    <tr>
      <td>2013/02/12</td>
      <td>Fix package building on certain Debian systems</td>
      <td>19141</td>
    </tr>
    <tr>
      <td>2013/02/12</td>
      <td>Deprecate the stomp connector</td>
      <td>19146</td>
    </tr>
    <tr>
      <td>2013/02/07</td>
      <td>Read the client config before trying to use any configuration options</td>
      <td>19105</td>
    </tr>
    <tr>
      <td>2013/01/22</td>
      <td>Set <code>=</code> dependencies on the various packages that form a plugin rather than <code>&gt;=</code></td>
      <td>18758</td>
    </tr>
  </tbody>
</table>

<p><a name="2_0_1">&nbsp;</a></p>

<h2 id="section-4">2.0.1 - 2013/02/14</h2>

<p>This is a maintenance release against our unsupported past production release, it brings no
visible changes or bug fixes we only updated the vendored JSON gem to version 1.5.5 due to
CVE-2013-0269</p>

<p><a name="2_2_2">&nbsp;</a></p>

<h2 id="section-5">2.2.2 - 2013/01/17</h2>

<p>This is a maintenance release to the current production version of MCollective.
This release is a bug fix only release.</p>

<h3 id="bug-fixes-4">Bug Fixes</h3>

<ul>
  <li>Add the package iteration number as dependency for common packages</li>
  <li>The :any validator has been restored</li>
  <li>Packaging non-agent plugins failed when providing custom paths</li>
  <li>Packaging on RHEL5 systems failed due to an undefined buildroot</li>
  <li>When available packages will be built using rpmbuild-md5</li>
  <li>Help for data plugins with no input queries are now rendered correctly</li>
  <li>The rpcutil#get_data action now supports data plugins without input queries</li>
  <li>The RPM packages will now require Ruby &gt; 1.8 to improve packaging for 1.9.x</li>
</ul>

<h3 id="backwards-compatibility-and-upgrading-4">Backwards Compatibility and Upgrading</h3>

<p>This release should be 100% backwards compatible with 2.2.0 and 2.2.1, when upgrading
from earlier releases please review the Release notes for 2.0.0.</p>

<h3 id="changes-since-221">Changes since 2.2.1</h3>

<table>
  <thead>
    <tr>
      <th>Date</th>
      <th>Description</th>
      <th>Ticket</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><em>2013/02/17</em></td>
      <td><em>Release 2.2.2</em></td>
      <td>18258</td>
    </tr>
    <tr>
      <td>2013/01/03</td>
      <td>Add the package iteration number as a dependency for the common packages</td>
      <td>18273</td>
    </tr>
    <tr>
      <td>2012/12/24</td>
      <td>Restore the :any validator</td>
      <td>18265</td>
    </tr>
    <tr>
      <td>2012/12/19</td>
      <td>Do not fail when packaging non-agent packages using custom paths</td>
      <td>17281</td>
    </tr>
    <tr>
      <td>2012/12/19</td>
      <td>Require Ruby &gt; 1.8 in the RPM specs for Ruby 1.9</td>
      <td>17149</td>
    </tr>
    <tr>
      <td>2012/11/08</td>
      <td>Define a specific buildroot to support RHEL5 systems correctly</td>
      <td>17516</td>
    </tr>
    <tr>
      <td>2012/11/08</td>
      <td>Use the correct rpmbuild commands on systems with rpmbuild-md5</td>
      <td>17515</td>
    </tr>
    <tr>
      <td>2012/10/22</td>
      <td>Correctly show help for data plugins without any input queries</td>
      <td>17137</td>
    </tr>
    <tr>
      <td>2012/10/22</td>
      <td>Allow the rpcutil#get_data action to work with data queries that takes no input</td>
      <td>17138</td>
    </tr>
  </tbody>
</table>

<p><a name="2_3_0">&nbsp;</a></p>

<h2 id="section-6">2.3.0 - 2012/01/10</h2>

<p>This is the first release in the new development series of MCollective.  This
release features small enhancements and bug fixes.</p>

<p>This release is for early adopters, production users should consider the 2.2.x
series.</p>

<h3 id="enhancements-and-behaviour-changes">Enhancements and behaviour changes</h3>

<ul>
  <li>Data queries can be written without any input queries</li>
  <li>Required inputs can now supply default values in their DDLs</li>
  <li>Support for Ruby 1.9 was improved in the packages</li>
  <li>The generated plugin documentation has been updated to show defaults and optional items</li>
  <li>Errors in agents will now log backtraces on the servers to assist with debugging</li>
  <li>libdirs will now be expanded to absolute paths and using relative ones will raise an error</li>
  <li>Various error and logging improvements</li>
  <li>Various improvements to the plugin packager</li>
</ul>

<h3 id="bug-fixes-5">Bug fixes</h3>

<ul>
  <li>Packaging non-agent plugins with custom paths caused an unexpected failure</li>
  <li>The plugin packager works correctly on RHEL5 now after previously using an incorrect buildroot</li>
  <li>Correctly handle custom formats passed to the aggregation plugins from the DDL</li>
  <li>Failure in one aggregate plugin does not impact other aggregate functions</li>
  <li>The chosen timeout for agents when using direct addressing could be wrong in some cases</li>
  <li>Data plugins can now return BigNum data like those found in timestamps</li>
  <li>Aggregate functions support non string data</li>
  <li>Boolean flags in applications can now support &#8211;noop and &#8211;no-noop style flags</li>
  <li>Data results were not raising the correct exception, this was not causing problems in practice but caused the mcollective-test gem to fail</li>
</ul>

<h3 id="input-defaults-in-the-ddl">Input defaults in the DDL</h3>

<p>You can now provide input defaults for required inputs in the DDL meaning if not
supplied they will default to the supplied format.</p>

<div class="highlight"><pre><code class="ruby"><span class="n">action</span> <span class="s2">&quot;get_fact&quot;</span><span class="p">,</span> <span class="ss">:description</span> <span class="o">=&gt;</span> <span class="s2">&quot;Retrieve a single fact from the fact store&quot;</span> <span class="k">do</span>
     <span class="n">input</span> <span class="ss">:fact</span><span class="p">,</span>
           <span class="ss">:prompt</span>      <span class="o">=&gt;</span> <span class="s2">&quot;The name of the fact&quot;</span><span class="p">,</span>
           <span class="ss">:description</span> <span class="o">=&gt;</span> <span class="s2">&quot;The fact to retrieve&quot;</span><span class="p">,</span>
           <span class="ss">:type</span>        <span class="o">=&gt;</span> <span class="ss">:string</span><span class="p">,</span>
           <span class="ss">:validation</span>  <span class="o">=&gt;</span> <span class="s1">&#39;^[\w\-\.]+$&#39;</span><span class="p">,</span>
           <span class="ss">:optional</span>    <span class="o">=&gt;</span> <span class="kp">false</span><span class="p">,</span>
           <span class="ss">:maxlength</span>   <span class="o">=&gt;</span> <span class="mi">40</span><span class="p">,</span>
           <span class="ss">:default</span>     <span class="o">=&gt;</span> <span class="s2">&quot;operatingsystems&quot;</span>
<span class="k">end</span>
</code></pre>
</div>

<p>The DDL file above defines a input <em>fact</em> that is required and sets a default value to
<em>operatingsystem</em>.</p>

<p>Previously the following command would have failed stating the input is required, now it
will default to the supplied value and continue without error:</p>

<div class="highlight"><pre><code class="ruby"><span class="err">$</span> <span class="n">mco</span> <span class="n">rpc</span> <span class="n">rpcutil</span> <span class="n">get_fact</span>
</code></pre>
</div>

<p>The defaults processing is done on the client side and not on the servers meaning at no
point does a non compliant request get published by the clients and older MCollective servers
will process these requests correctly.</p>

<h3 id="backwards-compatibility-and-upgrading-5">Backwards Compatibility and Upgrading</h3>

<p>This release can cohabit with older versions with the only potential upgrade problem being
the changes to how the libdir variable is handled.</p>

<p>In the past a libdir could be:</p>

<div class="highlight"><pre><code class="ini"><span class="na">libdir</span> <span class="o">=</span> <span class="s">/usr/libexec/mcollective:.mcollective.d</span>
</code></pre>
</div>

<p>This would have the effect of looking for <em>.mcollective.d</em> in the current directory.</p>

<p>This represented a security risk and would fail on the server side when daemonizing.
We now force all libdir paths to be fully qualified and raises an error at start should
you have relative paths.</p>

<h3 id="changes-since-221-1">Changes since 2.2.1</h3>

<table>
  <thead>
    <tr>
      <th>Date</th>
      <th>Description</th>
      <th>Ticket</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2012/01/10</td>
      <td>Raise the correct exception when trying to access unknown data items in a Data results</td>
      <td>18466</td>
    </tr>
    <tr>
      <td>2013/01/10</td>
      <td>Fix failing documentation generation for data plugins</td>
      <td>18437</td>
    </tr>
    <tr>
      <td>2013/01/09</td>
      <td>Correctly support negative boolean flags declared as &#8211;[no]-foo</td>
      <td>18438</td>
    </tr>
    <tr>
      <td>2013/01/03</td>
      <td>Add the package iteration number as a dependency for the common packages</td>
      <td>18273</td>
    </tr>
    <tr>
      <td>2012/12/21</td>
      <td>The libdirs supplied in the config file now has to be absolute paths to avoid issues when daemonising</td>
      <td>16018</td>
    </tr>
    <tr>
      <td>2012/12/20</td>
      <td>Logs the error and backtrace when an action fails</td>
      <td>16414</td>
    </tr>
    <tr>
      <td>2012/12/20</td>
      <td>Display the values of :optional and :default in DDL generated help</td>
      <td>16616</td>
    </tr>
    <tr>
      <td>2012/12/20</td>
      <td>Allow the query string for the get_data action in rpcutil to be 200 chars</td>
      <td>18200</td>
    </tr>
    <tr>
      <td>2012/12/19</td>
      <td>Do not fail when packaging non-agent packages using custom paths</td>
      <td>17281</td>
    </tr>
    <tr>
      <td>2012/12/19</td>
      <td>Require Ruby &gt; 1.8 in the RPM specs for Ruby 1.9</td>
      <td>17149</td>
    </tr>
    <tr>
      <td>2012/12/18</td>
      <td>Allow required inputs to specify default data in DDLs</td>
      <td>17615</td>
    </tr>
    <tr>
      <td>2012/11/12</td>
      <td>When disconnecting set the connection to nil</td>
      <td>17384</td>
    </tr>
    <tr>
      <td>2012/11/08</td>
      <td>Define a specific buildroot to support RHEL5 systems correctly</td>
      <td>17516</td>
    </tr>
    <tr>
      <td>2012/11/08</td>
      <td>Use the correct rpmbuild commands on systems with rpmbuild-md5</td>
      <td>17515</td>
    </tr>
    <tr>
      <td>2012/10/22</td>
      <td>Correctly show help for data plugins without any input queries</td>
      <td>17137</td>
    </tr>
    <tr>
      <td>2012/10/22</td>
      <td>Allow the rpcutil#get_data action to work with data queries that takes no input</td>
      <td>17138</td>
    </tr>
    <tr>
      <td>2012/10/03</td>
      <td>Improve text output when providing custom formats for aggregations</td>
      <td>16735</td>
    </tr>
    <tr>
      <td>2012/10/03</td>
      <td>Correctly process supplied formats when displaying aggregate results</td>
      <td>16415</td>
    </tr>
    <tr>
      <td>2012/10/03</td>
      <td>Prevent one failing aggregate function from impacting others</td>
      <td>16411</td>
    </tr>
    <tr>
      <td>2012/10/03</td>
      <td>When validation fails indicate which input key has the problem</td>
      <td>16617</td>
    </tr>
    <tr>
      <td>2012/09/26</td>
      <td>Data queries can be written without any input queries meaning they take no input</td>
      <td>16424</td>
    </tr>
    <tr>
      <td>2012/09/26</td>
      <td>Use correct timeout for agent requests when using direct addressing</td>
      <td>16569</td>
    </tr>
    <tr>
      <td>2012/09/26</td>
      <td>Allow BigNum data to be used in data plugin replies</td>
      <td>16503</td>
    </tr>
    <tr>
      <td>2012/09/26</td>
      <td>Support non string data in the summary aggregate function</td>
      <td>16410</td>
    </tr>
  </tbody>
</table>

<p><a name="2_2_1">&nbsp;</a></p>

<h2 id="section-7">2.2.1 - 2012/10/17</h2>

<p>This is a maintenance release to the current production version of MCollective.
This release is a bug fix only release.</p>

<h3 id="bug-fixes-6">Bug Fixes</h3>

<ul>
  <li>Various display and stability improvements with aggregate plugins</li>
  <li>Improve error messages</li>
  <li>Data queries that does not take an input still had to provide a bogus query input, now not needed</li>
  <li>When using direct addressing and identity filter the client timeout was incorrect</li>
  <li>BigNum type data can now be used in data plugin replies</li>
</ul>

<h3 id="backwards-compatibility-and-upgrading-6">Backwards Compatibility and Upgrading</h3>

<p>This release should be 100% backwards compatible with 2.2.0, when upgrading from earlier releases
pleas reivew the Release notes for 2.0.0.</p>

<h3 id="changes-since-210">Changes since 2.1.0</h3>

<table>
  <thead>
    <tr>
      <th>Date</th>
      <th>Description</th>
      <th>Ticket</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><em>2012/10/17</em></td>
      <td><em>Release 2.2.1</em></td>
      <td>16965</td>
    </tr>
    <tr>
      <td>2012/10/03</td>
      <td>Improve text output when providing custom formats for aggregations</td>
      <td>16735</td>
    </tr>
    <tr>
      <td>2012/10/03</td>
      <td>Correctly process supplied formats when displaying aggregate results</td>
      <td>16415</td>
    </tr>
    <tr>
      <td>2012/10/03</td>
      <td>Prevent one failing aggregate function from impacting others</td>
      <td>16411</td>
    </tr>
    <tr>
      <td>2012/10/03</td>
      <td>When validation fails indicate which input key has the problem</td>
      <td>16617</td>
    </tr>
    <tr>
      <td>2012/09/26</td>
      <td>Data queries can be written without any input queries meaning they take no input</td>
      <td>16424</td>
    </tr>
    <tr>
      <td>2012/09/26</td>
      <td>Use correct timeout for agent requests when using direct addressing</td>
      <td>16569</td>
    </tr>
    <tr>
      <td>2012/09/26</td>
      <td>Allow BigNum data to be used in data plugin replies</td>
      <td>16503</td>
    </tr>
    <tr>
      <td>2012/09/26</td>
      <td>Support non string data in the summary aggregate function</td>
      <td>16410</td>
    </tr>
    <tr>
      <td>2012/09/14</td>
      <td>Package discovery plugins that was left out for debian</td>
      <td>16413</td>
    </tr>
  </tbody>
</table>

<p><a name="2_2_0">&nbsp;</a></p>

<h2 id="section-8">2.2.0 - 2012/09/13</h2>

<p>This is the next production release of MCollective. It brings to an end active
support for versions 2.1.1 and older.</p>

<h3 id="major-enhancements">Major Enhancements</h3>

<ul>
  <li>A new plugin type called data plugins were added making network discovery extendible by users</li>
  <li>Discovery is now pluggable allowing network based, database based, file based or any other data source to be used as a source of truth</li>
  <li>Automatic result summarization methods can be declared in the DDL and users can write their own</li>
  <li>A RabbitMQ specific Direct Addressing capable connector was added</li>
  <li>Agent DDLs must be present on the servers, input validation is done against the DDL and prior to running user code</li>
  <li>DDL files can define default values for returned data - all declared data fields are pre-populated by agents</li>
  <li>DDL files can store general usage information that gets rendered via the help application</li>
  <li>DDL files can declare the minimum version mcollective they need to be functional and loading plugins on older mcollective versions will fail</li>
  <li>New validation logic in DDL files and Agents can now be delivered using plugins</li>
  <li>A thread safe caching system was added that users can use in their Agents to store information between invocations</li>
  <li>Code generators to assist writing agents</li>
  <li>Support deterministic random node selection</li>
  <li>Display mode can be overriden on the CLI using the new <em>&#8211;display</em> option</li>
  <li>The plugin packager will now keep source debs and rpms and has had major improvements done</li>
  <li>A new application called <em>completion</em> was added to assist in writing shell completion systems. ZSH and Bash examples are in <em>ext/</em></li>
  <li>Various improvements to documentation was made especially around using the CLI tools and discovery available plugins</li>
</ul>

<h3 id="bug-fixes-7">Bug Fixes</h3>

<ul>
  <li>The vendored systemu gem has been updated to remove a rude error message</li>
  <li>Improved error reporting in many areas</li>
  <li>Boolean and numeric data is correctly parsed on the RPC application command line</li>
  <li>Improved parsing of compound filters</li>
  <li>Batched requests will now all have the same request id thus improving consistency of auditing information</li>
</ul>

<h3 id="deprecations">Deprecations</h3>

<ul>
  <li>Remove the traditional Client#discovered_req method</li>
  <li>The metadata section in the agent is being removed as the DDL is now present everywhere</li>
</ul>

<h3 id="data-plugins">Data Plugins</h3>

<p>A new plugin type called <em>data plugins</em> have been added, these plugins are
usable in discovery requests and in any agent code.</p>

<p>You can use these plugins to expose any node side data to your client discovery
command line, an example can be seen below, this will discover all nodes where
<em>/etc/syslog.conf</em> has a md5 sum matching the regular expression <em>/19ff4997e/</em>:</p>

<div class="highlight"><pre><code class="console"><span class="gp">$</span> mco rpc rpcutil ping -S <span class="s2">&quot;fstat(&#39;/etc/rsyslog.conf&#39;).md5 = /19ff4997e/&quot;</span>
</code></pre>
</div>

<p>For full information see the plugins documentation on our website. The <em>fstat</em>
plugin seen above is included at the moment, more will be added in due course
but as always users can also write their own suitable to their needs.</p>

<h3 id="custom-discovery-sources">Custom Discovery Sources</h3>

<p>A new type of plugin that can be used as alternative data sources for discovery
data has been added. The traditional network broadcast mode is supported and
remains the default but a new flat file one was added.</p>

<p>Custom discovery sources can be made the default for a client using the
<em>default_discovery_method</em> configuration option but can be selected on the
command line using <em>&#8211;disc-method</em>.</p>

<p>All applications now have a <em>&#8211;nodes</em> option that takes as an argument a flat
file full of mcollective identity names, one per line.</p>

<p>Users can write their own discovery plugins and distribute it using the normal
plugin packager. A complex example can be seen in the community plugin site
for the MongoDB registration plugin.</p>

<p>In the event that the <em>-S</em> filter is used the network discovery mode will be
forced so that data source plugins in discovery queries will always work as
expected.</p>

<p>This feature requires Direct Addressing.</p>

<h3 id="ddl-files-on-the-servers">DDL files on the servers</h3>

<p>The DDL files now have to be on the servers and the clients. On the servers the
results will be pre-populated with default data for all defined output values of
a specific action and you can now supply defaults.</p>

<p>Additionally input will be validated on each node prior to running the agent
code providing consistent input validation on client and server.  This should
remove the need to add <em>validate</em> statements to agents.</p>

<p>An example for a Nagios plugin can be seen below, here we default to <em>UNKNOWN</em>
so that even if the action fails to run we will still see valid data being
returned thats appropriate for the specific use case.</p>

<div class="highlight"><pre><code class="ruby"><span class="n">action</span> <span class="s2">&quot;runcommand&quot;</span><span class="p">,</span> <span class="ss">:description</span> <span class="o">=&gt;</span> <span class="s2">&quot;Run a NRPE command&quot;</span> <span class="k">do</span>
  <span class="n">output</span> <span class="ss">:exitcode</span><span class="p">,</span>
         <span class="ss">:description</span>  <span class="o">=&gt;</span> <span class="s2">&quot;Exit Code from the Nagios plugin&quot;</span><span class="p">,</span>
         <span class="ss">:display_as</span>   <span class="o">=&gt;</span> <span class="s2">&quot;Exit Code&quot;</span><span class="p">,</span>
         <span class="ss">:default</span>      <span class="o">=&gt;</span> <span class="mi">3</span>
<span class="k">end</span>
</code></pre>
</div>

<h3 id="summarization-plugins">Summarization Plugins</h3>

<p>Often custom applications are written just to summarize data like the <em>facts</em>
application or <em>nrpe</em> ones.</p>

<p>We have added a new plugin type that allows you to define summarization logic
and included a few of our own.  These summaries are declared in the DDL, here is
a section from the new DDL for the <em>get_fact</em> action:</p>

<div class="highlight"><pre><code class="ruby"><span class="n">action</span> <span class="s2">&quot;get_fact&quot;</span><span class="p">,</span> <span class="ss">:description</span> <span class="o">=&gt;</span> <span class="s2">&quot;Retrieve a single fact from the fact store&quot;</span> <span class="k">do</span>
  <span class="n">output</span> <span class="ss">:value</span><span class="p">,</span>
          <span class="ss">:description</span> <span class="o">=&gt;</span> <span class="s2">&quot;The value of the fact&quot;</span><span class="p">,</span>
          <span class="ss">:display_as</span> <span class="o">=&gt;</span> <span class="s2">&quot;Value&quot;</span>

  <span class="n">summarize</span> <span class="k">do</span>
    <span class="n">aggregate</span> <span class="n">summary</span><span class="p">(</span><span class="ss">:value</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
</div>

<p>Here we are using the <em>summarize</em> block to say that we wish to summarize the
output <em>:value</em>.  The <em>summary(:value)</em> is the call to a custom plugin and you
can provide your own.</p>

<p>Now when interacting with this action you will see summaries produced
automatically:</p>

<div class="highlight"><pre><code class="ruby"><span class="sx">% mco </span><span class="n">rpc</span> <span class="n">rpcutil</span> <span class="n">get_fact</span> <span class="n">fact</span><span class="o">=</span><span class="n">operatingsystemrelease</span>
<span class="o">.</span>
<span class="o">.</span>
<span class="n">dev2</span>
    <span class="no">Fact</span><span class="p">:</span> <span class="n">operatingsystemrelease</span>
   <span class="no">Value</span><span class="p">:</span> <span class="mi">6</span><span class="o">.</span><span class="mi">2</span>


<span class="no">Summary</span> <span class="n">of</span> <span class="no">Value</span><span class="p">:</span>

    <span class="mi">6</span><span class="o">.</span><span class="mi">2</span> <span class="o">=</span> <span class="mi">19</span>
    <span class="mi">6</span><span class="o">.</span><span class="mi">3</span> <span class="o">=</span> <span class="mi">7</span>

<span class="no">Finished</span> <span class="n">processing</span> <span class="mi">26</span> <span class="o">/</span> <span class="mi">26</span> <span class="n">hosts</span> <span class="k">in</span> <span class="mi">294</span><span class="o">.</span><span class="mi">97</span> <span class="n">ms</span>
</code></pre>
</div>

<p>The last section of the rpc output shows the summarization in action.</p>

<p>The NRPE plugin on GitHub shows an example of a Nagios specific aggregation
function and the plugin packager supports distributing these plugins.</p>

<h3 id="validation-plugins">Validation Plugins</h3>

<p>Users can now write their own plugins to perform input validation, these
validations are usable in DDL files and agents.</p>

<p>Below is a snippet from a DDL file using a custom <em>exim_msgid</em> validation
plugin:</p>

<div class="highlight"><pre><code class="ruby">    <span class="n">input</span> <span class="ss">:msgid</span><span class="p">,</span>
          <span class="ss">:prompt</span>      <span class="o">=&gt;</span> <span class="s2">&quot;Message ID&quot;</span><span class="p">,</span>
          <span class="ss">:description</span> <span class="o">=&gt;</span> <span class="s2">&quot;Valid message id currently in the mail queue&quot;</span><span class="p">,</span>
          <span class="ss">:type</span>        <span class="o">=&gt;</span> <span class="ss">:string</span><span class="p">,</span>
          <span class="ss">:validation</span>  <span class="o">=&gt;</span> <span class="ss">:exim_msgid</span><span class="p">,</span>
          <span class="ss">:optional</span>    <span class="o">=&gt;</span> <span class="kp">false</span><span class="p">,</span>
          <span class="ss">:maxlength</span>   <span class="o">=&gt;</span> <span class="mi">16</span>
</code></pre>
</div>

<p>And a snippet using the same plugin inside your agent:</p>

<div class="highlight"><pre><code class="ruby"><span class="n">action</span> <span class="s2">&quot;retrymsg&quot;</span> <span class="k">do</span>
  <span class="n">validate</span> <span class="ss">:msgid</span><span class="p">,</span> <span class="ss">:exim_msgid</span>

  <span class="c1"># call out to exim to retry the message</span>
<span class="k">end</span>
</code></pre>
</div>

<p>The error messages shown when validation fails are more user friendly than
before, in this example the new error would be <em>Not a valid Exim Message ID</em>
where in the past it would have been <em>value should match ^(?:[+-]\d{4})?(?:[\d+] )?(\w{6}-\w{6}-\w{2})/</em></p>

<h3 id="code-generation">Code generation</h3>

<p>Code for agents and data sources can now be generated to assist development, you
can use the <em>plugin</em> command to create a basic skeleton agent or data source
including the DDL files.</p>

<div class="highlight"><pre><code class="console"><span class="gp">$</span> mco plugin generate agent myagent <span class="nv">actions</span><span class="o">=</span>do_something,do_something_else
</code></pre>
</div>

<p>Defaults used in the metadata templates can be set in the config file:</p>

<div class="highlight"><pre><code class="ini"><span class="na">plugin.metadata.url</span><span class="o">=</span><span class="s">http://devco.net</span>
<span class="na">plugin.metadata.author</span><span class="o">=</span><span class="s">R.I.Pienaar &lt;rip@devco.net&gt;</span>
<span class="na">plugin.metadata.license</span><span class="o">=</span><span class="s">ASL2.0</span>
<span class="na">plugin.metadata.version</span><span class="o">=</span><span class="s">0.0.1</span>
</code></pre>
</div>

<p>All generator produced output will have these settings set, the other fields are
constructed using a pattern convenient for using in your editor as a template.</p>

<h3 id="backwards-compatibility-and-upgrading-7">Backwards Compatibility and Upgrading</h3>

<p>As of this version every agent on every node and client must have a DDL file. If
the DDL file is not present or not valid the agent will not activate.  Further
input validation is done according to the content of the DDL prior to running
any actions.  You should therefore prepare for this upgrade by writing and
deploying DDL files for all your agents.</p>

<p>Version 2.0.0 and 2.2.0 can co-exist on the same network. If a new client uses
any of the new features added such as data plugins the older clients will simply
refuse to run the request but requests using features shared between versions
will continue to work.</p>

<p>When you first start this version of mcollectived you will see warnings logged
similar to the one below:</p>

<div class="highlight"><pre><code class="ruby"><span class="n">puppetd</span><span class="o">.</span><span class="n">rb</span><span class="p">:</span><span class="mi">26</span><span class="p">:</span> <span class="n">setting</span> <span class="n">meta</span> <span class="n">data</span> <span class="k">in</span> <span class="n">agents</span> <span class="n">have</span> <span class="n">been</span> <span class="n">deprecated</span><span class="p">,</span> <span class="no">DDL</span> <span class="n">files</span> <span class="n">are</span> <span class="n">now</span> <span class="n">being</span> <span class="n">used</span> <span class="k">for</span> <span class="n">this</span> <span class="n">information</span><span class="o">.</span>
</code></pre>
</div>

<p>This is only a warning and not a critical problem.  The next major release will
remove support for metadata in agents.</p>

<p>Upgrading from versions prior to 2.0.0 was not tested, please refer to the
release notes for 2.0.0.</p>

<p><a name="2_1_1">&nbsp;</a></p>

<h2 id="section-9">2.1.1 - 2012/07/12</h2>

<p>This release features major new features, enhancements and bug fixes.</p>

<p>This release is for early adopters, production users should consider the 2.0.x
series.</p>

<h3 id="major-enhancements-1">Major Enhancements</h3>

<ul>
  <li>A new discovery source was added capable of querying agent properties</li>
  <li>When doing limited discovery you can now supply a random seed for deterministic random selection</li>
  <li>A <em>get_data</em> action has been added to the <em>rpcutil</em> agent to retrieve the result of a data plugin</li>
  <li>RPC Agents must have DDLs on the MCollective Servers, agents will not load without them</li>
  <li>Output values can now have defaults assigned in the DDL, the server will set those defaults before running an action</li>
  <li>A new plugin type used to summarize sets of replies has been added. Summarization is declared in the DDL for an Agent</li>
</ul>

<h3 id="bug-fixes-8">Bug Fixes</h3>

<ul>
  <li>Correctly parse numeric and boolean input arguments in the RPC application</li>
</ul>

<h3 id="deprecations-1">Deprecations</h3>

<ul>
  <li>The old <em>Client#discovered_req</em> is removed along with the <em>controller</em> application that used it</li>
  <li>Parsing compound filters were improved wrt complex regular expressions</li>
  <li>Metadata sections in agents are not needed anymore and deprecation notices are logged when they are found</li>
</ul>

<h3 id="summarization-plugins-1">Summarization Plugins</h3>

<p>Often custom applications are written just to summarize data like the <em>facts</em>
application or <em>nrpe</em> ones.</p>

<p>We have added a new plugin type that allows you to define summarization logic
and included a few of our own.  These summaries are declared in the DDL, here is
a section from the new DDL for the <em>get_fact</em> action:</p>

<div class="highlight"><pre><code class="ruby"><span class="n">action</span> <span class="s2">&quot;get_fact&quot;</span><span class="p">,</span> <span class="ss">:description</span> <span class="o">=&gt;</span> <span class="s2">&quot;Retrieve a single fact from the fact store&quot;</span> <span class="k">do</span>
  <span class="n">output</span> <span class="ss">:value</span><span class="p">,</span>
          <span class="ss">:description</span> <span class="o">=&gt;</span> <span class="s2">&quot;The value of the fact&quot;</span><span class="p">,</span>
          <span class="ss">:display_as</span> <span class="o">=&gt;</span> <span class="s2">&quot;Value&quot;</span>

  <span class="n">summarize</span> <span class="k">do</span>
    <span class="n">aggregate</span> <span class="n">summary</span><span class="p">(</span><span class="ss">:value</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
</div>

<p>Here we are using the <em>summarize</em> block to say that we wish to summarize the
output <em>:value</em>.  The <em>summary(:value)</em> is the call to a custom plugin and you
can provide your own.</p>

<p>Now when interacting with this action you will see summaries produced
automatically:</p>

<div class="highlight"><pre><code class="ruby"><span class="sx">% mco </span><span class="n">rpc</span> <span class="n">rpcutil</span> <span class="n">get_fact</span> <span class="n">fact</span><span class="o">=</span><span class="n">operatingsystemrelease</span>
<span class="o">.</span>
<span class="o">.</span>
<span class="n">dev2</span>
    <span class="no">Fact</span><span class="p">:</span> <span class="n">operatingsystemrelease</span>
   <span class="no">Value</span><span class="p">:</span> <span class="mi">6</span><span class="o">.</span><span class="mi">2</span>


<span class="no">Summary</span> <span class="n">of</span> <span class="no">Value</span><span class="p">:</span>

    <span class="mi">6</span><span class="o">.</span><span class="mi">2</span> <span class="o">=</span> <span class="mi">19</span>
    <span class="mi">6</span><span class="o">.</span><span class="mi">3</span> <span class="o">=</span> <span class="mi">7</span>

<span class="no">Finished</span> <span class="n">processing</span> <span class="mi">26</span> <span class="o">/</span> <span class="mi">26</span> <span class="n">hosts</span> <span class="k">in</span> <span class="mi">294</span><span class="o">.</span><span class="mi">97</span> <span class="n">ms</span>
</code></pre>
</div>

<p>The last section of the rpc output shows the summarization in action.</p>

<p>The NRPE plugin on GitHub shows an example of a Nagios specific aggregation
function and the plugin packager supports distributing these plugins.</p>

<h3 id="ddl-files-on-the-servers-1">DDL files on the servers</h3>

<p>The DDL files now have to be on the servers and the clients.  On the servers the
results will be pre-populated with default data for all defined output values of
a specific action and you can now supply defaults.</p>

<p>An example for a Nagios plugin can be seen below, here we default to <em>UNKNOWN</em>
so that even if the action fails to run we will still see valid data being
returned thats appropriate for the specific use case.</p>

<div class="highlight"><pre><code class="ruby"><span class="n">action</span> <span class="s2">&quot;runcommand&quot;</span><span class="p">,</span> <span class="ss">:description</span> <span class="o">=&gt;</span> <span class="s2">&quot;Run a NRPE command&quot;</span> <span class="k">do</span>
  <span class="n">output</span> <span class="ss">:exitcode</span><span class="p">,</span>
         <span class="ss">:description</span>  <span class="o">=&gt;</span> <span class="s2">&quot;Exit Code from the Nagios plugin&quot;</span><span class="p">,</span>
         <span class="ss">:display_as</span>   <span class="o">=&gt;</span> <span class="s2">&quot;Exit Code&quot;</span><span class="p">,</span>
         <span class="ss">:default</span>      <span class="o">=&gt;</span> <span class="mi">3</span>
<span class="k">end</span>
</code></pre>
</div>

<p>As the servers now have the DDL the <em>metadata</em> section at the top of agents are
not needed anymore and deprecations will be logged when the mcollectived starts
up warning you of this.</p>

<h3 id="backwards-compatibility-and-upgrading-8">Backwards Compatibility and Upgrading</h3>

<p>As this release now requires DDL files to exist before an agent can be loaded in
the server you might have to adjust your deployment strategy and possibly write
some DDLs for your custom agents.  The DDL files have to be on both client and
servers.</p>

<p>The servers will now pre-populate the replies with all output defined in the DDL
and supply defaults if no default is provided in the DDL it will default to nil.
This might potentially change the behavior of custom applications that are
designed around the approach of checking if a field is included in the results
or not.</p>

<p>When you first start this version of mcollectived you will see warnings logged
similar to the one below:</p>

<div class="highlight"><pre><code class="ruby"><span class="n">puppetd</span><span class="o">.</span><span class="n">rb</span><span class="p">:</span><span class="mi">26</span><span class="p">:</span> <span class="n">setting</span> <span class="n">meta</span> <span class="n">data</span> <span class="k">in</span> <span class="n">agents</span> <span class="n">have</span> <span class="n">been</span> <span class="n">deprecated</span><span class="p">,</span> <span class="no">DDL</span> <span class="n">files</span> <span class="n">are</span> <span class="n">now</span> <span class="n">being</span> <span class="n">used</span> <span class="k">for</span> <span class="n">this</span> <span class="n">information</span><span class="o">.</span>
</code></pre>
</div>

<p>This is only a warning and not a critical problem.  Once 2.2.0 is out we will be
updating all the agents to remove metadata sections in favour of those in the DDL.
You should also remove metadata from your own agents.</p>

<h3 id="changes-since-210-1">Changes since 2.1.0</h3>

<table>
  <thead>
    <tr>
      <th>Date</th>
      <th>Description</th>
      <th>Ticket</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2012/07/11</td>
      <td>Add a &#8211;display option to RPC clients that overrides the DDL display mode</td>
      <td>15273</td>
    </tr>
    <tr>
      <td>2012/07/10</td>
      <td>Do not add a metadata to agents created with the generator as they are now deprecated</td>
      <td>15445</td>
    </tr>
    <tr>
      <td>2012/07/03</td>
      <td>Correctly parse numeric and boolean data on the CLI in the rpc application</td>
      <td>15344</td>
    </tr>
    <tr>
      <td>2012/07/03</td>
      <td>Fix a bug related to parsing regular expressions in compound statements</td>
      <td>15323</td>
    </tr>
    <tr>
      <td>2012/07/02</td>
      <td>Update vim snippets in ext for new DDL features</td>
      <td>15273</td>
    </tr>
    <tr>
      <td>2012/06/29</td>
      <td>Create a common package for agent packages containing the DDL for servers and clients</td>
      <td>15268</td>
    </tr>
    <tr>
      <td>2012/06/28</td>
      <td>Improve parsing of compound filters where the first argument is a class</td>
      <td>15271</td>
    </tr>
    <tr>
      <td>2012/06/28</td>
      <td>Add the ability to declare automatic result summarization in the DDL files for agents</td>
      <td>15031</td>
    </tr>
    <tr>
      <td>2012/06/26</td>
      <td>Surpress subscribing to reply queues when no reply is expected</td>
      <td>15226</td>
    </tr>
    <tr>
      <td>2012/06/25</td>
      <td>Batched RPC requests will now all have the same requestid</td>
      <td>15195</td>
    </tr>
    <tr>
      <td>2012/06/25</td>
      <td>Record the request id on M::Client and in the RPC client stats</td>
      <td>15194</td>
    </tr>
    <tr>
      <td>2012/06/24</td>
      <td>Use UUIDs for the request id rather than our own weak implementation</td>
      <td>15191</td>
    </tr>
    <tr>
      <td>2012/06/18</td>
      <td>The DDL can now define defaults for outputs and the RPC replies are pre-populated</td>
      <td>15087</td>
    </tr>
    <tr>
      <td>2012/06/18</td>
      <td>Remove unused agent help code</td>
      <td>15084</td>
    </tr>
    <tr>
      <td>2012/06/18</td>
      <td>Remove unused code from the <em>discovery</em> agent related to inventory and facts</td>
      <td>15083</td>
    </tr>
    <tr>
      <td>2012/06/18</td>
      <td>Nodes will now refuse to load RPC agents without DDL files</td>
      <td>15082</td>
    </tr>
    <tr>
      <td>2012/06/18</td>
      <td>The Plugin Name and Type is now available to DDL objects</td>
      <td>15076</td>
    </tr>
    <tr>
      <td>2012/06/15</td>
      <td>Add a get_data action to the rpcutil agent that can retrieve data from data plugins</td>
      <td>15057</td>
    </tr>
    <tr>
      <td>2012/06/14</td>
      <td>Allow the random selection of nodes to be deterministic</td>
      <td>14960</td>
    </tr>
    <tr>
      <td>2012/06/12</td>
      <td>Remove the Client#discovered_req method and add warnings to the documentation about its use</td>
      <td>14777</td>
    </tr>
    <tr>
      <td>2012/06/11</td>
      <td>Add a discovery source capable of doing introspection on running agents</td>
      <td>14945</td>
    </tr>
    <tr>
      <td>2012/06/11</td>
      <td>Only do identity filter optimisations for the <em>mc</em> discovery source</td>
      <td>14942</td>
    </tr>
  </tbody>
</table>

<p><a name="2_1_0">&nbsp;</a></p>

<h2 id="section-10">2.1.0 - 2012/06/08</h2>

<p>This is the first release in the new development series of MCollective.  This
releas features major new features and enhancements.</p>

<p>This release is for early adopters, production users should consider the 2.0.x
series.</p>

<h3 id="major-enhancements-2">Major Enhancements</h3>

<ul>
  <li>Discovery requests can now run custom data plugins on nodes to facilitate discovery against any node-side data</li>
  <li>Discovery sources are now pluggable, one supporting flat files are included in this release</li>
  <li>All applications now have a &#8211;nodes option to read a text file of identities to operate on</li>
  <li>A new <em>completion</em> application was added to assist with shell completion systems, zsh and bash tab completion plugins are in ext</li>
  <li>Users can now use a generator to create skeleton agents and data sources</li>
</ul>

<h3 id="changes-in-behavior">Changes in behavior</h3>

<ul>
  <li>The <em>mco controller</em> application is being deprecated for the next major release and has now been removed from the development series</li>
  <li>The <em>mco find</em> application is now a discovery client so it&#8217;s output mode has changed slightly but the functionality stays the same</li>
</ul>

<h3 id="bug-fixes-9">Bug Fixes</h3>

<ul>
  <li>Numerous small improvement to user facing errors and status outputs have been made</li>
  <li>Sub collectives combined with direct addressing has been fixed</li>
  <li>Various packaging issues were resolved</li>
  <li>The ActiveMQ and Stomp connectors will now by default handle dual homed IPv6 and IPv4 hosts better in cases where the IPv6 target isn&#8217;t reachable</li>
</ul>

<h3 id="data-plugins-1">Data Plugins</h3>

<p>A new plugin type called <em>data plugins</em> have been added, these plugins are
usable in discovery requests and in any agent code.</p>

<p>You can use these plugins to expose any node side data to your client discovery
command line, an example can be seen below, this will discover all nodes where
<em>/etc/syslog.conf</em> has a md5 sum matching the regular expression
<em>/19ff4997e/</em>:</p>

<div class="highlight"><pre><code class="console"><span class="gp">$</span> mco rpc rpcutil ping -S <span class="s2">&quot;fstat(&#39;/etc/rsyslog.conf&#39;).md5 = /19ff4997e/&quot;</span>
</code></pre>
</div>

<p>For full information see the plugins documentation on our website. The <em>fstat</em>
plugin seen above is included at the moment, more will be added in due course
but as always users can also write their own suitable to their needs.</p>

<h3 id="custom-discovery-sources-1">Custom Discovery Sources</h3>

<p>Since the introduction of direct addressing mode in 2.0.0 you&#8217;ve been able to
pragmatically specify arbitrary host lists as discovery data but this was never
exposed to the user interface.</p>

<p>We now introduce plugins that can be used as alternative data sources and
include the traditional network broadcast mode and a flat file one.  The hope
is that more will be added in future perhaps integrating with systems like
PuppetDB.  There is also one that uses the MongoDB Registration plugin to build
a local node cache.</p>

<p>Custom discovery sources can be made the default for a client using the
<em>default_discovery_method</em> configuration option but can be selected on the
command line using <em>&#8211;disc-method</em>.</p>

<p>All applications now have a <em>&#8211;nodes</em> option that takes as an argument a flat
file full of mcollective identity names, one per line.</p>

<p>Users can write their own discovery plugins and distribute it using the normal
plugin packager.</p>

<p>In the event that the <em>-S</em> filter is used the network discovery mode will be
forced so that data source plugins in discovery queries will always work as
expected.</p>

<h3 id="code-generation-1">Code generation</h3>

<p>Code for agents and data sources can now be generated to assist development,
you can use the <em>plugin</em> command to create a basic skeleton agent or data source
including the DDL files.</p>

<div class="highlight"><pre><code class="console"><span class="gp">$</span> mco plugin generate agent myagent <span class="nv">actions</span><span class="o">=</span>do_something,do_something_else
</code></pre>
</div>

<p>Defaults used in the metadata templates can be set in the config file:</p>

<div class="highlight"><pre><code class="ini"><span class="na">plugin.metadata.url</span><span class="o">=</span><span class="s">http://devco.net</span>
<span class="na">plugin.metadata.author</span><span class="o">=</span><span class="s">R.I.Pienaar &lt;rip@devco.net&gt;</span>
<span class="na">plugin.metadata.license</span><span class="o">=</span><span class="s">ASL2.0</span>
<span class="na">plugin.metadata.version</span><span class="o">=</span><span class="s">0.0.1</span>
</code></pre>
</div>

<p>All generator produced output will have these settings set, the other fields
are constructed using a pattern convenient for using in your editor as a
template.</p>

<h3 id="backwards-compatibility-and-upgrading-9">Backwards Compatibility and Upgrading</h3>

<p>This release can co-exist with 2.0.0 but using the new discovery data plugins in a
mixed environment will result in the old nodes not being discovered and they will
log exceptions in their logs.  This was done by choice and ensures the safest
possible upgrade path.</p>

<p>When the 2.0.0 collective is running with directed mode enabled a client using the
new discovery plugins will be able to communicate wth the older nodes without
problem.</p>

<h3 id="changes-since-200">Changes since 2.0.0</h3>

<table>
  <thead>
    <tr>
      <th>Date</th>
      <th>Description</th>
      <th>Ticket</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2012/06/07</td>
      <td>Force discovery state to be reset when changing collectives in the RPC client</td>
      <td>14874</td>
    </tr>
    <tr>
      <td>2012/06/07</td>
      <td>Create code generators for agents and data plugins</td>
      <td>14717</td>
    </tr>
    <tr>
      <td>2012/06/07</td>
      <td>Fix the <em>No response from</em> report to be correctly formatted</td>
      <td>14868</td>
    </tr>
    <tr>
      <td>2012/06/07</td>
      <td>Sub collectives and direct addressing mode now works correctly</td>
      <td>14668</td>
    </tr>
    <tr>
      <td>2012/06/07</td>
      <td>The discovery method is now pluggable, included is one supporting flat files</td>
      <td>14255</td>
    </tr>
    <tr>
      <td>2012/05/28</td>
      <td>Add an application to assist shell completion systems with bash and zsh completion plugins</td>
      <td>14196</td>
    </tr>
    <tr>
      <td>2012/05/22</td>
      <td>Improve error messages from the packager when a DDL file cannot be found</td>
      <td>14595</td>
    </tr>
    <tr>
      <td>2012/05/17</td>
      <td>Add a dependency on stomp to the rubygem</td>
      <td>14300</td>
    </tr>
    <tr>
      <td>2012/05/17</td>
      <td>Adjust the ActiveMQ and Stomp connect_timeout to allow IPv4 fall back to happen in dual homed hosts</td>
      <td>14496</td>
    </tr>
    <tr>
      <td>2012/05/16</td>
      <td>Add a plugable data source usable in discovery and other plugins</td>
      <td>14254</td>
    </tr>
    <tr>
      <td>2012/05/04</td>
      <td>Improve version dependencies and upgrade experience of debian packages</td>
      <td>14277</td>
    </tr>
    <tr>
      <td>2012/05/03</td>
      <td>Add the ability for the DDL to load DDL files from any plugin type</td>
      <td>14293</td>
    </tr>
    <tr>
      <td>2012/05/03</td>
      <td>Rename the MCollective::RPC::DDL to MCollective::DDL to match its larger role in all plugins</td>
      <td>14254</td>
    </tr>
  </tbody>
</table>

<p><a name="2_0_0">&nbsp;</a></p>

<h2 id="section-11">2.0.0 - 2012/04/30</h2>

<p>This is the next production release of MCollective.  It brings to an
end active support for versions 1.3.3 and older.</p>

<p>This release brings to general availability all the features added in the
1.3.x development series.</p>

<h3 id="major-enhancements-3">Major Enhancements</h3>

<ul>
  <li>Complete messaging protocol rewrite to enable direct style connectivity that would allow programs to bypass normal discovery instead using their own data sources</li>
  <li>An additional more robust messaging paradigm supporting a more assured addressing and delivery scheme</li>
  <li>Batched mode allowing users to address machines in small groups thus avoiding thundering herd and enabling more granular changes</li>
  <li>A more complete language for expressing discovery that includes and/or/not style queries across the infrastructure</li>
  <li>Improved Stomp connection security using normal industry standard Certificate Authority validated TLS</li>
  <li>New connector that uses ActiveMQ specific features for better performance and scalability</li>
  <li>Security of the SSL and AES security plugins have been improved for tamper protection by middle men</li>
  <li>A message validity period has been introduced to lower the window of message replay attacks</li>
  <li>Better error handling and better logging for Stomp connections</li>
  <li>JSON output from the &#8216;rpc&#8217; application</li>
  <li>Ability to pipe RPC requests into each other creating a chain of related RPC calls</li>
  <li>Better validations, better error handling and better documentation creation from the DDL</li>
  <li>Performance improvements in the CLI, more consistently formatted output of received data</li>
  <li>A Ruby GEM of the client is now made available on rubygems.org</li>
  <li>The rc script for Debian based systems have been improved to prevent duplicate daemons from running</li>
  <li>Built in packager for plugins into native OS packages - RedHat and Debian supported</li>
  <li>MS Windows Support</li>
</ul>

<h3 id="point-to-point-comms">Point to Point comms</h3>

<p>Previously MCollective could only broadcast messages and was tied to a discovery model.</p>

<p>The messaging layer now supports per node destinations that allows you to address a node, even if its down,
doesn&#8217;t yet exist or if you cannot come up with a filter that would match a group of arbitrarily selected
nodes.</p>

<p>When this mode is in use the user configure which machine to communicate with using either text, arrays or
JSON data.  It will then communicate directly to those nodes via the middleware and if any of them are down
you will get the usual no responses report after DDL configured timeout, this is a smooth transparent to the
end user mix in communication modes.</p>

<p>It is ideal for building deployers, web apps and so forth where you know exactly which nodes should be there
and you&#8217;d like to influence the MCollective network addressing, perhaps from a CMDB you built yourself.</p>

<p>This is the start towards an assured style of delivery, you can consider it the TCP to MCollective&#8217;s UDP.
Both modes of communication will be supported in the future and both will have access to all the same agents
and clients.</p>

<p>This is feature is enabled using the <em>direct_addressing</em> configuration option. At present only the new
ActiveMQ connector supports this at scale.  The ActiveMQ connector is now the recommended standard connector
combined with Apache ActiveMQ.  More brokers could be supported in future.</p>

<h3 id="pluggable--optional-discovery">Pluggable / Optional Discovery</h3>

<p>If the user did <em>mco rpc rpcutil ping -I box.example.com -I another.example.com</em> mcollective will now just
assume you know what she wants, it won&#8217;t do a discover to confirm those machines exist or not, it will just go
and communicate with them.  This is a big end user visible speed improvement.  If however you did a filter
like <em>-I /example.com/</em> mcollective cannot know which machines you want to reach and so a traditional
broadcast discovery is done first.</p>

<p>When the direct addressing mode is enabled various behind the scenes optimizations are being done:</p>

<ul>
  <li>If a discovery is done and it finds you only want to address 10 or fewer nodes it will use direct mode for that
request.  This avoids a second needless broadcast.  This is less efficient to the middleware but does not send
needless messages to uninterested nodes that would then just ignore them.</li>
  <li>The <em>rpc</em> application supports piping output from one to the next.  Example of this below.</li>
</ul>

<div class="highlight"><pre><code class="console"><span class="gp">$</span> mco rpc package update <span class="nv">package</span><span class="o">=</span>foo -W <span class="nv">customer</span><span class="o">=</span>acme -j|mco rpc service restart <span class="nv">service</span><span class="o">=</span>bar
</code></pre>
</div>

<p>This will update a package on machines matching <em>customer=foo</em> and then restart the service <em>bar</em> on those
machines.</p>

<p>The first request is doing traditional discovery based on the fact while the 2nd request is not doing
discovery at all, it uses the JSON output enabled by -j as discovery data and then restart the service on only
those machines.</p>

<p>These abilities are exposed in the SimpleRPC client API and you can write your own schemes, query your own
databases etc</p>

<h3 id="batching">Batching</h3>

<p>Often the speed of MCollective is a problem, you want to install a package on thousands of machines but your
APT or YUM server isn&#8217;t up to the task.</p>

<p>You can now do batching of requests:</p>

<div class="highlight"><pre><code class="console"><span class="gp">$</span> mco package update myapp --batch 10 --batch-sleep 60
</code></pre>
</div>

<p>This performs the update as usual but only affecting machines in groups of 10 and sleeps for a minute between.</p>

<p>You can also access this functionality via the API please see the docs for usage.  Any existing script or
application should support this functionality without any code changes.</p>

<p>The results, error reporting, statistics reporting and so forth all stays consistent with non batched
behavior.</p>

<p>At any time you can interrupt the process and only the current group of machines will have been affected.</p>

<p>The batching requires a direct addressing capable collective as it is built using the new direct to node
communications and pluggable discovery features</p>

<h3 id="activemq-specific-connector">ActiveMQ specific connector</h3>

<p>A new connector plugin has been added that is specific to ActiveMQ and is compatible with the new direct
addressing communication system.</p>

<p>You will need to change your ActiveMQ configuration to support this plugin, see the documentation for this
plugin and the examples in <em>ext/activemq</em> have also been updated for the new plugin.</p>

<p>Anyone who use ActiveMQ is strongly recommended to use this plugin as it uses a few ActiveMQ specific
optimizations that can have a big performance enhancing effect on your collective.</p>

<h3 id="packaging-agent-plugins">Packaging Agent plugins</h3>

<p>Distributing agents has been a problem as they are just files that have limited meta data and attached.</p>

<p>We now support packaging agents into rpm or deb packages, your agent must have a DDL file for this to work:</p>

<div class="highlight"><pre><code class="console"><span class="gp">$</span> mco plugin package . --vendor <span class="s2">&quot;My Company&quot;</span>
<span class="go">Successfully built RPM &#39;mcollective-exim_ng-client-0.1-1.noarch.rpm&#39;</span>
<span class="go">Successfully built RPM &#39;mcollective-exim_ng-common-0.1-1.noarch.rpm&#39;</span>
<span class="go">Successfully built RPM &#39;mcollective-exim_ng-agent-0.1-1.noarch.rpm&#39;</span>
</code></pre>
</div>

<p>The packages will have meta data like Author, Version and so forth as per your DDL file.</p>

<p>Users can provide their own packaging implementations for other package managers or custom layouts using the
MCollective plugin system.</p>

<h3 id="full-verified-ca">Full verified CA</h3>

<p>When using the new ActiveMQ specific connector combined with Stomp version 1.2.2 or newer you can get full CA
verified connection handling ensuring that only clients using signed certificates can connect to ActiveMQ.</p>

<p>The documentation for the ActiveMQ SSL setup now includes instructions on setting up ActiveMQ and your clients
using the built in Puppet CA but any CA could be used to manage these certificates.</p>

<p>This feature will work best when ActiveMQ 5.6.0 is released in a few weeks since there will then be a NIO+SSL
Stomp connector. The current SNAPSHOT release of ActiveMQ has this feature as well as the most recent Service
Pack release of the Fuse Message Broker.</p>

<h3 id="ms-windows-support">MS Windows Support</h3>

<p>The MS Windows platform is now supported as both a client and a server.  The <em>ext/windows</em> directory has some
helpers and read me documentation that has been confirmed to work but we have not yet completed packaging
ourselves so this is still a manual process.</p>

<p>Combined with Puppet 2.7.12 or newer the Package and Service agents can be used to manage Windows resources
using the same commands as those on Linux via mcollective.</p>

<h3 id="new-discovery-language">New Discovery Language</h3>

<p>Previously dicovery was very limited, filters were simply run one after the other and you could not do
anything complex like a mix of OR and AND boolean logic.</p>

<p>A new compact discovery language was introduced perfect for use on the command line, an example below:</p>

<div class="highlight"><pre><code class="console"><span class="gp">$</span> mco find -S <span class="s2">&quot;((fqdn=/example.com/ or fqdn=/another.com/) or customer=acme) and apache and physicalprocessorcount&gt;2&quot;</span>
</code></pre>
</div>

<p>The EBNF for this language can be seen below, it&#8217;s available on the command line and the API</p>

<pre><code>compound = ["("] expression [")"] {["("] expression [")"]}
expression = [!|not]statement ["and"|"or"] [!|not] statement
char = A-Z | a-z | &lt; | &gt; | =&gt; | =&lt; | _ | - |* | / { A-Z | a-z | &lt; | &gt; | =&gt; | =&lt; | _ | - | * | / | }
int = 0|1|2|3|4|5|6|7|8|9{|0|1|2|3|4|5|6|7|8|9|0}
</code></pre>

<h3 id="backwards-compatibility-and-upgrading-10">Backwards Compatibility and Upgrading</h3>

<p>This release is not compatible with older versions. Client scripts and agents written for older versions will
continue to work but a network hosting both 2.0.0 clients and older one will effectively be split into 2
networks.  While planning your upgrade you should plan to have machines running the client for both versions
to retain full control during upgrade.  The upgrade is best done in an scheduled window where all machines are
updated together.</p>

<p>While upgrading you must ensure that the plugins that come with the release are updated at the same time as
the release.  Older security and connector plugins will not function with this release.  This also means if
you wrote your own connector or security plugin you will need to port these prior to upgrading.</p>

<p>Past this it should be a simple matter of updating using your operating systems package manager.</p>

<p>We recommend you switch to the new ActiveMQ based connector plugin away from the previous generic Stomp one as
this is the primary supported method of deployment and the generic Stomp one will be deprecated in future.
Additionally the Stomp connector does not support the new direct messaging communications mode.</p>

<p>In order to upgrade to the new ActiveMQ connector you will need to change your broker setup including ACLs,
transport connectors, message policies and inter broker connections.  Sample configuration files for single
and multi broker setups can be found in the Git repository or the tar file in <em>ext/activemq</em></p>

<p><a name="1_3_3">&nbsp;</a></p>

<h2 id="section-12">1.3.3 - 2012/04/05</h2>

<p>This is a release in the development series of MCollective.  It feature major new features and bug fixes.</p>

<p>This release is for early adopters, production users should consider the 1.2.x series.</p>

<h3 id="major-enhancements-4">Major Enhancements</h3>

<ul>
  <li>The MS Windows platform is now supported, packaging is still outstanding</li>
  <li>Agents can now be packaged to native OS packages using the new <em>mco plugin</em> command</li>
  <li><em>mco help rpc</em> now show the help for the rpc application, <em>mco plugin doc puppetd</em> shows the help for the puppetd agent</li>
  <li>Full CA verified Stomp is supported and documented between ActiveMQ and MCollective using Stomp &gt; 1.2.2</li>
  <li>Application exit codes have been standardized using a new <em>halt</em> helper function</li>
  <li>A new validator that allows users to check if a supplied value is one of a fixed list</li>
  <li>The syslog facility can now be set in the configuration file</li>
  <li>The client libraries are now available as a Ruby Gem</li>
  <li>Batch mode can now be enabled and disabled at will in an application</li>
  <li>The client config files now default to console based logging at warn level</li>
</ul>

<h3 id="bug-fixes-10">Bug Fixes</h3>

<ul>
  <li>nil or empty results are correctly displayed by printrpc</li>
  <li>Some exceptions under Ruby 1.9.3 when using run() related to nil exit code has been fixed</li>
  <li>Various exceptions have been silence in inventory application, stomp plugin, rpc application and others</li>
  <li>Previous SSL_read errors when using the Stomp+TLS configuration is now avoided on Ruby 1.8</li>
</ul>

<h3 id="packaging-agent-plugins-1">Packaging Agent plugins</h3>

<p>Distributing agents has been a problem as they are just files that have limited meta data and attached.</p>

<p>We now support packaging agents into rpm or deb packages, your agent must have a DDL file
for this to work:</p>

<div class="highlight"><pre><code class="console"><span class="gp">$</span> mco plugin package . --vendor <span class="s2">&quot;My Company&quot;</span>
<span class="go">Successfully built RPM &#39;mcollective-exim_ng-client-0.1-1.noarch.rpm&#39;</span>
<span class="go">Successfully built RPM &#39;mcollective-exim_ng-common-0.1-1.noarch.rpm&#39;</span>
<span class="go">Successfully built RPM &#39;mcollective-exim_ng-agent-0.1-1.noarch.rpm&#39;</span>
</code></pre>
</div>

<p>The packages will have meta data like Author, Version and so forth as per your DDL file.</p>

<p>We support building all the main plugin types in this manner but need to restructure the plugins
repository to support this layout.</p>

<p>To use this you need to install the fpm gem, you must install 0.4.3 and not a newer version, we are
currently working on removing the fpm dependency as it&#8217;s proven to be too unreliable to use.</p>

<p>Users can provide their own packaging implementations for other package managers or custom layouts
using the MCollective plugin system.</p>

<h3 id="full-verified-ca-1">Full verified CA</h3>

<p>When using the new ActiveMQ specific connector combined with Stomp version 1.2.2 or newer you can
get full CA verified connection handling ensuring that only clients using signed certificates
can connect to ActiveMQ.</p>

<p>The documentation for the ActiveMQ SSL setup now includes instructions on setting up ActiveMQ and your
clients using the built in Puppet CA but any CA could be used to manage these certificates.</p>

<p>This feature will work best when ActiveMQ 5.6.0 is released in a few weeks since there will then be a NIO+SSL
Stomp connector. The current SNAPSHOT release of ActiveMQ has this feature as well as the most recent Service
Pack release of the Fuse Message Broker.</p>

<h3 id="ms-windows-support-1">MS Windows Support</h3>

<p>The MS Windows platform is now supported as both a client and a server.  The <em>ext/windows</em> directory
has some helpers and read me documentation that has been confirmed to work but we have not yet
completed packaging ourselves so this is still a manual process.</p>

<p>Combined with Puppet 2.7.12 or newer the Package and Service agents can be used to manage Windows
resources using the same commands as those on Linux via mcollective.</p>

<h3 id="backwards-compatibility">Backwards compatibility</h3>

<p>This release is backwards compatible with version 1.3.2, if you are coming from an older version please
review earlier release notes.</p>

<p>If you have been using the ActiveMQ specific plugin and its SSL settings you will now need to enable
fallback mode as it will now only connect to ActiveMQ machines that present the correct CA certificate
and will refuse to use anonymous certificates</p>

<div class="highlight"><pre><code class="ini"><span class="na">plugin.activemq.pool.1.ssl.fallback</span> <span class="o">=</span> <span class="s">1</span>
</code></pre>
</div>

<h3 id="changes-since-132">Changes since 1.3.2</h3>

<table>
  <thead>
    <tr>
      <th>Date</th>
      <th>Description</th>
      <th>Ticket</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2012/04/04</td>
      <td>Use the MCollective::SSL utility class for crypto functions in the SSL security plugin</td>
      <td>13615</td>
    </tr>
    <tr>
      <td>2012/04/02</td>
      <td>Support reading public keys from SSL Certificates as well as keys</td>
      <td>13534</td>
    </tr>
    <tr>
      <td>2012/04/02</td>
      <td>Move the help template to the common package for both Debian and RedHat</td>
      <td>13434</td>
    </tr>
    <tr>
      <td>2012/03/30</td>
      <td>Support Stomp 1.2.2 CA verified connection to ActiveMQ</td>
      <td>10596</td>
    </tr>
    <tr>
      <td>2012/03/27</td>
      <td><em>mco help rpc</em> now shows the help for the rpc application</td>
      <td>13350</td>
    </tr>
    <tr>
      <td>2012/03/22</td>
      <td>Add a mco command that creates native OS packaging for plugins</td>
      <td>12597</td>
    </tr>
    <tr>
      <td>2012/03/21</td>
      <td>Default to console based logging at warning level for clients</td>
      <td>13285</td>
    </tr>
    <tr>
      <td>2012/03/20</td>
      <td>Work around SSL_read errors when using SSL or AES plugins and Stomp+SSL in Ruby &lt; 1.9.3</td>
      <td>13207</td>
    </tr>
    <tr>
      <td>2012/03/16</td>
      <td>Improve logging for SSL connections when using Stomp Gem newer than 1.2.0</td>
      <td>13165</td>
    </tr>
    <tr>
      <td>2012/03/14</td>
      <td>Simplify handling of signals like TERM and INT and remove pid file on exit</td>
      <td>13105</td>
    </tr>
    <tr>
      <td>2012/03/13</td>
      <td>Create a conventional place to store implemented_by scripts</td>
      <td>13064</td>
    </tr>
    <tr>
      <td>2012/03/09</td>
      <td>Handle exceptions added to the Stomp 1.1 compliant versions of the Stomp gem</td>
      <td>13020</td>
    </tr>
    <tr>
      <td>2012/03/09</td>
      <td>Specifically enable reliable communications while using the pool style syntax</td>
      <td>13040</td>
    </tr>
    <tr>
      <td>2012/03/06</td>
      <td>Initial support for the Windows Platform</td>
      <td>12555</td>
    </tr>
    <tr>
      <td>2012/03/05</td>
      <td>Application plugins can now disable any of 3 sections of the standard CLI argument parsers</td>
      <td>12859</td>
    </tr>
    <tr>
      <td>2012/03/05</td>
      <td>Fix base 64 encoding and decoding of message payloads that would previous raise unexpected exceptions</td>
      <td>12950</td>
    </tr>
    <tr>
      <td>2012/03/02</td>
      <td>Treat :hosts and :nodes as equivalents when supplying discovery data, be more strict about flags discover will accept</td>
      <td>12852</td>
    </tr>
    <tr>
      <td>2012/03/02</td>
      <td>Allow exit() to be used everywhere in application plugins, not just in the main method</td>
      <td>12927</td>
    </tr>
    <tr>
      <td>2012/03/02</td>
      <td>Allow batch mode to be enabled and disabled on demand during the life of a client</td>
      <td>12854</td>
    </tr>
    <tr>
      <td>2012/02/29</td>
      <td>Show the progress bar before sending any requests to give users feedback as soon as possible rather than after first result only</td>
      <td>12865</td>
    </tr>
    <tr>
      <td>2012/02/23</td>
      <td>Do not log exceptions in the RPC application when a non existing action is called with request parameters</td>
      <td>12719</td>
    </tr>
    <tr>
      <td>2012/02/17</td>
      <td>Log miscellaneous Stomp errors at error level rather than debug</td>
      <td>12705</td>
    </tr>
    <tr>
      <td>2012/02/17</td>
      <td>Improve subscription tracking by using the subID feature of the Stomp gem and handle duplicate exceptions</td>
      <td>12703</td>
    </tr>
    <tr>
      <td>2012/02/15</td>
      <td>Improve error handling in the inventory application for non responsive nodes</td>
      <td>12638</td>
    </tr>
    <tr>
      <td>2012/02/14</td>
      <td>Comply to Red Hat guideline by not setting mcollective to start by default after RPM install</td>
      <td>9453</td>
    </tr>
    <tr>
      <td>2012/02/14</td>
      <td>Allow building the client libraries as a gem</td>
      <td>9383</td>
    </tr>
    <tr>
      <td>2012/02/13</td>
      <td>On Red Hat like systems read /etc/sysconfig/mcollective in the init script to allow modification of the environment</td>
      <td>7441</td>
    </tr>
    <tr>
      <td>2012/02/13</td>
      <td>Make the handling of symlinks to the mco script more robust to handle directories with mc- in their name</td>
      <td>6275</td>
    </tr>
    <tr>
      <td>2012/02/01</td>
      <td>systemu and therefore MC::Shell can sometimes return nil exit code, the run() method now handles this better by returning -1 exit status</td>
      <td>12082</td>
    </tr>
    <tr>
      <td>2012/01/27</td>
      <td>Improve handling of discovery data on STDIN to avoid failures when run without a TTY and without supplying discovery data</td>
      <td>12084</td>
    </tr>
    <tr>
      <td>2012/01/25</td>
      <td>Allow the syslog facility to be configured</td>
      <td>12109</td>
    </tr>
    <tr>
      <td>2012/01/13</td>
      <td>Add a RPC agent validator to ensure input is one of list of known good values</td>
      <td>11935</td>
    </tr>
    <tr>
      <td>2012/01/09</td>
      <td>The printrpc helper did not correctly display empty strings in received output</td>
      <td>11012</td>
    </tr>
    <tr>
      <td>2012/01/09</td>
      <td>Add a halt method to the Application framework and standardize exit codes</td>
      <td>11280</td>
    </tr>
    <tr>
      <td>2011/11/21</td>
      <td>Remove unintended dependency on <em>pp</em> in the ActiveMQ plugin</td>
      <td>10992</td>
    </tr>
    <tr>
      <td>2011/11/17</td>
      <td>Allow reply to destinations to be supplied on the command line or API</td>
      <td>9847</td>
    </tr>
  </tbody>
</table>

<p><a name="1_3_2">&nbsp;</a></p>

<h2 id="section-13">1.3.2 - 2011/11/17</h2>

<p>This is a release in the development series of MCollective.  It feature major new features.</p>

<p>This release is for early adopters, production users should consider the 1.2.x series.</p>

<h3 id="enhancements">Enhancements</h3>

<ul>
  <li>Handling of syntax errors in Application plugins have been improved</li>
  <li>The limit method can now be set per RPC Client instance</li>
  <li>Optionally show response distribution in the <em>ping</em> application with the <em>&#8211;graph</em> option</li>
  <li>Expose a statistic about expired messages via the <em>rpcutil</em> agent and show them in the inventory application.</li>
  <li>Remove all the <em>mc-</em> scripts that has been ported to applications</li>
  <li>AES and TTL security plugins prevent tampering with the TTL and Message Times</li>
  <li>The RPC client can now raise an exception rather than exit on failure - ideal for use in web apps</li>
  <li>Discovery during requests that has a specific limit count set have been sped up</li>
  <li>Specific types for :number, :float and :integer has been aded to the DDL and the RPC application has special handling for them</li>
  <li>Caller ID, Certificate Names and Identity Names can now only be word characters, full stop and dash</li>
  <li>Security plugins are now quicker to ignore miss directed messages</li>
  <li>The client now unsubscribes from topics it does not need anymore</li>
  <li>SimpleRPC now supports performing actions in batches with a sleep between each batch</li>
  <li>A direct request capable ActiveMQ specific plugin has been included</li>
  <li>Message TTLs can be set globally in the config or in the API</li>
</ul>

<h3 id="activemq-specific-connector-1">ActiveMQ specific connector</h3>

<p>A new connector plugin has been added that is specific to ActiveMQ and is compatible
with the new direct addressing communication system.</p>

<p>You will need to change your ActiveMQ configuration to support this plugin, see the
documentation for this plugin and the examples in <em>ext/activemq</em> have also been
updated for the new plugin.</p>

<p>Anyone who use ActiveMQ is strongly recommended to use this plugin as it uses a
few ActiveMQ specific optimizations that can have a big performance enhancing effect
on your collective.</p>

<h3 id="batching-1">Batching</h3>

<p>Often the speed of MCollective is a problem, you want to install a package on thousands
of machines but your APT or YUM server isn&#8217;t up to the task.</p>

<p>You can now do batching of requests:</p>

<div class="highlight"><pre><code class="console"><span class="gp">$</span> mco package update myapp --batch 10 --batch-sleep 60
</code></pre>
</div>

<p>This performs the update as usual but only affecting machines in groups of 10 and
sleeps for a minute between.</p>

<p>You can also access this functionality via the API please see the docs for usage.
Any existing script or application should support this functionality without any
code changes.</p>

<p>The results, error reporting, statistics reporting and so forth all stays consistent
with non batched behavior.</p>

<p>The batching requires a direct addressing capable collective.</p>

<h3 id="backwards-compatibility-1">Backwards Compatibility</h3>

<p>As this release does a few more tweaks to the security system it might not work with older
versions of MCollective.</p>

<p>Hopefully this will be the last release in this dev cycle to break backwards compatibility
as we&#8217;re nearing the next major release.</p>

<h4 id="identities-certificates-and-caller-id-names">Identities, Certificates and Caller ID names</h4>

<p>These items have been tightened up to only match <em>\w.-</em>.  Plugins like the registration
ones might assume it is safe to just write files based on names contained in these fields
so rather than expect everyone to write secure code the framework now just enforce
a safe approach to these.</p>

<p>This means if you have cases that would violate this rule you would need to change that
configuration prior to upgrading to 1.3.2</p>

<h4 id="aes-and-ssl-plugins-are-more-secure">AES and SSL plugins are more secure</h4>

<p>If you use the AES or SSL plugins you will need to plan your rollout carefully, these plugins
are not capable of communicating with older versions of MCollective.</p>

<h4 id="changes-since-131">Changes since 1.3.1</h4>

<table>
  <thead>
    <tr>
      <th>Date</th>
      <th>Description</th>
      <th>Ticket</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2011/11/16</td>
      <td>Imrpove error reporting for code errors in application plugins</td>
      <td>10883</td>
    </tr>
    <tr>
      <td>2011/11/15</td>
      <td>The limit method is now configurable on each RPC client as well as the config file</td>
      <td>7772</td>
    </tr>
    <tr>
      <td>2011/11/15</td>
      <td>Add a &#8211;graph option to the ping application that shows response distribution</td>
      <td>10864</td>
    </tr>
    <tr>
      <td>2011/11/14</td>
      <td>An ActiveMQ specific connector was added that supports direct connections</td>
      <td>7899</td>
    </tr>
    <tr>
      <td>2011/11/11</td>
      <td>SimpleRPC clients now support native batching with &#8211;batch</td>
      <td>5939</td>
    </tr>
    <tr>
      <td>2011/11/11</td>
      <td>The client now unsubscribes from topics when it&#8217;s idle minimising the risk of receiving missdirected messages</td>
      <td>10670</td>
    </tr>
    <tr>
      <td>2011/11/09</td>
      <td>Security plugins now ignore miss directed messages early thus using fewer resources</td>
      <td>10671</td>
    </tr>
    <tr>
      <td>2011/10/28</td>
      <td>Support ruby-1.9.2-p290 and ruby-1.9.3-rc1</td>
      <td>10352</td>
    </tr>
    <tr>
      <td>2011/10/27</td>
      <td>callerid, certificate names, and identity names can now only have \w . and - in them</td>
      <td>10327</td>
    </tr>
    <tr>
      <td>2011/10/25</td>
      <td>When discovery information is provided always accept it without requiring reset first</td>
      <td>10265</td>
    </tr>
    <tr>
      <td>2011/10/24</td>
      <td>Add :number, :integer and :float to the DDL and rpc application</td>
      <td>9902</td>
    </tr>
    <tr>
      <td>2011/10/22</td>
      <td>Speed up discovery when limit targets are set</td>
      <td>10133</td>
    </tr>
    <tr>
      <td>2011/10/22</td>
      <td>Do not attempt to validate TTL and Message Times on replies in the SSL plugin</td>
      <td>10226</td>
    </tr>
    <tr>
      <td>2011/10/03</td>
      <td>Allow the RPC client to raise an exception rather than exit on failure</td>
      <td>9360</td>
    </tr>
    <tr>
      <td>2011/10/03</td>
      <td>Allow the TTL of requests to be set in the config file and the SimpleRPC API</td>
      <td>9399</td>
    </tr>
    <tr>
      <td>2011/09/26</td>
      <td>Cryptographically secure the TTL and Message Time of requests when using AES and SSL plugins</td>
      <td>9400</td>
    </tr>
    <tr>
      <td>2011/09/20</td>
      <td>Update default shipped configurations to provide a better out of the box experience</td>
      <td>9452</td>
    </tr>
    <tr>
      <td>2011/09/20</td>
      <td>Remove deprecated mc- scripts</td>
      <td>9402</td>
    </tr>
    <tr>
      <td>2011/09/20</td>
      <td>Keep track of messages that has expired and expose the stat in rpcutil and inventory application</td>
      <td>9456</td>
    </tr>
  </tbody>
</table>

<p><a name="1_3_1">&nbsp;</a></p>

<h2 id="section-14">1.3.1 - 2011/09/16</h2>

<p>This is a release in the development series of MCollective.  It feature major new features
and bug fixes.</p>

<p>This release is for early adopters, production users should consider the 1.2.x series.</p>

<h3 id="enhancements-1">Enhancements</h3>

<ul>
  <li>Messaging has been completely reworked internally to be more generic and easier to integrate
with other middleware</li>
  <li>When using Stomp 1.1.9 detailed connection logs are kept showing connections, reconnections
and communication errors</li>
  <li>A new point to point - but still via the middleware - communications ability has been introduced</li>
  <li>When point to point comms is enabled, favour this mode when small number of nodes are being addressed</li>
  <li>Add -j to any SimpleRPC client. Clients using <em>printrpc</em> will automatically support a new JSON output format</li>
  <li>A new rich discovery language was added using the -S flag</li>
  <li>SimpleRPC validators can now also validate boolean data</li>
  <li>The default location of <em>classes.txt</em> has changed to be in line with Puppet defaults.</li>
  <li>A default TTL of 60 seconds are set on all messages.  This is a start towards replay protection and is needed
for the new point to point comms style</li>
  <li>Discovery is now optional.  If you supply an identity filter discovery will be bypassed.  Additionally discovery
can be supplied in arrays, text or JSON formats.  This requires the new point to point comms model.</li>
</ul>

<h3 id="bug-fixes-11">Bug Fixes</h3>

<ul>
  <li>Missing DDL files on the servers are now logged at debug level to minimise noise in the logs</li>
  <li>The RC scripts set RUBYLIB, remove this and rely on the operating system to be set up correctly</li>
  <li>Invalid fact filters supplied on the CLI now raises an error rather than create empty filters</li>
</ul>

<h3 id="new-discovery-language-1">New Discovery Language</h3>

<p>Previously dicovery was very limited, filters were simply run one after the other and you could not do
anything complex like a mix of OR and AND boolean logic.</p>

<p>A new compact discovery language was introduced perfect for use on the command line, an example below:</p>

<div class="highlight"><pre><code class="console"><span class="gp">$</span> mco find -S <span class="s2">&quot;((fqdn=/example.com/ or fqdn=/another.com/) or customer=acme) and apache and physicalprocessorcount&gt;2&quot;</span>
</code></pre>
</div>

<p>The EBNF for this language can be seen below, it&#8217;s available on the command line and the API</p>

<pre><code>compound = ["("] expression [")"] {["("] expression [")"]}
expression = [!|not]statement ["and"|"or"] [!|not] statement
char = A-Z | a-z | &lt; | &gt; | =&gt; | =&lt; | _ | - |* | / { A-Z | a-z | &lt; | &gt; | =&gt; | =&lt; | _ | - | * | / | }
int = 0|1|2|3|4|5|6|7|8|9{|0|1|2|3|4|5|6|7|8|9|0}
</code></pre>

<h3 id="point-to-point-comms-1">Point to Point comms</h3>

<p>Previously MCollective could only broadcast messages and was tied to a discovery model.  This is in line
with the initial goals of the project, having solved that we want to mix in a more traditional messaging
style.</p>

<p>The messaging layer now supports per node destinations that allows you to address a node, even if its down,
doesn&#8217;t yet exist or if you cannot come up with a filter that would match a group of arbitrarily selected
nodes.</p>

<p>When this mode is in use you tell it using either text, arrays or JSON data which machines to communicate with
it will then talk directly to those nodes via the middleware and if any of them are down you will get the
usual no responses report after DDL configured timeout, this is a smooth transparent to the end user mix
in communication modes.</p>

<p>It is ideal for building deployers, web apps and so forth where you know exactly which nodes should be there
and you&#8217;d like to influence the MCollective network addressing, perhaps from a CMDB you built yourself.</p>

<p>This is the start towards an assured style of delivery, you can consider it the TCP to MCollective&#8217;s UDP.
Both modes of communication will be supported in the future and both will have access to all the same agents
clients etc.</p>

<p>This is feature is still maturing, you enable it using the <em>direct_\addressing</em> configuration option.  At
present the STOMP connector supports it but it is not optimized for networks larger than 20 to 30 hosts.  A
new connector is being developed that uses ActiveMQ features to achieve this efficiently.</p>

<h3 id="pluggable--optional-discovery-1">Pluggable / Optional Discovery</h3>

<p>If you did <em>mco rpc rpcutil ping -I box.example.com -I another.example.com</em> mcollective will now just assume
you know what you want, it won&#8217;t do a discover to confirm those machines exist or not, it will just go and
talk with them.  This is a big end user visible speed improvement.  If however you did a filter like <em>-I /example.com/</em>
it cannot know which machines you want to reach and so a traditional broadcast discovery is done first.</p>

<p>When the direct addressing mode is enabled various behind the scenes optimizations are being done:</p>

<ul>
  <li>If a discovery is done and it finds you only want to address 10 or fewer nodes it will use direct mode for that
request.  This avoids a second needless broadcast.  This is less efficient to the middleware but does not send
needless messages to uninterested nodes that would then just ignore them.</li>
  <li>The <em>rpc</em> application supports piping output from one to the next.  Example of this below.</li>
</ul>

<div class="highlight"><pre><code class="console"><span class="gp">$</span> mco rpc package update <span class="nv">package</span><span class="o">=</span>foo -W <span class="nv">customer</span><span class="o">=</span>acme -j|mco rpc service restart <span class="nv">service</span><span class="o">=</span>bar
</code></pre>
</div>

<p>This will update a package on machines matching <em>customer=foo</em> and then restart the service <em>bar</em> on those machines.</p>

<p>The first request is doing traditional discovery based on the fact while the 2nd request is not doing discovery
at all, it uses the JSON output enabled by -j as discovery data and then restart the service on only those machines.</p>

<p>These abilities are exposed in the SimpleRPC client API and you can write your own schemes, query your own databases etc</p>

<h3 id="backwards-compatibility-2">Backwards Compatibility</h3>

<p>This is a big release and the entire messaging system has been redesigned, rewritten and has had features added.
As such there might be problems running mixed 1.2.x and 1.3.1 networks, we&#8217;d ask users to test this in lab situations
and provide us feedback to improve the eventual transition from 1.2.x to 1.4.x.  We did though aim to maintain backward
compatibility and the intention is to fix any bugs reported where a default configured 1.3.x cannot co-habit with a
previous 1.2.x build.</p>

<p>Enabling the new direct addressing mode is a big configuration change both in your collective and the middleware as such
soon as you enable it there will be compatibility issues until all your nodes are up to the same level.  Specifically old
nodes will just ignore your direct requests.</p>

<p>The default location for <em>classes.txt</em> has changed to <em>/var/lib/puppet/state/classes.txt</em> you need to ensure
this file exists or configure either MCollective or Puppet accordingly else your classes filters will break</p>

<p>Messages are now valid for only 60 seconds, nodes will <em>ignore</em> messages older than 60 seconds.  This means
your clocks have to be in sync on your entire collective.  We use UTC time for the TTL check so your machines
can be in different time zones.  At present the 60 second threshold is hard coded, it will become configurble on a
per message basis in future.</p>

<h4 id="changes-since-130">Changes since 1.3.0</h4>

<table>
  <thead>
    <tr>
      <th>Date</th>
      <th>Description</th>
      <th>Ticket</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2011/09/9</td>
      <td>Use direct messaging where possible for identity filters and make the rpc application direct aware</td>
      <td>8466</td>
    </tr>
    <tr>
      <td>2011/08/29</td>
      <td>Enforce a 60 second TTL on all messages by default</td>
      <td>8325</td>
    </tr>
    <tr>
      <td>2011/08/29</td>
      <td>Change the default classes.txt file to be in line with Puppet defaults</td>
      <td>9133</td>
    </tr>
    <tr>
      <td>2011/08/06</td>
      <td>Add reload-agents and reload-loglevel commands to the redhat RC script</td>
      <td>7730</td>
    </tr>
    <tr>
      <td>2011/08/06</td>
      <td>Avoid reloading the authorization class over and over from disk on each request</td>
      <td>8703</td>
    </tr>
    <tr>
      <td>2011/08/06</td>
      <td>Add a boolean validator to SimpleRPC agents</td>
      <td>8799</td>
    </tr>
    <tr>
      <td>2011/08/06</td>
      <td>Justify text results better when using printrpc</td>
      <td>8807</td>
    </tr>
    <tr>
      <td>2011/07/22</td>
      <td>Add &#8211;version to the mco utility</td>
      <td>7822</td>
    </tr>
    <tr>
      <td>2011/07/22</td>
      <td>Add missing meta data to the discovery agent</td>
      <td>8497</td>
    </tr>
    <tr>
      <td>2011/07/18</td>
      <td>Raise an error if invalid format fact filters are supplied</td>
      <td>8419</td>
    </tr>
    <tr>
      <td>2011/07/14</td>
      <td>Add a rich discovery query language</td>
      <td>8181</td>
    </tr>
    <tr>
      <td>2011/07/08</td>
      <td>Do not set RUBYLIB in the RC scripts, the OS should do the right thing</td>
      <td>8063</td>
    </tr>
    <tr>
      <td>2011/07/07</td>
      <td>Add a -j argument to all SimpleRPC clients that causes printrpc to produce JSON data</td>
      <td>8280</td>
    </tr>
    <tr>
      <td>2011/06/30</td>
      <td>Add the ability to do point to point comms for requests affecting small numbers of hosts</td>
      <td>7988</td>
    </tr>
    <tr>
      <td>2011/06/21</td>
      <td>Add support for Stomp Gem version 1.1.9 callback based logging</td>
      <td>7960</td>
    </tr>
    <tr>
      <td>2011/06/21</td>
      <td>On the server side log missing DDL files at debug and not warning level</td>
      <td>7961</td>
    </tr>
    <tr>
      <td>2011/06/16</td>
      <td>Add the ability for nodes to subscribe to per-node queues, off by default</td>
      <td>7225</td>
    </tr>
    <tr>
      <td>2011/06/12</td>
      <td>Remove assumptions about middleware structure from the core and move it to the connector plugins</td>
      <td>7619</td>
    </tr>
  </tbody>
</table>

<p><a name="1_2_1">&nbsp;</a></p>

<h2 id="section-15">1.2.1 - 2011/06/30</h2>

<p>This is a maintenance release in the production series of MCollective and is a recommended
upgrade for all users of 1.2.0.</p>

<h3 id="bug-fixes-12">Bug Fixes</h3>

<ul>
  <li>Improve error handling in the inventory application</li>
  <li>Fix compatablity problems with RedHat 4 init scripts</li>
  <li>Allow . in Fact names</li>
  <li>Allow applications to use the exit method</li>
  <li>Correct parsing of the MCOLLECTIVE_EXTRA_OPTS environment variable</li>
</ul>

<h3 id="backwards-compatibility-3">Backwards compatibility</h3>

<p>This release should be 100% backward compatable with version 1.2.0</p>

<h4 id="changes-since-120">Changes since 1.2.0</h4>

<table>
  <thead>
    <tr>
      <th>Date</th>
      <th>Description</th>
      <th>Ticket</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2011/06/02</td>
      <td>Correct parsing of MCOLLECTIVE_EXTRA_OPTS in cases where no config related settings were set</td>
      <td>7755</td>
    </tr>
    <tr>
      <td>2011/05/23</td>
      <td>Allow applications to use the exit method as would normally be expected</td>
      <td>7626</td>
    </tr>
    <tr>
      <td>2011/05/16</td>
      <td>Allow <em>.</em> in fact names</td>
      <td>7532</td>
    </tr>
    <tr>
      <td>2011/05/16</td>
      <td>Fix compatibility issues with RH4 init system</td>
      <td>7448</td>
    </tr>
    <tr>
      <td>2011/05/15</td>
      <td>Handle failures from remote nodes better in the inventory app</td>
      <td>7524</td>
    </tr>
    <tr>
      <td>2011/05/06</td>
      <td>Revert unintended changes to the Debian rc script</td>
      <td>7420</td>
    </tr>
    <tr>
      <td>2011/05/06</td>
      <td>Remove the <em>test</em> agent that was accidentally checked in</td>
      <td>7425</td>
    </tr>
  </tbody>
</table>

<p><a name="1_3_0">&nbsp;</a></p>

<h2 id="section-16">1.3.0 - 2011/06/08</h2>

<p>This is a release in the development series of mcollective.  It features major
new features, some bug fixes and internal structure refactoring.</p>

<p>This release is for early adopters, production users should consider the 1.2.x series.</p>

<h3 id="enhancements-2">Enhancements</h3>

<ul>
  <li>Agents can now programatically declare if they should work on a node</li>
  <li>Applications can now use the exit method as normal and clean disconnects will be done</li>
  <li>The target collective for registration messages is configurable.  In the past it defaulted to main_collective</li>
</ul>

<h3 id="bug-fixes-13">Bug Fixes</h3>

<ul>
  <li>Error reporting in applications, agents and mcolletive core has been improved</li>
  <li>The RC script works better on Red Hat 4 based systems</li>
</ul>

<h3 id="other-changes">Other Changes</h3>

<ul>
  <li>The connector layer is being improved to make it easier to use other middleware.
This release starts this process but it&#8217;s far from complete.</li>
  <li>The sshkey plugin was removed from core and moved to the plugins project</li>
</ul>

<h3 id="backwards-compatibility-4">Backwards Compatibility</h3>

<p>If you were using the sshkey plugin you need to ensure your CM system is copying it out prior to this
upgrade as the packages will not contain it anymore.</p>

<p>If you have your own connectors other than the STOMP one we supply you should wait to upgrade till 1.3.1
at which point you will need to make extensive changes to your plugins internals.  If your CM is copying
out the connector you have to ensure that when this version of MCollective start that the new plugin is
in place.</p>

<h3 id="changes">Changes</h3>

<table>
  <thead>
    <tr>
      <th>Date</th>
      <th>Description</th>
      <th>Ticket</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2011/06/07</td>
      <td>Exceptions raised during option parsing were not handled and resulted in stack traces</td>
      <td>7796</td>
    </tr>
    <tr>
      <td>2011/06/06</td>
      <td>Remove the sshkey, it&#8217;s being moved to the plugin repository</td>
      <td>7794</td>
    </tr>
    <tr>
      <td>2011/06/02</td>
      <td>Correct parsing of MCOLLECTIVE_EXTRA_OPTS in cases where no config related settings were set</td>
      <td>7755</td>
    </tr>
    <tr>
      <td>2011/05/31</td>
      <td>Disconnect from the middleware when an application calls exit</td>
      <td>7712</td>
    </tr>
    <tr>
      <td>2011/05/29</td>
      <td>Validations failure in RPC agents will now raise the correct exceptions as documented</td>
      <td>7711</td>
    </tr>
    <tr>
      <td>2011/05/25</td>
      <td>Make the target collective for registration messages configurable</td>
      <td>7650</td>
    </tr>
    <tr>
      <td>2011/05/24</td>
      <td>Rename the connector plugins send method to publish to avoid issues ruby Object#send</td>
      <td>7623</td>
    </tr>
    <tr>
      <td>2011/05/23</td>
      <td>Log a warning when the CF file parsing fails rather than raise a whole ruby exception</td>
      <td>7627</td>
    </tr>
    <tr>
      <td>2011/05/23</td>
      <td>Allow applications to use the exit method as would normally be expected</td>
      <td>7626</td>
    </tr>
    <tr>
      <td>2011/05/22</td>
      <td>Refactor subscribe and unsubscribe so that middleware structure is entirely contained in the connectors</td>
      <td>7620</td>
    </tr>
    <tr>
      <td>2011/05/21</td>
      <td>Add the ability for agents to programatically declare if they should work on a node</td>
      <td>7583</td>
    </tr>
    <tr>
      <td>2011/05/20</td>
      <td>Improve error reporting in the single application framework</td>
      <td>7574</td>
    </tr>
    <tr>
      <td>2011/05/16</td>
      <td>Allow <em>.</em> in fact names</td>
      <td>7532</td>
    </tr>
    <tr>
      <td>2011/05/16</td>
      <td>Fix compatibility issues with RH4 init system</td>
      <td>7448</td>
    </tr>
    <tr>
      <td>2011/05/15</td>
      <td>Handle failures from remote nodes better in the inventory app</td>
      <td>7524</td>
    </tr>
    <tr>
      <td>2011/05/06</td>
      <td>Revert unintended changes to the Debian rc script</td>
      <td>7420</td>
    </tr>
    <tr>
      <td>2011/05/06</td>
      <td>Remove the <em>test</em> agent that was accidentally checked in</td>
      <td>7425</td>
    </tr>
  </tbody>
</table>

<p><a name="1_2_0">&nbsp;</a></p>

<h2 id="section-17">1.2.0 - 2011/05/04</h2>

<p>This is the next production release of MCollective.  It brings to an
end active support for versions 1.1.4 and older.</p>

<p>This release brings to general availability all the features added in the
1.1.x development series.</p>

<h3 id="enhancements-3">Enhancements</h3>

<ul>
  <li>The concept of sub-collectives were introduced that help you partition
your MCollective traffic for network isolation, traffic management and security</li>
  <li>The single executable framework has been introduced replacing the old
<em>mc-*</em> commands</li>
  <li>A new AES+RSA security plugin was added that provides strong encryption,
client authentication and message security</li>
  <li>New fact matching operators &lt;=, &gt;=, &lt;, &gt;, !=, == and =~.</li>
  <li>Actions can be written in external scripts and therefore other languages
than Ruby, wrappers exist for PHP, Perl and Python</li>
  <li>Plugins can now be configured using the <em>plugins.d</em> directory</li>
  <li>A convenient and robust exec wrapper has been written to assist in calling
external scripts</li>
  <li>The <em>MCOLLECTIVE_EXTRA_OPTS</em> environment variable has been added that will
add options to all client scripts</li>
  <li>Network timeout handling has been improved to better take account of latency</li>
  <li>Registration plugins can elect to skip sending of registration data by
returning <em>nil</em>, previously nil data would be published</li>
  <li>Multiple libdirs are supported</li>
  <li>The logging framework is pluggable and easier to use</li>
  <li>Fact plugins can now force fact cache invalidation.  The YAML plugin will
force a cache clear as soon as the source YAML file updates</li>
  <li>The <em>ping</em> application now supports filters</li>
  <li>Network payload can now be Base64 encoded avoiding issues with Unicode characters
in older Stomp gems</li>
  <li>All fact plugins are now cached and only updated every 300 seconds</li>
  <li>The progress bar now resizes based on terminal dimensions</li>
  <li>DDL files with missing output blocks will not invalidate the whole DDL</li>
  <li>Display of DDL assisted complex data has been improved to be more readable</li>
  <li>Stomp messages can have a priority header added for use with recent versions
of ActiveMQ</li>
  <li>Almost 300 unit tests have been written, lots of old code and any new code being
written is subject to continuos testing on Ruby 1.8.5, 1.8.6 and 1.9.2</li>
  <li>Improved the Red Hat RC script to be more compliant with distribution policies
and to reuse the builtin functions</li>
</ul>

<h3 id="deprecations-and-removed-functionality">Deprecations and removed functionality</h3>

<ul>
  <li>The old <em>mc-*</em> commands are being removed in favor for the new <em>mco</em> command.
The old style is still available and your existing scripts will keep working but
porting to the new single executable system is very easy and encouraged.</li>
  <li><em>MCOLLECTIVE_TIMEOUT</em> and <em>MCOLLECTIVE_DTIMEOUT</em> were removed in favor of <em>MCOLLECTIVE_EXTRA_OPTS</em></li>
  <li><em>mc-controller</em> could exit all mcollectived instances, this feature was not ported
to the new <em>mco controller</em> application</li>
</ul>

<h3 id="bug-fixes-14">Bug Fixes</h3>

<ul>
  <li>mcollectived and all of the standard supplied client scripts now disconnects
cleanly from the middleware avoiding exceptions in the ActiveMQ logs</li>
  <li>Communications with the middleware has been made robust by adding a timeout
while sending</li>
  <li>Machines that do not pass security validation are now handled as having not
responded at all</li>
  <li>When a fire and forget request was sent, replies were still sent, they are
now suppressed</li>
</ul>

<h3 id="backwards-compatibility-5">Backwards compatibility</h3>

<p>This release can communicate with machines running older versions of mcollective
there are though a few steps to take to ensure a smooth upgrade.</p>

<h4 id="backward-compatible-sub-collective-setup">Backward compatible sub-collective setup</h4>

<div class="highlight"><pre><code class="ini"><span class="na">topicprefix</span> <span class="o">=</span> <span class="s">/topic/mcollective</span>
</code></pre>
</div>

<p>This has to change to:</p>

<div class="highlight"><pre><code class="ini"><span class="na">topicprefix</span> <span class="o">=</span> <span class="s">/topic/</span>
<span class="na">main_collective</span> <span class="o">=</span> <span class="s">mcollective</span>
<span class="na">collectives</span> <span class="o">=</span> <span class="s">mcollective</span>
</code></pre>
</div>

<h4 id="security-plugins">Security Plugins</h4>

<p>The interface for the <em>encodereply</em> method on the security plugins have changed
if you are using any of the community plugins or wrote your own you should update
them with the latest at the time you upgrade to 1.2.0</p>

<h4 id="fact-plugins">Fact Plugins</h4>

<p>The interface to the fact plugins have been greatly simplified, this means you need to
update to new plugins at the time you upgrade to 1.2.0</p>

<p>You can place these new plugins into the plugindir before upgrading. The old mcollective
will not use these plugins and the new one will not touch the old ones. This will allow
for a clean rollback.</p>

<p>Once the new version is deployed you will immediately have caching on all fact types
at 300 seconds you can tune this using the fact_cache_time setting in the configuration file.</p>

<h4 id="new-fact-selectors">New fact selectors</h4>

<p>The new fact selectors are only available on newer versions of mcollective.  If a client
attempts to use them and an older version of the server is on the network those older
servers will treat all fact lookups as ==</p>

<h4 id="changes-since-114">Changes since 1.1.4</h4>

<table>
  <thead>
    <tr>
      <th>Date</th>
      <th>Description</th>
      <th>Ticket</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2011/05/03</td>
      <td>Improve Red Hat RC script by using distro builtin functions</td>
      <td>7340</td>
    </tr>
    <tr>
      <td>2011/05/01</td>
      <td>Support setting a priority on Stomp messages</td>
      <td>7246</td>
    </tr>
    <tr>
      <td>2011/04/30</td>
      <td>Handle broken and incomplete DDLs better and improve the format of DDL output</td>
      <td>7191</td>
    </tr>
    <tr>
      <td>2011/04/23</td>
      <td>Encode the target agent and collective in requests</td>
      <td>7223</td>
    </tr>
    <tr>
      <td>2011/04/20</td>
      <td>Make the SSL Cipher used a config option</td>
      <td>7191</td>
    </tr>
    <tr>
      <td>2011/04/20</td>
      <td>Add a clear method to the PluginManager that deletes all plugins, improve test isolation</td>
      <td>7176</td>
    </tr>
    <tr>
      <td>2011/04/19</td>
      <td>Abstract the creation of request and reply hashes to simplify connector plugin development</td>
      <td>5701</td>
    </tr>
    <tr>
      <td>2011/04/15</td>
      <td>Improve the shellsafe validator and add a Util method to do shell escaping</td>
      <td>7066</td>
    </tr>
    <tr>
      <td>2011/04/14</td>
      <td>Update Rakefile to have a mail_patches task</td>
      <td>6874</td>
    </tr>
    <tr>
      <td>2011/04/13</td>
      <td>Update vendored systemu library for Ruby 1.9.2 compatibility</td>
      <td>7067</td>
    </tr>
    <tr>
      <td>2011/04/12</td>
      <td>Fix failing tests on Ruby 1.9.2</td>
      <td>7067</td>
    </tr>
    <tr>
      <td>2011/04/11</td>
      <td>Update the DDL documentation to reflect the <em>mco help</em> command</td>
      <td>7042</td>
    </tr>
    <tr>
      <td>2011/04/11</td>
      <td>Document the use filters on the CLI</td>
      <td>5917</td>
    </tr>
    <tr>
      <td>2011/04/11</td>
      <td>Improve handling of unknown facts in Util#has_fact? to avoid exceptions about nil#clone</td>
      <td>6956</td>
    </tr>
    <tr>
      <td>2011/04/11</td>
      <td>Correctly set timeout on the discovery agent to 5 seconds as default</td>
      <td>7045</td>
    </tr>
    <tr>
      <td>2011/04/11</td>
      <td>Let rpcutil#agent_inventory supply <em>unknown</em> for missing values in agent meta data</td>
      <td>7044</td>
    </tr>
  </tbody>
</table>

<p><a name="1_1_4">&nbsp;</a></p>

<h2 id="section-18">1.1.4 - 2011/04/07</h2>

<p>This is a release in the development series of mcollective.  It features major
new features and some bug fixes.</p>

<p>This release is for early adopters, production users should consider the 1.0.x series.</p>

<h3 id="actions-in-other-languages">Actions in other languages</h3>

<p>We have implemented the ability to write actions in languages other than Ruby.
This is done via simple JSON API documented in <a href="simplerpc/agents.html#actions-in-external-scripts">in our docs</a></p>

<p>The <em>ext</em> directory on <a href="https://github.com/puppetlabs/marionette-collective/tree/master/ext/action_helpers">GitHub</a>
hosts wrappers for PHP, Perl and Python that makes using this interface easier.</p>

<div class="highlight"><pre><code class="ruby"><span class="n">action</span> <span class="s2">&quot;test&quot;</span> <span class="k">do</span>
    <span class="n">implemented_by</span> <span class="s2">&quot;/some/external/script&quot;</span>
<span class="k">end</span>
</code></pre>
</div>

<p>Special thanks to the community members who contributed the wrappers.</p>

<h3 id="enhancements-4">Enhancements</h3>

<ul>
  <li>Actions can now be written in any language</li>
  <li>Plugin configuration can be kept in <em>/etc/mcollective/plugin.d</em></li>
  <li><em>mco inventory</em> now shows collective and sub-collective membership</li>
  <li>mc-controller has been deprecated for <em>mco controller</em></li>
  <li>Agents are now ran using new instances of the classes rather than reuse the exiting
one to avoid concurrency related problems</li>
</ul>

<h3 id="bug-fixes-15">Bug Fixes</h3>

<ul>
  <li>When mcollectived exits it now cleanly disconnects from the Middleware</li>
  <li>The <em>rpcutil</em> agent is less strict about valid Fact names</li>
  <li>The default configuration files have been updated for sub-collectives</li>
</ul>

<h3 id="backwards-compatibility-6">Backwards Compatibility</h3>

<p>This release will be backward compatible with version <em>1.1.3</em> for compatibility
with earlier releases see the notes for <em>1.1.3</em> and the sub collective related
configuration changes.</p>

<h3 id="changes-1">Changes</h3>

<table>
  <thead>
    <tr>
      <th>Date</th>
      <th>Description</th>
      <th>Ticket</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2011/03/28</td>
      <td>Correct loading of vendored JSON gem</td>
      <td>6877</td>
    </tr>
    <tr>
      <td>2011/03/28</td>
      <td>Show collective and sub collective info in the inventory application</td>
      <td>6872</td>
    </tr>
    <tr>
      <td>2011/03/23</td>
      <td>Disconnect from the middleware when mcollectived disconnects</td>
      <td>6821</td>
    </tr>
    <tr>
      <td>2011/03/21</td>
      <td>Update rpcutil ddl file to be less strict about valid fact names</td>
      <td>6764</td>
    </tr>
    <tr>
      <td>2011/03/22</td>
      <td>Support reading configuration from configfir/plugin.d for plugins</td>
      <td>6623</td>
    </tr>
    <tr>
      <td>2011/03/21</td>
      <td>Update default configuration files for sub-collectives</td>
      <td>6741</td>
    </tr>
    <tr>
      <td>2011/03/16</td>
      <td>Add the ability to implement actions using external scripts</td>
      <td>6705</td>
    </tr>
    <tr>
      <td>2011/03/15</td>
      <td>Port mc-controller to the Application framework and deprecate the exit command</td>
      <td>6637</td>
    </tr>
    <tr>
      <td>2011/03/13</td>
      <td>Only cache registration and discovery agents, handle the rest as new instances</td>
      <td>6692</td>
    </tr>
    <tr>
      <td>2011/03/08</td>
      <td>PluginManager can now create new instances on demand for a plugin type</td>
      <td>6622</td>
    </tr>
  </tbody>
</table>

<p><a name="1_1_3">&nbsp;</a></p>

<h2 id="section-19">1.1.3 - 2011/03/07</h2>

<p>This is a release in the development series of mcollective.  It features major
new features and some bug fixes.</p>

<p>This release is for early adopters, production users should consider the 1.0.x series.</p>

<h3 id="enhancements-5">Enhancements</h3>

<ul>
  <li>Add the ability to partition collectives into sub-collectives for security and
network traffic management</li>
  <li>Add a exec wrapper for agents that provides unique environments and cwds in a
thread safe manner as well as avoid zombie processes</li>
  <li>Automatically pass Application options to rpcclient when options are not
specifically provided</li>
  <li>Rename <em>/usr/sbin/mc</em> to <em>/usr/bin/mco</em></li>
</ul>

<h3 id="bug-fixes-16">Bug Fixes</h3>

<ul>
  <li>Missing <em>libdirs</em> will not cause crashes anymore</li>
  <li>Parse <code>MCOLLECTIVE_EXTRA_OPTS</code> correctly with multiple options</li>
  <li><code>file_logger</code> failures are handled better</li>
  <li>Improve middleware communication in unreliable settings by adding timeouts
around middleware operations</li>
</ul>

<h3 id="backwards-compatibility-7">Backwards Compatibility</h3>

<p>The configuration format has changed slightly to accomodate the concept of
collective names and sub-collectives.</p>

<p>In older releases the configuration was:</p>

<div class="highlight"><pre><code class="ini"><span class="na">topicprefix</span> <span class="o">=</span> <span class="s">/topic/mcollective</span>
</code></pre>
</div>

<p>This has to change to:</p>

<div class="highlight"><pre><code class="ini"><span class="na">topicprefix</span> <span class="o">=</span> <span class="s">/topic/</span>
<span class="na">main_collective</span> <span class="o">=</span> <span class="s">mcollective</span>
<span class="na">collectives</span> <span class="o">=</span> <span class="s">mcollective</span>
</code></pre>
</div>

<p>When setup as above a old and new version will be compatible but as soon as you
start configuring the new sub-collective feature you will loose compatiblity
between versions.</p>

<p>Various defaults apply, if you configure it with these exactly topic and
collective names you can leave off the <code>main_collective</code> and <code>collectives</code>
directives as the above settings would be their defaults</p>

<h3 id="changes-2">Changes</h3>

<table>
  <thead>
    <tr>
      <th>Date</th>
      <th>Description</th>
      <th>Ticket</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2011/03/04</td>
      <td>Rename /usr/sbin/mc to /usr/bin/mco</td>
      <td>6578</td>
    </tr>
    <tr>
      <td>2011/03/01</td>
      <td>Wrap rpcclient in applications ensuring that options is always set</td>
      <td>6308</td>
    </tr>
    <tr>
      <td>2011/02/28</td>
      <td>Make communicating with the middleware more robust by including send calls in timeouts</td>
      <td>6505</td>
    </tr>
    <tr>
      <td>2011/02/28</td>
      <td>Create a wrapper to safely run shell commands avoiding zombies</td>
      <td>6392</td>
    </tr>
    <tr>
      <td>2011/02/19</td>
      <td>Introduce Sub-collectives for network partitioning</td>
      <td>5967</td>
    </tr>
    <tr>
      <td>2011/02/19</td>
      <td>Improve error handling when parsing arguments in the rpc application</td>
      <td>6388</td>
    </tr>
    <tr>
      <td>2011/02/19</td>
      <td>Fix error logging when file_logger creation fails</td>
      <td>6387</td>
    </tr>
    <tr>
      <td>2011/02/17</td>
      <td>Correctly parse MCOLLECTIVE_EXTRA_OPTS in the new unified binary framework</td>
      <td>6354</td>
    </tr>
    <tr>
      <td>2011/02/15</td>
      <td>Allow the signing key and Debian distribution to be customized</td>
      <td>6321</td>
    </tr>
    <tr>
      <td>2011/02/14</td>
      <td>Remove inadvertently included package.ddl</td>
      <td>6313</td>
    </tr>
    <tr>
      <td>2011/02/14</td>
      <td>Handle missing libdirs without crashing</td>
      <td>6306</td>
    </tr>
  </tbody>
</table>

<p><a name="1_0_1">&nbsp;</a></p>

<h2 id="section-20">1.0.1 - 2011/02/16</h2>

<h3 id="release-focus-and-notes">Release Focus and Notes</h3>

<p>This is a minor bug fix release.</p>

<h3 id="bugs-fixed">Bugs Fixed</h3>

<ul>
  <li>The YAML fact plugin failed to remove deleted facts from memory</li>
  <li>The <em>-</em> character is now allowed in Fact names for the rpcutil agent</li>
  <li>Machines that fali security validations were not reported correctly,
they are now treated as having not responded at all</li>
  <li>Timeouts on RPC requests were too aggressive and did not allow for slow networks</li>
</ul>

<h3 id="backwards-compatibility-8">Backwards Compatibility</h3>

<p>This release will be backward compatible with older releases.</p>

<h3 id="changes-3">Changes</h3>

<table>
  <thead>
    <tr>
      <th>Date</th>
      <th>Description</th>
      <th>Ticket</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2011/02/02</td>
      <td>Include full Apache 2 license text</td>
      <td>6113</td>
    </tr>
    <tr>
      <td>2011/01/29</td>
      <td>The YAML fact plugin kept deleted facts in memory</td>
      <td>6056</td>
    </tr>
    <tr>
      <td>2012/01/04</td>
      <td>Use the LSB based init script on SUSE</td>
      <td>5762</td>
    </tr>
    <tr>
      <td>2010/12/30</td>
      <td>Allow - in fact names</td>
      <td>5727</td>
    </tr>
    <tr>
      <td>2010/12/29</td>
      <td>Treat machines that fail security validation like ones that did not respond</td>
      <td>5700</td>
    </tr>
    <tr>
      <td>2010/12/25</td>
      <td>Allow for network and fact source latency when calculating client timeout</td>
      <td>5676</td>
    </tr>
    <tr>
      <td>2010/12/25</td>
      <td>Increase the rpcutil timeout to allow for slow facts</td>
      <td>5679</td>
    </tr>
  </tbody>
</table>

<h2 id="section-21">1.1.2 - 2011/02/14</h2>

<p>This is a release in the development series of mcollective.  It features minor
bug fixes and features.</p>

<p>This release is for early adopters, production users should consider the 1.0.x series.</p>

<h3 id="bug-fixes-17">Bug Fixes</h3>

<ul>
  <li>The main fix in this release is a packaging bug in Debian systems that prevented
both client and server from being installed on the same machine.</li>
  <li>Backwards compatibility fix for fact filters that are empty strings</li>
</ul>

<h3 id="enhancement">Enhancement</h3>

<ul>
  <li>Registration plugins can now return nil which will skip that specific registration
message.  This will enable plugins to decide based on some node state if a message
should be sent or not.</li>
</ul>

<h3 id="changes-4">Changes</h3>

<table>
  <thead>
    <tr>
      <th>Date</th>
      <th>Description</th>
      <th>Ticket</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2011/02/13</td>
      <td>Surpress replies to SimpleRPC clients who did not request results</td>
      <td>6305</td>
    </tr>
    <tr>
      <td>2011/02/11</td>
      <td>Fix Debian packaging error due to the same file in multiple packages</td>
      <td>6276</td>
    </tr>
    <tr>
      <td>2011/02/11</td>
      <td>The application framework will now disconnect from the middleware for consistency</td>
      <td>6292</td>
    </tr>
    <tr>
      <td>2011/02/11</td>
      <td>Returning <em>nil</em> from a registration plugin will skip registration</td>
      <td>6289</td>
    </tr>
    <tr>
      <td>2011/02/11</td>
      <td>Set loglevel to warn by default if not specified in the config file</td>
      <td>6287</td>
    </tr>
    <tr>
      <td>2011/02/10</td>
      <td>Fix backward compatibility with empty fact strings</td>
      <td>6278</td>
    </tr>
  </tbody>
</table>

<h2 id="section-22">1.1.1 - 2011/02/02</h2>

<p>This is a release in the development series of mcollective.  It features major new
features and numerous bug fixes.  Please pay careful attention to the upgrading
section as there is some changes that are not backward compatible.</p>

<p>This release is for early adopters, production users should consider the 1.0.x series.</p>

<h3 id="aesrsa-security-plugin">AES+RSA Security Plugin</h3>

<p>A new security plugin that encrypts the payloads, uniquely identify senders and secure
replies from inspection by other people on the collective has been written.  The plugin
can re-use Puppet certificates and supports distributing of public keys if you wish.</p>

<p>This plugin and its deployment is very complex and it has a visible performance impact
but we felt it was a often requested feature and so decided to implement it.</p>

<p>Full documentation for this plugin can be found <a href="reference/plugins/security_aes.html">in our docs</a>, please read them very
carefully should you choose to deploy this plugin.</p>

<h3 id="single-executable-framework">Single Executable Framework</h3>

<p>In the past a lot of the CLI tools have behaved inconsistently as the mc scripts were
mostly just written to serve immediate needs, we are starting a process of improving
these scripts and making them more robust.</p>

<p>The first step is to create a new framework for CLI commands, we call these Single Executable
Applications.  A new executable called <em>mc</em> is being distributed with this release:</p>

<div class="highlight"><pre><code class="console"><span class="gp">$</span> mc
<span class="go">The Marionette Collective version 1.1.1</span>

<span class="go">/usr/sbin/mc: command (options)</span>

<span class="go">Known commands: rpc filemgr inventory facts ping find help</span>
</code></pre>
</div>

<div class="highlight"><pre><code class="console"><span class="gp">$</span> mc <span class="nb">help</span>
<span class="go">The Marionette Collection version 1.1.1</span>

<span class="go">  facts           Reports on usage for a specific fact</span>
<span class="go">  filemgr         Generic File Manager Client</span>
<span class="go">  find            Find hosts matching criteria</span>
<span class="go">  help            Application list and RPC agent help</span>
<span class="go">  inventory       Shows an inventory for a given node</span>
<span class="go">  ping            Ping all nodes</span>
<span class="go">  rpc             Generic RPC agent client application</span>
</code></pre>
</div>

<div class="highlight"><pre><code class="console"><span class="gp">$</span> mc rpc package status <span class="nv">package</span><span class="o">=</span>zsh
<span class="go">Determining the amount of hosts matching filter for 2 seconds .... 51</span>

<span class="go"> * [ ============================================================&gt; ] 51 / 51</span>


<span class="go"> test.com:</span>
<span class="go">    Properties:</span>
<span class="go">       {:provider=&gt;:yum,</span>
<span class="go">	:release=&gt;&quot;3.el5&quot;,</span>
<span class="go">	:arch=&gt;&quot;x86_64&quot;,</span>
<span class="go">	:version=&gt;&quot;4.2.6&quot;,</span>
<span class="go">	:epoch=&gt;&quot;0&quot;,</span>
<span class="go">	:name=&gt;&quot;zsh&quot;,</span>
<span class="go">	:ensure=&gt;&quot;4.2.6-3.el5&quot;}</span>
</code></pre>
</div>

<p>You can see these commands behave just like their older counter parts but is more integrated
and discovering available commands is much easier.</p>

<p>Agent help that was in the past available through <em>mc-rpc &#8211;ah agentname</em> is now available through
<em>mc help agentname</em> and error reporting is short single line reports by default but by adding
<em>-v</em> to the command line you can get full Ruby backtraces.</p>

<p>We&#8217;ve maintained backward compatibility by creating wrappers for all the old mc scripts but these
might be deprecated in future.</p>

<p>These application live in the normal plugin directories and should make it much easier to distribute
plugins in future.</p>

<p>We will port the scripts for plugins to this framework and encourage you to do the same when writing
new CLI tools.  An example of a ported CLI can be seen in the <em>filemgr</em> agent.</p>

<p>Find the documentation for these plugins <a href="reference/plugins/application.html">here</a>.</p>

<h3 id="miscellaneous-improvements">Miscellaneous Improvements</h3>

<p>The logging system has been ra-efactored to not use a Signleton, logging messages are now simply:</p>

<div class="highlight"><pre><code class="ruby"><span class="no">MCollective</span><span class="o">::</span><span class="no">Log</span><span class="o">.</span><span class="n">notice</span><span class="p">(</span><span class="s2">&quot;hello world&quot;</span><span class="p">)</span>
</code></pre>
</div>

<p>A backwards compatible wrapper exist to prevent existing code from breaking.</p>

<p>In some cases - like when using MCollective from within Rails - the STOMP
gem would fail to decode the payloads.  We&#8217;ve worked with the authors and
a new release was made that makes this more robust but we&#8217;ve also enabled
Base64 encoding on the Stomp connector for those who can&#8217;t upgrade the Gem
and who are running into this problem.</p>

<h3 id="bug-fixes-18">Bug Fixes</h3>

<ul>
  <li>Machines that do not pass security checks are handled as having not responded
so that these are listed in the usual stat for non responsive hosts</li>
  <li>The - character is now allowed in Fact names by the DDL for rpcutil</li>
  <li>Version 1.1.0 introduced a bug with reloading agents from disks using USR1 and mc-controller</li>
</ul>

<h3 id="enhancements-6">Enhancements</h3>

<ul>
  <li>New AES+RSA based security plugin was added</li>
  <li>Create a new single executable framework and port several mc scripts</li>
  <li>Security plugins have access to the callerid they are responding to</li>
  <li>The logging methods have been improved by removing the use of Singletons</li>
  <li>The STOMP connector can now Base64 encode all sent data to deal with en/decoding issues by the gem</li>
  <li>The rpcutil agent has a new <em>ping</em> action</li>
  <li>the <em>mc ping</em> client now supports standard filters</li>
  <li>DDL documentation has been updated to show you can disable type validations in the DDL</li>
  <li>Fact plugins can now force fact cache invalidation, the YAML plugin will immediately load new facts when mtime on the file change</li>
  <li>Improve <em>1.0.0</em> compatibility for <em>foo=/bar/</em> style fact matches at the expense of <em>1.1.0</em> compatibility</li>
</ul>

<h3 id="upgrading">Upgrading</h3>

<p>Upgrading should be mostly painless as most things are backward compatible.</p>

<p>We discovered that we broke backward compatibility with <em>1.0.0</em> and <em>0.4.x</em> Fact filters.  A filter in the form
<em>foo=/bar/</em> would be treated as an equality filter and not a regular expression.</p>

<p>This releases fixes this compatibility with older versions at the expense of compatibility with <em>1.1.0</em>.  If you
are upgrading from <em>1.1.0</em> keep this in mind and plan accordingly, once you&#8217;ve upgraded a client its requests that
contain these filters will not be correctly parsed on servers running <em>1.1.0</em>.</p>

<p>The security plugins have changed slightly, if you wrote your own security plugin the interface to <em>encodereply</em>
has changed slightly.  All the bundled security plugins have been updated already and older ones will just
keep working.</p>

<h3 id="changes-5">Changes</h3>

<table>
  <thead>
    <tr>
      <th>Date</th>
      <th>Description</th>
      <th>Ticket</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2011/02/02</td>
      <td>Load the DDL from disk once per printrpc call and not for every result</td>
      <td>5958</td>
    </tr>
    <tr>
      <td>2011/02/02</td>
      <td>Include full Apache 2 license text</td>
      <td>6113</td>
    </tr>
    <tr>
      <td>2011/01/31</td>
      <td>Create a new single executable application framework</td>
      <td>5897</td>
    </tr>
    <tr>
      <td>2011/01/30</td>
      <td>Fix backward compatibility with old foo=/bar/ style fact searches</td>
      <td>5985</td>
    </tr>
    <tr>
      <td>2011/01/30</td>
      <td>Documentation update to reflect correct default identity behavior</td>
      <td>6073</td>
    </tr>
    <tr>
      <td>2011/01/29</td>
      <td>Let the YAML file force fact reloads when the files update</td>
      <td>6057</td>
    </tr>
    <tr>
      <td>2011/01/29</td>
      <td>Add the ability for fact plugins to force fact invalidation</td>
      <td>6057</td>
    </tr>
    <tr>
      <td>2011/01/29</td>
      <td>Document an approach to disable type validation in the DDL</td>
      <td>6066</td>
    </tr>
    <tr>
      <td>2011/01/19</td>
      <td>Add basic filters to the mc-ping command</td>
      <td>5933</td>
    </tr>
    <tr>
      <td>2011/01/19</td>
      <td>Add a ping action to the rpcutil agent</td>
      <td>5937</td>
    </tr>
    <tr>
      <td>2011/01/17</td>
      <td>Allow MC::RPC#printrpc to print single results</td>
      <td>5918</td>
    </tr>
    <tr>
      <td>2011/01/16</td>
      <td>Provide SimpleRPC style results when accessing the MC::Client results directly</td>
      <td>5912</td>
    </tr>
    <tr>
      <td>2011/01/11</td>
      <td>Add an option to Base64 encode the STOMP payload</td>
      <td>5815</td>
    </tr>
    <tr>
      <td>2011/01/11</td>
      <td>Fix a bug with forcing all facts to be strings</td>
      <td>5832</td>
    </tr>
    <tr>
      <td>2011/01/08</td>
      <td>When using reload_agents or USR1 signal no agents would be reloaded</td>
      <td>5808</td>
    </tr>
    <tr>
      <td>2011/01/04</td>
      <td>Use the LSB based init script on SUSE</td>
      <td>5762</td>
    </tr>
    <tr>
      <td>2011/01/04</td>
      <td>Remove the use of a Singleton in the logging class</td>
      <td>5749</td>
    </tr>
    <tr>
      <td>2011/01/02</td>
      <td>Add AES+RSA security plugin</td>
      <td>5696</td>
    </tr>
    <tr>
      <td>2010/12/31</td>
      <td>Security plugins now have access to the callerid of the message they are replying to</td>
      <td>5745</td>
    </tr>
    <tr>
      <td>2010/12/30</td>
      <td>Allow - in fact names</td>
      <td>5727</td>
    </tr>
    <tr>
      <td>2010/12/29</td>
      <td>Treat machines that fail security validation like ones that did not respond</td>
      <td>5700</td>
    </tr>
  </tbody>
</table>

<h2 id="section-23">1.1.0 - 2010/12/29</h2>

<p>This is the first in a new development series, as such there will be rapid changes
and new features.  We cannot guarantee the changes will be backward compatible but
we will as before try to keep these releases solid and production quality.</p>

<p>Production users who do not wish to have rapid change should use release 1.0.0.</p>

<p>This release focus mainly on getting all the community contributed code into a release
and addressing some issues I had but wasn&#8217;t comfortable fixing them late in the
previous development series.</p>

<p>Please read these notes carefully we are <strong>removing</strong> some old functionality and changing
some internals, you need to carefully review the text below.</p>

<h3 id="bug-fixes-19">Bug Fixes</h3>

<ul>
  <li>The progress bar will now try hard to detect screen size and adjust itself,
failing back to a dumb mode if it can&#8217;t work it out.</li>
  <li>rpcutil timeout was too short when considering slow facts and network latency</li>
</ul>

<h3 id="improvements">Improvements</h3>

<ul>
  <li>libdir can now be multiple directories specified with : separation - Thanks to Richard Clamp</li>
  <li>Logging is now pluggable, 3 logger types are supported - file, syslog and console.  Thanks to
Nicolas Szalay for the initial Syslog code</li>
  <li>A new experimental ssh agent based security system.  Thanks to Jordan Sissel</li>
  <li>New fact matching operators &lt;=, &gt;=, &lt;, &gt;, !=, == and =~. Thanks to Mike Pountney</li>
  <li>SimpleRPC fact_filter method can now take any valid fact string as input in addition to the old format</li>
  <li>A message gets logged at startup showing mcollective version and logging level</li>
  <li>The fact plugin format has been changed, simplified, made thread safe and global caching added.
This breaks backward compatibility with old fact sources</li>
  <li>Creating options hashes has been simplified by adding a helper that creates them for you</li>
  <li>Calculating the client timeout has been improved by including for latency and fact source slowness</li>
  <li>Audit log lines are now on one line and include a ISO 8601 format date</li>
</ul>

<h3 id="removed-functionality-1">Removed Functionality</h3>

<ul>
  <li>The old MCOLLECTIVE_TIMEOUT and MCOLLECTIVE_DTIMEOUT were removed, a new MCOLLECTIVE_EXTRA_OPTS
was added which should allow much more flexibility.  Supply any command line options in this var</li>
</ul>

<h3 id="upgrading-1">Upgrading</h3>

<p>Upgrading should be easy the only backward incompatible change is the Facts format.  If you only use
the included YAML plugin the upgrade will just work if you use the packages.  If you use either the
facter or ohai plugins you will need to download new plugins from the community plugin page.</p>

<p>If you wrote your own Facts plugin you will need to change it a bit:</p>

<ul>
  <li>The old get_facts method should now be load_facts_from_source</li>
  <li>The class for facts have to be in the form MCollective::Facts::Foo_facts and the filename should match</li>
</ul>

<p>This is all, your facts can now be much simpler as threading and caching is handled in the base class.</p>

<p>You can place these new plugins into the plugindir before upgrading.  The old mcollective will not use
these plugins and the new one will not touch the old ones.  This will allow for a clean rollback.</p>

<p>Once the new version is deployed you will immediately have caching on all fact types at 3000 seconds
you can tune this using the fact_cache_time setting in the configuration file.</p>

<h3 id="changes-6">Changes</h3>

<table>
  <thead>
    <tr>
      <th>Date</th>
      <th>Description</th>
      <th>Ticket</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2010/12/28</td>
      <td>Adjust the logfile audit format to include local time and all on one line</td>
      <td>5694</td>
    </tr>
    <tr>
      <td>2010/12/26</td>
      <td>Improve the SimpleRPC fact_filter helper to support new fact operators</td>
      <td>5678</td>
    </tr>
    <tr>
      <td>2010/12/25</td>
      <td>Increase the rpcutil timeout to allow for slow facts</td>
      <td>5679</td>
    </tr>
    <tr>
      <td>2010/12/25</td>
      <td>Allow for network and fact source latency when calculating client timeout</td>
      <td>5676</td>
    </tr>
    <tr>
      <td>2010/12/25</td>
      <td>Remove MCOLLECTIVE_TIMEOUT and MCOLLECTIVE_DTIMEOUT environment vars in favor of MCOLLECTIVE_EXTRA_OPTS</td>
      <td>5675</td>
    </tr>
    <tr>
      <td>2010/12/25</td>
      <td>Refactor the creation of the options hash so other tools don&#8217;t need to know the internal formats</td>
      <td>5672</td>
    </tr>
    <tr>
      <td>2010/12/21</td>
      <td>The fact plugin format has been changed and simplified, the base now provides caching and thread safety</td>
      <td>5083</td>
    </tr>
    <tr>
      <td>2010/12/20</td>
      <td>Add parameters &lt;=, &gt;=, &lt;, &gt;, !=, == and =~ to fact selection</td>
      <td>5084</td>
    </tr>
    <tr>
      <td>2010/12/14</td>
      <td>Add experimental sshkey security plugin</td>
      <td>5085</td>
    </tr>
    <tr>
      <td>2010/12/13</td>
      <td>Log a startup message showing version and log level</td>
      <td>5538</td>
    </tr>
    <tr>
      <td>2010/12/13</td>
      <td>Add a console logger</td>
      <td>5537</td>
    </tr>
    <tr>
      <td>2010/12/13</td>
      <td>Logging is now pluggable and a syslog plugin was provided</td>
      <td>5082</td>
    </tr>
    <tr>
      <td>2010/12/13</td>
      <td>Allow libdir to be an array of directories for agents and ddl files</td>
      <td>5253</td>
    </tr>
    <tr>
      <td>2010/12/13</td>
      <td>The progress bar will now intelligently figure out the terminal dimensions</td>
      <td>5524</td>
    </tr>
  </tbody>
</table>

<h2 id="section-24">1.0.0 - 2010/12/13</h2>

<h3 id="release-focus-and-notes-1">Release Focus and Notes</h3>

<p>This is a bug fix and minor improvement release.</p>

<p>We will maintain the 1.0.x branch as a stable supported branch.  The features
currently in the branch will be frozen and we&#8217;ll only do bug fixes.</p>

<p>A new 1.1.x series of releases will be done where we will introduce new features.
Once the 1.1.x code base reaches a mature point it will become the new stable
release and so forth.</p>

<h3 id="bug-fixes-20">Bug Fixes</h3>

<ul>
  <li>Settings like retry times were ignored in the Stomp connector</li>
  <li>The default init script had incorrect LSB comments</li>
  <li>The rpcutil DDL has better validation and will now match all facts</li>
</ul>

<h3 id="new-features-and-enhancements">New Features and Enhancements</h3>

<ul>
  <li>You can now send RPC requests to a subset of discovered nodes</li>
  <li>SimpleRPC custom_request can now be used to create fire and forget requests</li>
  <li>Clients can now cleanly disconnect from the middleware.  Bundled clients have been
updated.  This should cause fewer exceptions in ActiveMQ logs</li>
  <li>Rather than big exceptions many clients will now log errors only</li>
  <li>mc-facts has been reworked to be a SimpleRPC client, this speeds it up significantly</li>
  <li>Add get_config_item to rpcutil to retrieve a running config value from a server</li>
  <li>YAML facts are now forced to be all strings and is thread safe</li>
  <li>On RedHat based systems the requirement for the LSB packages has been removed</li>
</ul>

<p>The first feature is a major new feature in SimpleRPC.  If you expose a service redundantly
on your network using MCollective you wouldn&#8217;t always want to send requests to all the
nodes providing the service.  You can now limit the requests to an arbitrary amount
using the new &#8211;limit-nodes option which will also take a percentage.  A shortcut -1 has
been added that is the equivalent to &#8211;limit-nodes 1</p>

<h3 id="backwards-compatibility-9">Backwards Compatibility</h3>

<p>This release will be backward compatible with older releases.</p>

<h3 id="changes-7">Changes</h3>

<table>
  <thead>
    <tr>
      <th>Date</th>
      <th>Description</th>
      <th>Ticket</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2010/12/04</td>
      <td>Remove the LSB requirements for RedHat systems</td>
      <td>5451</td>
    </tr>
    <tr>
      <td>2010/11/23</td>
      <td>Make the YAML fact source thread safe and force all facts to strings</td>
      <td>5377</td>
    </tr>
    <tr>
      <td>2010/11/23</td>
      <td>Add get_config_item to rpcutil to retrieve a running config value from a server</td>
      <td>5376</td>
    </tr>
    <tr>
      <td>2010/11/20</td>
      <td>Convert mc-facts into a SimpleRPC client</td>
      <td>5371</td>
    </tr>
    <tr>
      <td>2010/11/18</td>
      <td>Added GPG signing to Rake packaging tasks (SIGNED=1)</td>
      <td>5355</td>
    </tr>
    <tr>
      <td>2010/11/17</td>
      <td>Improve error messages from clients in the case of failure</td>
      <td>5329</td>
    </tr>
    <tr>
      <td>2010/11/17</td>
      <td>Add helpers to disconnect from the middleware and update all bundled clients</td>
      <td>5328</td>
    </tr>
    <tr>
      <td>2010/11/16</td>
      <td>Correct LSB provides and requires in default init script</td>
      <td>5222</td>
    </tr>
    <tr>
      <td>2010/11/16</td>
      <td>Input validation on rpcutil has been improved to match all valid facts</td>
      <td>5320</td>
    </tr>
    <tr>
      <td>2010/11/16</td>
      <td>Add the ability to limit the results to a subset of hosts</td>
      <td>5306</td>
    </tr>
    <tr>
      <td>2010/11/15</td>
      <td>Add fire and forget mode to SimpleRPC custom_request</td>
      <td>5305</td>
    </tr>
    <tr>
      <td>2010/11/09</td>
      <td>General connection settings to the Stomp connector was ignored</td>
      <td>5245</td>
    </tr>
  </tbody>
</table>

<h2 id="section-25">0.4.10 - 2010/10/18</h2>

<h3 id="release-focus-and-notes-2">Release Focus and Notes</h3>

<p>This is a bug fix and minor improvement release.</p>

<h3 id="bug-fixes-21">Bug Fixes</h3>

<ul>
  <li>Multiple RPC proxy classes in the same script would not all share the same command line options</li>
  <li>Ruby 1.9.x compatibility has been improved</li>
  <li>A major bug in registration has been fixed, any exception in the registration logic would have
resulted in a high CPU consuming loop</li>
</ul>

<p>The last bug is a major issue it will result in the <em>mcollectived</em> consuming lots of CPU, updating to
this version of MCollective is strongly suggested.  Should you run into this problem on a large scale
you can use <em>mc-controller exit</em> to exit all your <em>mcollectived</em> processes at the same time.</p>

<h3 id="new-features-and-enhancements-1">New Features and Enhancements</h3>

<ul>
  <li>The PSK security plugin can now be configured to set the callerid to a few different values
useful for cases where you want to do group based RPC Authorization for example.</li>
  <li>Info logging has been minimised by demoting the &#8216;not targeted at us&#8217; message to debug</li>
  <li>Document the &#8216;exit&#8217; option to mc-controller</li>
</ul>

<h3 id="backwards-compatibility-10">Backwards Compatibility</h3>

<p>This release will be backward compatible with older releases.</p>

<h3 id="changes-8">Changes</h3>

<table>
  <thead>
    <tr>
      <th>Date</th>
      <th>Description</th>
      <th>Ticket</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2010/10/18</td>
      <td>Document exit command to mc-controller</td>
      <td>152</td>
    </tr>
    <tr>
      <td>2010/10/13</td>
      <td>Log messages that don&#8217;t pass the filters at debug level</td>
      <td>149</td>
    </tr>
    <tr>
      <td>2010/10/03</td>
      <td>Preserve options in cases where RPC::Client instances exist in the same program</td>
      <td>148</td>
    </tr>
    <tr>
      <td>2010/09/30</td>
      <td>Add the ability to set different types of callerid in the PSK plugin</td>
      <td>145</td>
    </tr>
    <tr>
      <td>2010/09/30</td>
      <td>Improve Ruby 1.9.x compatibility</td>
      <td>142</td>
    </tr>
    <tr>
      <td>2010/09/29</td>
      <td>Improve error handling in registration to avoid high CPU usage loops</td>
      <td>143</td>
    </tr>
  </tbody>
</table>

<h2 id="section-26">0.4.9 - 2010/09/21</h2>

<h3 id="release-focus-and-notes-3">Release Focus and Notes</h3>

<p>This is a bug fix and minor improvement release.</p>

<h3 id="bug-fixes-22">Bug Fixes</h3>

<ul>
  <li>Internal data structure related to Agent meta data has been fixed, no user impact from this</li>
  <li>When using per-user config files the <em>rpc-help.erb</em> template could not be found</li>
  <li>The log files will now rotate by default keeping 5 x 2MB files</li>
  <li>The config were parsed multiple times in complex scripts, this has been eliminated</li>
  <li>MCollective::RPC loaded a bunch of unneeded stuff into Object, this has been cleaned up</li>
  <li>Various packaging related tweaks were done</li>
</ul>

<h3 id="new-features">New Features</h3>

<ul>
  <li>We ship a new agent called <em>rpcutil</em> with the base system, you can use this agent to get inventory etc from your <em>mcollectived</em>.  <em>mc-inventory</em> has been rewritten to use this agent and should serve as a good reference for what you can get from the agent.</li>
  <li>The DDL now support :boolean style inputs, mc-rpc also turn true/false on the command line into booleans when needed</li>
</ul>

<h3 id="backwards-compatibility-11">Backwards Compatibility</h3>

<p>This release will be backward compatible with older releases.</p>

<h3 id="changes-9">Changes</h3>

<table>
  <thead>
    <tr>
      <th>Date</th>
      <th>Description</th>
      <th>Ticket</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2010/09/20</td>
      <td>Improve Debian packaging task</td>
      <td>140</td>
    </tr>
    <tr>
      <td>2010/09/20</td>
      <td>Add :boolean type support to the DDL</td>
      <td>138</td>
    </tr>
    <tr>
      <td>2010/09/19</td>
      <td>Refactor MCollective::RPC to add less unneeded stuff to Object</td>
      <td>137</td>
    </tr>
    <tr>
      <td>2010/09/18</td>
      <td>Prevent duplicate config loading with multiple clients active</td>
      <td>136</td>
    </tr>
    <tr>
      <td>2010/09/18</td>
      <td>Rotate the log file by default, keeping 5 x 2MB files</td>
      <td>135</td>
    </tr>
    <tr>
      <td>2010/09/18</td>
      <td>Write a overview document detailing security of the collective</td>
      <td>131</td>
    </tr>
    <tr>
      <td>2010/09/18</td>
      <td>Add MCollective.version, set it during packaging and include it in the rpcutil agent</td>
      <td>134</td>
    </tr>
    <tr>
      <td>2010/09/13</td>
      <td>mc-inventory now use SimpleRPC and the rpcutil agent and display server stats</td>
      <td>133</td>
    </tr>
    <tr>
      <td>2010/09/13</td>
      <td>Make the path to the rpc-help.erb configurable and set sane default</td>
      <td>130</td>
    </tr>
    <tr>
      <td>2010/09/13</td>
      <td>Make the configfile used available in the Config class and add to rpcutil</td>
      <td>132</td>
    </tr>
    <tr>
      <td>2010/09/12</td>
      <td>Rework internal statistics and add a rpcutil agent</td>
      <td>129</td>
    </tr>
    <tr>
      <td>2010/09/12</td>
      <td>Fix internal memory structures related to agent meta data</td>
      <td>128</td>
    </tr>
    <tr>
      <td>2010/08/24</td>
      <td>Update the OpenBSD port for changes in 0.4.8 tarball</td>
      <td>125</td>
    </tr>
    <tr>
      <td>2010/08/23</td>
      <td>Fix indention/block error in M:R:Stats</td>
      <td>124</td>
    </tr>
    <tr>
      <td>2010/08/23</td>
      <td>Fix permissions in the RPM for files in /etc</td>
      <td>123</td>
    </tr>
    <tr>
      <td>2010/08/23</td>
      <td>Fix language in two error messages</td>
      <td>122</td>
    </tr>
  </tbody>
</table>

<h2 id="section-27">0.4.8 - 2010/08/20</h2>

<h3 id="release-focus-and-notes-4">Release Focus and Notes</h3>

<p>This is a bug fix and minor improvement release.</p>

<h3 id="bug-fixes-23">Bug Fixes</h3>

<ul>
  <li>The RPM packages now require redhat-lsb since our RC scripts need it</li>
  <li>The rake tasks do not attempt to build rpms on all platforms</li>
  <li>Some plugin missing related exceptions are now handled gracefully</li>
  <li>The Rakefile had a few warnings cleaned up</li>
</ul>

<h3 id="notable-new-features">Notable New Features</h3>

<ul>
  <li>
    <p>Users can now have a <em>~/.mcollective</em> file which will be preferred over over <em>/etc/mcollective/client.cfg</em> if it exists.  You can still use <em>&#8211;config</em> to override.</p>
  </li>
  <li>
    <p>The SSL Security plugin can now use &#8220;either YAML or Marshal for serialization&#8221;:/reference/plugins/security_ssl.html#serialization_method, this means other programming languages can be used as clients.  A sample Perl client is included in the ext directory.  Marshal remains the default for backwards compatibility</p>
  </li>
  <li>
    <p><em>mc-inventory</em> can now be used to create &#8220;custom reports using a small reporting DSL&#8221;:/reference/ui/nodereports.html, this enable you to build custom reports listing all your machines and gives you access to facts, agents and classes lists.</p>
  </li>
  <li>
    <p>The log level for the <em>mcollectived</em> can be adjusted during run time using the <em>USR2</em> unix process signal.</p>
  </li>
</ul>

<h3 id="backwards-compatibility-12">Backwards Compatibility</h3>

<p>This release will be backward compatible with older releases.  If you choose to use YAML in the SSL plugin you need matching versions on the client.</p>

<h3 id="changes-10">Changes</h3>

<table>
  <thead>
    <tr>
      <th>Date</th>
      <th>Description</th>
      <th>Ticket</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2010/08/19</td>
      <td>Fix missing help template in debian packages</td>
      <td>90</td>
    </tr>
    <tr>
      <td>2010/08/18</td>
      <td>Clean up some hardlink warnings in the Rakefile</td>
      <td>117</td>
    </tr>
    <tr>
      <td>2010/08/18</td>
      <td>Include the website in the main repo and add a simple Rake task</td>
      <td>118</td>
    </tr>
    <tr>
      <td>2010/08/17</td>
      <td>Handle exceptions for missing plugins better</td>
      <td>115</td>
    </tr>
    <tr>
      <td>2010/08/17</td>
      <td>Add support for ~/.mcollective as a config file</td>
      <td>114</td>
    </tr>
    <tr>
      <td>2010/08/07</td>
      <td>SSL security plugin can use either YAML or Marshal</td>
      <td>94</td>
    </tr>
    <tr>
      <td>2010/08/06</td>
      <td>Multiple YAML files can now be used as fact source</td>
      <td>112</td>
    </tr>
    <tr>
      <td>2010/08/06</td>
      <td>Allow log level to be adjusted at run time with USR2</td>
      <td>113</td>
    </tr>
    <tr>
      <td>2010/07/31</td>
      <td>Add basic report scripting support to mc-inventory</td>
      <td>111</td>
    </tr>
    <tr>
      <td>2010/07/06</td>
      <td>Removed &#8216;rpm&#8217; from the default rake task</td>
      <td>109</td>
    </tr>
    <tr>
      <td>2010/07/06</td>
      <td>Add redhat-lsb to the server RPM dependencies</td>
      <td>108</td>
    </tr>
  </tbody>
</table>

<h2 id="section-28">0.4.7 - 2010/06/29</h2>

<h3 id="release-focus-and-notes-5">Release Focus and Notes</h3>

<p>This is a bug fix and incremental improvement release focusing on small improvements in the DDL mostly.</p>

<h3 id="data-definition-language">Data Definition Language</h3>

<p>We&#8217;ve extended the use of the DDL in the RPC client.  We&#8217;ve integrated the DDL into <em>printrpc</em> helper.  The output is dynamic showing field names in human readable format rather than hash dumps.</p>

<p>We&#8217;re also using color to improve the display of the results, the color display can be disabled with the new <em>color</em> configuration option.</p>

<p>A &#8220;screencast of the DDL integration&#8221;:http://mcollective.blip.tv/file/3799653 and color usage has been recorded.</p>

<h3 id="bug-fixes-24">Bug Fixes</h3>

<p>A serious issue has been fixed with regard to complex agents.  If you attempted to use multiple agents from the same script errors such as duplicate discovery results or simply not working.</p>

<p>The default fact source has been changed to YAML, it was inadvertently set to Facter in the past.</p>

<p>Some previously unhandled exceptions are now being handled correctly and passed onto the clients as failed requests rather than no responses at all.</p>

<h3 id="backwards-compatibility-13">Backwards Compatibility</h3>

<p>This release will be backward compatible with older releases.  The change to YAML fact source by default might impact you if you did not previously specify a fact source in the configuration files.</p>

<h3 id="changes-11">Changes</h3>

<table>
  <thead>
    <tr>
      <th>Date</th>
      <th>Description</th>
      <th>Ticket</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2010/06/27</td>
      <td>Change default factsource to YAML</td>
      <td>106</td>
    </tr>
    <tr>
      <td>2010/06/27</td>
      <td>Added VIM snippets to create DDLs and Agents</td>
      <td>102</td>
    </tr>
    <tr>
      <td>2010/06/26</td>
      <td>DDL based help now works better with Symbols in in/output</td>
      <td>105</td>
    </tr>
    <tr>
      <td>2010/06/23</td>
      <td>Whitespace at the end of config lines are now stripped</td>
      <td>100</td>
    </tr>
    <tr>
      <td>2010/06/22</td>
      <td>printrpc will now inject some colors into results</td>
      <td>99</td>
    </tr>
    <tr>
      <td>2010/06/22</td>
      <td>Recover from syntax and other errors in agents</td>
      <td>98</td>
    </tr>
    <tr>
      <td>2010/06/17</td>
      <td>The agent a MC::RPC::Client is working on is now available</td>
      <td>97</td>
    </tr>
    <tr>
      <td>2010/06/17</td>
      <td>Integrate the DDL with data display helpers like printrpc</td>
      <td>92</td>
    </tr>
    <tr>
      <td>2010/06/15</td>
      <td>Avoid duplicate topic subscribes in complex clients</td>
      <td>95</td>
    </tr>
    <tr>
      <td>2010/06/15</td>
      <td>Catch some unhandled exceptions in RPC Agents</td>
      <td>96</td>
    </tr>
    <tr>
      <td>2010/06/15</td>
      <td>Fix missing help template file from RPM</td>
      <td>90</td>
    </tr>
  </tbody>
</table>

<h2 id="section-29">0.4.6 - 2010/06/14</h2>

<h3 id="release-focus-and-notes-6">Release Focus and Notes</h3>

<p>This release is a major feature release.</p>

<p>We&#8217;re focusing mainly on the Stomp connector and on the SimpleRPC agents in this release though a few smaller additions were made.</p>

<h3 id="stomp-connector">Stomp Connector</h3>

<p>We&#8217;ve historically been stuck just using RubyGem Stomp 1.1 due to multi threading bugs in the newer releases.  All attempts to contact the authors failed.  Recently though I had some luck and these issues are resolved in the RubyGem Stomp 1.1.6 release.</p>

<p>This means we can take advantage of a lot of new features such as connection pooling for failover/ha and also SSL TLS between nodes and ActiveMQ server.</p>

<p>See &#8220;Stomp Connector&#8221;:/reference/plugins/connector_stomp.html for details.</p>

<h3 id="rpc-agent-data-description-language">RPC Agent Data Description Language</h3>

<p>I&#8217;ve been working since around February on building introspection, automatically generated documentation and the ability for user interfaces to be auto generated for agents, even ones you write your self.</p>

<p>This feature is documented in &#8220;DDL&#8221;:/simplerpc/ddl.html but a quick example of a DDL document might help make it clear:</p>

<h3 id="cli-utilities-changes">CLI Utilities changes</h3>

<ul>
  <li><em>mc-facts</em> now take all the standard filters so you can make reports for just subsets of machines</li>
  <li>A new utility <em>mc-inventory</em> has been added, it will show agents, facts and classes for a node</li>
  <li><em>mc-rpc</em> has a new option <em>&#8211;agent-help</em> that will use the DDL and display auto generated documentation for an agent.</li>
  <li><em>mc-facts</em> output is sorted for better readability</li>
</ul>

<h3 id="backwards-compatibility-14">Backwards Compatibility</h3>

<p>This release will be backward compatible with older releases, the new Stomp features though require the newer Ruby Gem.</p>

<h3 id="changes-12">Changes</h3>

<table>
  <thead>
    <tr>
      <th>Date</th>
      <th>Description</th>
      <th>Ticket</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2010/06/12</td>
      <td>Qualify the Process class to avoid clashes in the discovery agent</td>
      <td>88</td>
    </tr>
    <tr>
      <td>2010/06/12</td>
      <td>Add mc-inventory which shows agents, classes and facts for a node</td>
      <td>87</td>
    </tr>
    <tr>
      <td>2010/06/11</td>
      <td>mc-facts now supports standard filters</td>
      <td>86</td>
    </tr>
    <tr>
      <td>2010/06/11</td>
      <td>Add connection pool retry options and SSL for connection</td>
      <td>85</td>
    </tr>
    <tr>
      <td>2010/06/11</td>
      <td>Add support for specifying multiple stomp hosts for failover</td>
      <td>84</td>
    </tr>
    <tr>
      <td>2010/06/10</td>
      <td>Tighten up handling of filters to avoid nil&#8217;s getting into them</td>
      <td>83</td>
    </tr>
    <tr>
      <td>2010/06/09</td>
      <td>Sort the mc-facts output to be more readable</td>
      <td>82</td>
    </tr>
    <tr>
      <td>2010/06/08</td>
      <td>Fix deprecation warnings in newer Stomp gems</td>
      <td>81</td>
    </tr>
  </tbody>
</table>

<h2 id="section-30">0.4.5 - 2010/06/03</h2>

<h3 id="release-focus-and-notes-7">Release Focus and Notes</h3>

<p>This release is a major feature release.</p>

<p>The focus of this release is to finish up some of the more enterprise like features, we now have fine grained Authorization and Authentication and a new security model that uses SSL keys.</p>

<h3 id="security-plugin">Security Plugin</h3>

<p>Vladimir Vuksan contributed the base code of a new &#8220;SSL based security plugin&#8221;:/reference/plugins/security_ssl.html .  This plugin builds on the old PSK plugin but gives each client a unique certificate pair.  The nodes all share a certificate and only store client public keys.  This means that should one node be compromised it cannot be used to control the rest of the network.</p>

<h3 id="authorization-plugin">Authorization Plugin</h3>

<p>We&#8217;ve developed new hooks and plugins for SimpleRPC that enable you to write &#8220;fine grained authorization systems&#8221;:/simplerpc/authorization.html .  You can do authorization on every aspect of the request and you&#8217;ll have access to the caller userid as provided by the security plugin.  Combined with the above SSL plugin this can be used to build powerful and secure Authentication and Authorization systems.</p>

<p>A sample plugin can be found &#8220;here&#8221;:http://code.google.com/p/mcollective-plugins/wiki/ActionPolicy</p>

<h3 id="enhancements-for-web-development">Enhancements for Web Development</h3>

<p>Web apps doesn&#8217;t tie in well with our discover, request, wait model.  We&#8217;ve made it easier for web apps to maintain their own cached discovery data using the &#8220;Registration:/reference/plugins/registration.html system and then based on that do requests that would not require any discovery.</p>

<h3 id="fire-and-forget-requests">Fire and Forget requests</h3>

<p>It is often desirable to just send a request and not wait for any reply.  We&#8217;ve made it easy to do requests like this] with the addition of a new request parameter on the SimpleRPC client class.</p>

<p>Requests like this will not take any time to do discovery and you will not be able to get results back from the agents.</p>

<h3 id="reloading-agents">Reloading Agents</h3>

<p>To make it a bit easier to manage daemons and agents you can now send the <em>mcollectived</em> a <em>USR1</em> signal and it will re-read all it&#8217;s agents from disk.</p>

<h3 id="backwards-compatibility-15">Backwards Compatibility</h3>

<p>This release when used with the old style PSK plugin should be perfectly backward compatible with your existing agents.  To use some of the newer features like authorization will require config and/or agent changes.</p>

<h3 id="changes-13">Changes</h3>

<table>
  <thead>
    <tr>
      <th>Date</th>
      <th>Description</th>
      <th>Ticket</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2010/06/01</td>
      <td>Improve the main discovery agent by adding facts and classes to its inventory action</td>
      <td>79</td>
    </tr>
    <tr>
      <td>2010/05/30</td>
      <td>Add various helpers to get reports as text instead of printing them</td>
      <td>43</td>
    </tr>
    <tr>
      <td>2010/05/30</td>
      <td>Add a custom_request method to call SimpleRPC agents with your own discovery</td>
      <td>75</td>
    </tr>
    <tr>
      <td>2010/05/30</td>
      <td>Refactor RPC::Client to be more generic and easier to maintain</td>
      <td>75</td>
    </tr>
    <tr>
      <td>2010/05/29</td>
      <td>Fix a small scoping issue in Security::Base</td>
      <td>76</td>
    </tr>
    <tr>
      <td>2010/05/25</td>
      <td>Add option &#8211;no-progress to disable progress bar for SimpleRPC</td>
      <td>74</td>
    </tr>
    <tr>
      <td>2010/05/23</td>
      <td>Add some missing dependencies to the RPMs</td>
      <td>72</td>
    </tr>
    <tr>
      <td>2010/05/22</td>
      <td>Add an option <em>:process_results</em> to the client</td>
      <td>71</td>
    </tr>
    <tr>
      <td>2010/05/13</td>
      <td>Fix help output that still shows old branding</td>
      <td>70</td>
    </tr>
    <tr>
      <td>2010/04/27</td>
      <td>The supplied generic stompclient now accepts STOMP_PORT in the environment</td>
      <td>68</td>
    </tr>
    <tr>
      <td>2010/04/26</td>
      <td>Add a SimpleRPC Client helper to reset filters</td>
      <td>64</td>
    </tr>
    <tr>
      <td>2010/04/26</td>
      <td>Listen for signal USR1 and reload all agents from disk</td>
      <td>65</td>
    </tr>
    <tr>
      <td>2010/04/12</td>
      <td>Add SimpleRPC Authorization support</td>
      <td>63</td>
    </tr>
  </tbody>
</table>

<h2 id="section-31">0.4.4 - 2010/04/03</h2>

<h3 id="release-focus-and-notes-8">Release Focus and Notes</h3>

<p>This release is mostly a bug fix release.</p>

<p>We&#8217;ve cleaned up the logs a bit so you&#8217;ll see fewer exceptions logged, also if you have Rails + Puppet on a node the logs will stay in the standard format.  We are handling some exceptions better which has improved stability of the registration system.</p>

<p>If you do some slow queries in your discovery agent you can bump the timeout up in the config using <em>plugin.discovery.timeout</em>.</p>

<p>All the scripts now use <em>/usr/bin/env ruby</em> rather than hardcoded paths to deal better with Ruby&#8217;s in weird places.</p>

<p>Several other small annoyances was fixed or improved.</p>

<h3 id="mc-controller">mc-controller</h3>

<p>We&#8217;ve always had a tool that let you control a network of mcollective instances remotely, it lagged behind a bit with the core, we&#8217;ve fixed it up and documented it &#8220;here&#8221;:/reference/basic/daemon.html .  You can use it to reload agents from disk without restarting the daemon for example or get stats or shut down the entire mcollective network.</p>

<h3 id="backwards-compatibility-16">Backwards Compatibility</h3>

<p>No changes that impacts backward compatibility has been made.</p>

<h3 id="changes-14">Changes</h3>

<table>
  <thead>
    <tr>
      <th>Date</th>
      <th>Description</th>
      <th>Ticket</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2010/03/27</td>
      <td>Make it easier to construct SimpleRPC requests to use with the standard client library</td>
      <td>60</td>
    </tr>
    <tr>
      <td>2010/03/27</td>
      <td>Manipulating the filters via the helper methods will force rediscovery</td>
      <td>59</td>
    </tr>
    <tr>
      <td>2010/03/23</td>
      <td>Prevent Activesupport when brought in by Facter from breaking our logs</td>
      <td>57</td>
    </tr>
    <tr>
      <td>2010/03/23</td>
      <td>Clean up logging for messages not targeted at us</td>
      <td>56</td>
    </tr>
    <tr>
      <td>2010/03/19</td>
      <td>Add exception handling to the registration base class</td>
      <td>55</td>
    </tr>
    <tr>
      <td>2010/03/03</td>
      <td>Use /usr/bin/env ruby instead of hardcoded paths</td>
      <td>54</td>
    </tr>
    <tr>
      <td>2010/02/17</td>
      <td>Improve mc-controller and document it</td>
      <td>46</td>
    </tr>
    <tr>
      <td>2010/02/08</td>
      <td>Remove some close coupling with Stomp to easy creating of other connectors</td>
      <td>49</td>
    </tr>
    <tr>
      <td>2010/02/01</td>
      <td>Made the discovery agent timeout configurable using plugin.discovery.timeout</td>
      <td>48</td>
    </tr>
    <tr>
      <td>2010/01/25</td>
      <td>mc-controller now correctly loads/reloads agents.</td>
      <td>45</td>
    </tr>
    <tr>
      <td>2010/01/25</td>
      <td>Building packages has been improved to ensure rdocs are always included</td>
      <td>44</td>
    </tr>
  </tbody>
</table>

<h2 id="section-32">0.4.3 - 2010/01/24</h2>

<h3 id="release-focus-and-notes-9">Release Focus and Notes</h3>

<p>This release fixes a few bugs and introduce a major new SimpleRPC feature for auditing requests.</p>

<h3 id="auditing">Auditing</h3>

<p>We&#8217;ve created an &#8220;auditing framework for SimpleRPC&#8221;:/simplerpc/auditing.html, each request gets passed to an audit plugin for processing.  We ship one that simply logs to a file on each node and there&#8217;s a &#8220;community plugin&#8221;:http://code.google.com/p/mcollective-plugins/wiki/AuditCentralRPCLog that logs everything on a central logging host.</p>

<p>In future we might add auditing to the client libraries so requests will be logged where they are sent as well as auditing of replies being sent, this will be driven by requests from the community though.</p>

<h3 id="new-fail-method-for-simplerpc">New <em>fail!</em> method for SimpleRPC</h3>

<p>Till now while writing agents you can use the <em>fail</em> method to set statuses in the reply, this however did not also raise exceptions and terminate execution of the agent immediately.</p>

<p>Often the existing behavior is required but it did lead to some awkward code when you did want to just exit the agent immediately as well as set a fail status.  We&#8217;ve added a <em>fail!</em> method that works just like <em>fail</em> except it stops execution of your agent immediately.</p>

<h3 id="backwards-compatibility-17">Backwards Compatibility</h3>

<p>No changes that impacts backward compatibility has been made.</p>

<h3 id="changes-15">Changes</h3>

<table>
  <thead>
    <tr>
      <th>Date</th>
      <th>Description</th>
      <th>Ticket</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2010/01/23</td>
      <td>Handle ctrl-c during discovery without showing exceptions to users</td>
      <td>34</td>
    </tr>
    <tr>
      <td>2010/01/21</td>
      <td>Force all facts in the YAML fact source to be strings</td>
      <td>41</td>
    </tr>
    <tr>
      <td>2010/01/19</td>
      <td>Add SimpleRPCAuditing audit logging to SimpleRPC clients and Agents</td>
      <td>&#160;</td>
    </tr>
    <tr>
      <td>2010/01/18</td>
      <td>The SRPM we provide will now build outside of the Rake environment</td>
      <td>40</td>
    </tr>
    <tr>
      <td>2010/01/18</td>
      <td>Add a <em>fail!</em> method to RPC::Agent</td>
      <td>37</td>
    </tr>
    <tr>
      <td>2010/01/18</td>
      <td>mc-rpc can now be used without supplying arguments</td>
      <td>38</td>
    </tr>
    <tr>
      <td>2010/01/18</td>
      <td>Don&#8217;t raise an error if no user/pass is given to the stomp connector, try unauthenticated mode</td>
      <td>35</td>
    </tr>
    <tr>
      <td>2010/01/17</td>
      <td>Improve error message when Regex validation failed on SimpleRPC input</td>
      <td>36</td>
    </tr>
  </tbody>
</table>

<h2 id="section-33">0.4.2 - 2010/01/14</h2>

<h3 id="release-focus-and-notes-10">Release Focus and Notes</h3>

<p>This release fixes a few bugs, add some command line improvements and brings major changes to the Debian packaging.</p>

<h3 id="packaging">Packaging</h3>

<p>Firstly we&#8217;ve had some amazing work done by Riccardo Setti to make us Debian packages that complies with Debian and Ubuntu policy, this release use these new packages.  It has some unfortunate changes to file layout detailed below but overall I think it&#8217;s a big win to get us in line with Distribution policies and standards.</p>

<p>The only major change is that in the past we used <em>/usr/libexec/mcollective</em> as the libdir, but Debian does not have this directory and it is not in the LFHS anymore so we now use <em>/usr/share/mcollective/plugins</em> as the lib dir.  You need to move your plugins there and update both client and server configs.</p>

<p>The RedHat packages will move to this convention too in the next release since I think it&#8217;s the better location and complies with LFHS.</p>

<h3 id="command-line-improvements">Command Line Improvements</h3>

<p>We&#8217;ve streamlined the command line a bit, nothings changed we&#8217;ve just added some flags.</p>

<p>The <em>&#8211;with-class</em>, <em>&#8211;with-fact</em>, <em>&#8211;with-agent</em> and <em>&#8211;with-identity</em> now all have a short form <em>-C</em>, <em>-F</em>, <em>-A</em> and <em>-I</em> respectively.</p>

<p>We&#8217;ve added a new filter option <em>&#8211;with</em> and a short form <em>-W</em> that combines <em>&#8211;with-class</em> and <em>&#8211;with-fact</em> into one filter type, use case would be:</p>

<div class="highlight"><pre><code class="console"><span class="go">  % mc-find-hosts -W &quot;/centreon/ country=de roles::dev_server/&quot;</span>
</code></pre>
</div>

<p>This would find hosts with class regex matched <em>/centreon/</em>, class <em>roles::dev_server</em> and fact matching <em>country=de</em>.  Hopefully this saves on some typing.</p>

<p>You can also now set the environment variables <em>MCOLLECTIVE_TIMEOUT</em> and <em>MCOLLECTIVE_DTIMEOUT</em> which saves you from typing <em>&#8211;timeout</em> and <em>&#8211;discovery-timeout</em> often, especially useful on very fast networks.</p>

<h3 id="other-fixes-and-improvements">Other fixes and improvements</h3>

<ul>
  <li>We&#8217;ve added the COPYING file to all the packages</li>
  <li>We&#8217;ve made the init script more LSB compliant</li>
  <li>A bug related to discovery in SimpleRPC was fixed</li>
</ul>

<h3 id="backwards-compatibility-18">Backwards Compatibility</h3>

<p>The only backwards issue is the Debian packages.  They&#8217;ve been tested to upgrade cleanly but you need to change the config as above.</p>

<h3 id="changes-16">Changes</h3>

<table>
  <thead>
    <tr>
      <th>Date</th>
      <th>Description</th>
      <th>Ticket</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2010/01/13</td>
      <td>New packaging for Debian provided by Riccardo Setti</td>
      <td>29</td>
    </tr>
    <tr>
      <td>2010/01/07</td>
      <td>Improved LSB compliance of the init script - thanks Riccardo Setti</td>
      <td>32</td>
    </tr>
    <tr>
      <td>2010/01/07</td>
      <td>Multiple calls to SimpleRPC client would reset discovered hosts</td>
      <td>31</td>
    </tr>
    <tr>
      <td>2010/01/04</td>
      <td>Timeouts can now be changed with MCOLLECTIVE_TIMEOUT and MCOLLECTIVE_DTIMEOUT environment vars</td>
      <td>25</td>
    </tr>
    <tr>
      <td>2010/01/04</td>
      <td>Specify class and fact filters easier with the new -W or &#8211;with option</td>
      <td>27</td>
    </tr>
    <tr>
      <td>2010/01/04</td>
      <td>Added COPYING file to RPMs and tarball</td>
      <td>28</td>
    </tr>
    <tr>
      <td>2010/01/04</td>
      <td>Make shorter filter options -C, -I, -A and -F</td>
      <td>26</td>
    </tr>
  </tbody>
</table>

<h2 id="section-34">0.4.1 - 2010/01/02</h2>

<h3 id="release-focus-and-notes-11">Release Focus and Notes</h3>

<p>This is a bug fix release to address some shortcomings and issues found in Simple RPC.</p>

<p>The main issue is around handling of meta data in agents, the documented approach did not work, we&#8217;ve now solved this by adding a number of hooks into the processing of Simple RPC agents.</p>

<p>We&#8217;ve also made logging and config retrieval a bit easier in agents - and documented this.</p>

<p>You can now call the <em>mc-rpc</em> command a bit easier:</p>

<div class="highlight"><pre><code class="console"><span class="go">  % mc-rpc --agent helloworld --action echo --argument msg=&quot;hello world&quot;</span>
<span class="go">  % mc-rpc helloworld echo msg=&quot;hello world&quot;</span>
</code></pre>
</div>

<p>The 2 calls are the same, you can pass as many arguments in <em>key=val</em> pairs as needed at the end.</p>

<h3 id="backwards-compatibility-19">Backwards Compatibility</h3>

<p>No issues with backward compatibility, should be a simple upgrade.</p>

<h3 id="changes-17">Changes</h3>

<table>
  <thead>
    <tr>
      <th>Date</th>
      <th>Description</th>
      <th>Ticket</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2010/01/02</td>
      <td>Added hooks to plug into the processing of requests, also enabled setting meta data and timeouts</td>
      <td>14</td>
    </tr>
    <tr>
      <td>2010/01/02</td>
      <td>Created readers for @config and @logger in the SimpleRPC agent</td>
      <td>23</td>
    </tr>
    <tr>
      <td>2009/12/30</td>
      <td>Don&#8217;t send out any requests if no nodes were discovered</td>
      <td>17</td>
    </tr>
    <tr>
      <td>2009/12/30</td>
      <td>Added :discovered and :discovered_nodes to client stats</td>
      <td>20</td>
    </tr>
    <tr>
      <td>2009/12/30</td>
      <td>Add a empty_filter? helper to the RPC mixin</td>
      <td>18</td>
    </tr>
    <tr>
      <td>2009/12/30</td>
      <td>Fix formatting bug with progress bar</td>
      <td>21</td>
    </tr>
    <tr>
      <td>2009/12/29</td>
      <td>Simplify mc-rpc command line</td>
      <td>16</td>
    </tr>
    <tr>
      <td>2009/12/29</td>
      <td>Fix layout issue when printing hosts that did not respond</td>
      <td>15</td>
    </tr>
  </tbody>
</table>

<h2 id="section-35">0.4.0 - 2009/12/29</h2>

<h3 id="release-focus-and-notes-12">Release Focus and Notes</h3>

<p>This release introduced a major new feature - Simple RPC - a framework for easily building clients and agents.  More than that it&#8217;s a set of conventions and standards that will help us build generic clients like web based ones capable of talking to all agents.</p>

<p>We think this feature is ready for wide use, it&#8217;s well documented and we&#8217;ve done extensive testing.  We&#8217;ll be porting some of our own code over to it once this release is out and we do anticipate there might be some <em>0.4.x</em> releases to round off a few issues that might remain.  We do not currently have any open tickets against Simple RPC.</p>

<p>We&#8217;ve also added the ability to create more complex queries such as:</p>

<div class="highlight"><pre><code class="console"><span class="go">--with-class /dev_server/ --with-class /rails/</span>
</code></pre>
</div>

<p>This does an <em>AND</em> operation on the puppet classes on the node and finds only nodes with both <em>/dev_server/</em> <em>AND</em> <em>/rails/</em> classes.  This new functionality applies to all types of filter.</p>

<p>We&#8217;ve made the <em>&#8211;with-class</em> filters more generic in comments, documentation etc with an eye to be more usable in Chef and other Configuration Management environments.</p>

<h3 id="backwards-compatibility-20">Backwards Compatibility</h3>

<p>Unfortunately introducing the new filtering methods has some backward compatibility issues, if you had clients/agents with code like:</p>

<div class="highlight"><pre><code class="ruby">   <span class="n">options</span><span class="o">[</span><span class="ss">:filter</span><span class="o">][</span><span class="s2">&quot;agent&quot;</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;some agent&quot;</span>
</code></pre>
</div>

<p>You should now change that to:</p>

<div class="highlight"><pre><code class="ruby">   <span class="n">options</span><span class="o">[</span><span class="ss">:filter</span><span class="o">][</span><span class="s2">&quot;agent&quot;</span><span class="o">]</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;some agent&quot;</span>
</code></pre>
</div>

<p>As each filter is an array now.  If you do not change the code it will still work as before but you will not be able to use the compound filtering feature on filter types that you&#8217;ve forced to be a string and there might be some other undesired side effects.  We&#8217;ve tried though to at least not break old code, they just can&#8217;t use the new features.</p>

<p>You were also able to test easily in the past if you&#8217;re running unfiltered using
something like:</p>

<div class="highlight"><pre><code class="ruby">   <span class="k">if</span> <span class="n">options</span><span class="o">[</span><span class="ss">:filter</span><span class="o">]</span> <span class="o">==</span> <span class="p">{}</span>
</code></pre>
</div>

<p>Now that&#8217;s much harder and we&#8217;ve added a helper to make this easier:</p>

<div class="highlight"><pre><code class="ruby">   <span class="k">if</span> <span class="no">MCollective</span><span class="o">::</span><span class="no">Util</span><span class="o">.</span><span class="n">empty_filter?</span><span class="p">(</span><span class="n">options</span><span class="o">[</span><span class="ss">:filter</span><span class="o">]</span><span class="p">)</span>
</code></pre>
</div>

<p>This new method is compatible with both the old and new filter method so you can start using it before you finish the first issue mentioned here.</p>

<p>We&#8217;ve also made the class filter more generic, in the past you did class filters like this:</p>

<div class="highlight"><pre><code class="ruby">   <span class="n">options</span><span class="o">[</span><span class="ss">:filter</span><span class="o">][</span><span class="s2">&quot;puppet_class&quot;</span><span class="o">]</span> <span class="o">&lt;&lt;</span> <span class="sr">/apache/</span>
</code></pre>
</div>

<p>Now you have to adjust it to:</p>

<div class="highlight"><pre><code class="ruby">   <span class="n">options</span><span class="o">[</span><span class="ss">:filter</span><span class="o">][</span><span class="s2">&quot;cf_class&quot;</span><span class="o">]</span> <span class="o">&lt;&lt;</span> <span class="sr">/apache/</span>
</code></pre>
</div>

<p>Old code will keep working but you should change to this name for filters to be consistent with the rest of the code base.</p>

<h3 id="changes-18">Changes</h3>

<table>
  <thead>
    <tr>
      <th>Date</th>
      <th>Description</th>
      <th>Ticket</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2009/12/28</td>
      <td>Add support for other configuration management systems like chef in the &#8211;with-class filters</td>
      <td>13</td>
    </tr>
    <tr>
      <td>2009/12/28</td>
      <td>Add a <code>Util.empty_filter?</code> to test for an empty filter</td>
      <td>&#160;</td>
    </tr>
    <tr>
      <td>2009/12/27</td>
      <td>Create a new client framework SimpleRPCIntroduction</td>
      <td>6</td>
    </tr>
    <tr>
      <td>2009/12/27</td>
      <td>Add support for multiple filters of the same type</td>
      <td>3</td>
    </tr>
  </tbody>
</table>

<h2 id="section-36">0.3.0 - 2009/12/17</h2>

<h3 id="release-focus-and-notes-13">Release Focus and Notes</h3>

<p>Primarily a bug fix release.  Only new feature is to allow the user to create <code>MCollective::Util::*</code> classes and put those in the plugins directory.  This is useful for more complex agents and clients.</p>

<h3 id="backwards-compatibility-21">Backwards Compatibility</h3>

<p>This release should not break any older code, if it does it&#8217;s a bug.</p>

<h3 id="changes-19">Changes</h3>

<table>
  <thead>
    <tr>
      <th>Date</th>
      <th>Description</th>
      <th>Ticket</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2009/12/16</td>
      <td>Improvements for newer versions of Ruby where TERM signal was not handled</td>
      <td>7</td>
    </tr>
    <tr>
      <td>2009/12/07</td>
      <td>MCollective::Util is now a module and plugins can drop in util classes in the plugin dir</td>
      <td>&#160;</td>
    </tr>
    <tr>
      <td>2009/12/07</td>
      <td>The Rakefile now works with rake provided on Debian 4 systems</td>
      <td>2</td>
    </tr>
    <tr>
      <td>2009/12/07</td>
      <td>Improvements in the RC script for Debian and older Ubuntu systems</td>
      <td>5</td>
    </tr>
  </tbody>
</table>

<h2 id="section-37">0.2.0 - 2009/12/02</h2>

<h3 id="release-focus-and-notes-14">Release Focus and Notes</h3>

<p>First numbered release</p>

<h3 id="backwards-compatibility-22">Backwards Compatibility</h3>

<p>n/a</p>

<h3 id="changes-20">Changes</h3>

<p>n/a</p>

              <blockquote><p style="font-size: 1.3em; text-align: center;"><a href="#content">↑ Back to top</a></p></blockquote>
            </div>
            <nav class="main">
                  <div id="subCol">


<ul>
  <li><strong>Overview</strong>
    <ul>
      <li><a href="./../mcollective/index.html">Introduction</a></li>
      <li><a href="./../mcollective/overview_components.html">Overview of Components</a></li>
      <li><a href="./../mcollective/terminology.html">Terminology</a></li>
      <li><a href="./../mcollective/screencasts.html">Screencasts</a></li>
      <li><span class="currentpage">Release Notes</span></li>
      <li><a href="./../mcollective/changelog.html">Changelog</a></li>
    </ul>
  </li>
  <li><strong>Deploying MCollective</strong>
    <ul>
      <li><a href="./../mcollective/deploy/index.html">Index</a></li>
      <li><a href="./../mcollective/deploy/demo.html">Demo</a></li>
      <li><a href="./../mcollective/deploy/standard.html">Getting Started (Standard Deployment)</a></li>
    </ul>
  </li>
  <li><strong>Configuration / Deployment Topics</strong>
    <ul>
      <li><strong>Installation:</strong></li>
      <li><a href="./../mcollective/deploy/install.html">Installing MCollective</a></li>
      <li><a href="./../mcollective/deploy/plugins.html">Installing Plugins</a></li>
      <li><strong>Configuration:</strong></li>
      <li><a href="./../mcollective/configure/server.html">Server Config Reference</a></li>
      <li><a href="./../mcollective/configure/client.html">Client Config Reference</a></li>
      <li><a href="./../mcollective/reference/integration/puppet.html">Puppet Integration</a></li>
      <li><a href="./../mcollective/reference/integration/chef.html">Chef Integration</a></li>
      <li><strong>Middleware:</strong></li>
      <li><a href="./../mcollective/deploy/middleware/index.html">Middleware Types</a></li>
      <li><a href="./../mcollective/deploy/middleware/activemq.html">ActiveMQ Configs for MCollective</a></li>
      <li><a href="./../mcollective/deploy/middleware/activemq_keystores.html">ActiveMQ TLS Keystore Setup</a></li>
      <li><a href="./../mcollective/reference/integration/activemq_clusters.html">ActiveMQ Clustering</a></li>
      <li><a href="./../mcollective/reference/integration/activemq_ssl.html">ActiveMQ TLS</a></li>
      <li><a href="./../mcollective/reference/integration/activemq_security.html">ActiveMQ Security</a></li>
      <li><strong>Connector Plugins:</strong></li>
      <li><a href="./../mcollective/reference/plugins/connector_activemq.html">The ActiveMQ Connector</a></li>
      <li><a href="./../mcollective/reference/plugins/connector_rabbitmq.html">The RabbitMQ Connector</a></li>
      <li><strong>Security Plugins:</strong></li>
      <li><a href="./../mcollective/reference/plugins/security_ssl.html">Configuring SSL Validation Security</a></li>
      <li><strong>Advanced Features:</strong></li>
      <li><a href="./../mcollective/reference/basic/subcollectives.html">Subcollectives and Partitioning</a></li>
      <li><a href="./../mcollective/simplerpc/auditing.html">Auditing</a> <!-- contains plugin-writing info --></li>
    </ul>
  </li>
  <li><strong>Use and Administer MCollective</strong>
    <ul>
      <li><a href="./../mcollective/reference/basic/basic_cli_usage.html">Command Line Usage Instructions</a></li>
      <li><a href="./../mcollective/reference/ui/filters.html">Command Filtering and Discovery</a></li>
      <li><a href="./../mcollective/reference/basic/daemon.html">Controlling the MCollective Daemon</a></li>
      <li><a href="./../mcollective/reference/plugins/rpcutil.html">Controlling the MCollective Daemon with the rpcutil Agent</a></li>
      <li><a href="./../mcollective/reference/ui/nodereports.html">On-Demand Node Reports</a></li>
    </ul>
  </li>
  <li><strong>Write Agent Plugins</strong>
    <ul>
      <li><a href="./../mcollective/simplerpc/agents.html">Writing Agent Plugins</a></li>
      <li><a href="./../mcollective/reference/plugins/ddl.html">Writing DDL Files</a></li>
      <li><a href="./../mcollective/reference/plugins/aggregate.html">Aggregating Results</a> <!-- mixes DDL info with info about writing aggregate plugins --></li>
    </ul>
  </li>
  <li><strong>Write Clients and Applications</strong>
    <ul>
      <li><a href="./../mcollective/simplerpc/clients.html">Writing Clients</a></li>
      <li><a href="./../mcollective/reference/plugins/application.html">Writing New mco Subcommands</a></li>
    </ul>
  </li>
  <li><strong>Write Other Plugins</strong>
    <ul>
      <li><a href="./../mcollective/simplerpc/authorization.html">Writing Authorization Plugins and Enabling Authorization</a> <!-- contains deploy/config info --></li>
      <li><a href="./../mcollective/reference/plugins/data.html">Writing Data Plugins</a></li>
      <li><a href="./../mcollective/reference/plugins/discovery.html">Writing and Using Discovery Plugins</a> <!-- contains usage info --></li>
      <li><a href="./../mcollective/reference/plugins/facts.html">Writing Facts Plugins</a></li>
      <li><a href="./../mcollective/reference/plugins/registration.html">Writing Registration Plugins</a></li>
      <li><a href="./../mcollective/reference/plugins/validator.html">Writing Validator Plugins</a></li>
    </ul>
  </li>
  <li><a href="http://projects.puppetlabs.com/projects/mcollective-plugins/wiki">Plugin Directory</a></li>
  <li><strong>Internals</strong>
    <ul>
      <li><a href="./../mcollective/reference/basic/messageflow.html">Message Flow</a> <!-- needs more/needs update --></li>
      <li><a href="./../mcollective/simplerpc/index.html">SimpleRPC Overview</a></li>
      <li><a href="./../mcollective/simplerpc/messageformat.html">SimpleRPC Message Format</a></li>
      <li><a href="./../mcollective/reference/basic/messageformat.html">Core Message Format</a></li>
      <li><a href="./../mcollective/security.html">Security Overview</a></li>
    </ul>
  </li>
  <li><strong>Older and Non-Recommended Information</strong>
    <ul>
      <li><a href="./../mcollective/reference/plugins/security_aes.html">Configuring AES Security</a></li>
      <li><a href="./../mcollective/reference/plugins/connector_stomp.html">Configuring the Generic Stomp Connector</a></li>
      <li><a href="./../mcollective/reference/basic/basic_agent_and_client.html">Writing Old-Style Agent Plugins</a></li>
      <li><a href="./../mcollective/reference/index.html">Alternate Index</a></li>
    </ul>
  </li>
</ul>

                      <div style="margin-top: 1.5em; padding-bottom: 10px;">
                          <p style="font-family: 'Lucida Grande',Lucida,Verdana,sans-serif;font-size: 16px; font-weight: bold; line-height: 22px; margin-bottom: 10px;">Download the Docs</p>
                          <a href="http://info.puppetlabs.com/download-pdfs.html"><img src="./../images/smallbits_small_docs.png" alt="Puppet docs download"></a>
                      </div>
                      <div style="margin-top: 0; padding-bottom: 10px;">
                          <p style="font-family: 'Lucida Grande',Lucida,Verdana,sans-serif;font-size: 16px; font-weight: bold; line-height: 22px; margin-bottom: 10px;">Download Puppet Enterprise</p>
                          <a href="http://info.puppetlabs.com/download-pe.html"><img src="./../images/puppet_cert_home.jpg" alt="Puppet Enterprise promo"></a>
                      </div>
                  </div>
            </nav>
          </div>
        </div>
      </section>

		<footer id="footer">
      <div class="site-width">

        <div class="primary-secondary-content">
          <div class="primary-content">
            <section id="newsletter">
                 <h4>Puppet Labs is Hiring</h4>
                 <p><a href="http://www.puppetlabs.com/company/jobs/">Engineers, developers & consultants</a>
                  <p>
		<h4>Newsletter</h4>

              <p>Stay up to date on all things puppet</p>

				<form class="lpeRegForm formNotEmpty" method="post" enctype="application/x-www-form-urlencoded" action="http://info.puppetlabs.com/index.php/leadCapture/save"; id="mktForm_1013" name="mktForm_1013">

				<label>Email Address:</label><span class='mktInput'><input class='mktFormText mktFormEmail' name="Email" id="Email" type='text' value="" maxlength='255'  /><span class='mktFormMsg'></span></span>

				<input id='mktFrmSubmit' type='submit' class='btn' style="width: auto; overflow: visible; padding-left: .25em; padding-right: .25em;" value='Subscribe' name='submitButton' onclick='formSubmit(document.getElementById("mktForm_1013")); return false;' />

				<input style='display: none;' id='mktFrmReset' type='reset' value='Clear' name='resetButton' onclick='formReset(document.getElementById("mktForm_1013")); return false;' />

				<span style="display:none;"><input type="text" name="_marketo_comments" value="" /></span>
				<input type="hidden" name="lpId" value="-1" />
				<input type="hidden" name="subId" value="100" />

				<input type="hidden" name="kw" value="" />
				<input type="hidden" name="cr" value="" />

				<input type="hidden" name="searchstr" value="" />
				<input type="hidden" name="lpurl" value="http://info.puppetlabs.com/testsubscription.html?cr={creative}&kw={keyword}"; />
				<input type="hidden" name="formid" value="1013" />
				<input type="hidden" name="returnURL" value="http://www.puppetlabs.com/misc/subscription-thank-you/"; />
				<input type="hidden" name="retURL" value="http://www.puppetlabs.com/misc/subscription-thank-you/"; />
				<input type="hidden" name="_mkt_disp" value="return" />
				<input type="hidden" name="_mkt_trk" value="" />

				</form>
				<script type="text/javascript" src="http://info.puppetlabs.com/js/mktFormSupport.js"></script>

				<script type="text/javascript">
				function formSubmit(elt) {
				return Mkto.formSubmit(elt);
				}
				function formReset(elt) {
				return Mkto.formReset(elt);
				}
				</script>

<a href="http://info.puppetlabs.com/puppet-enterprise" class="fbtn">Try Puppet Enterprise FREE</a>

            </section>
            <section id="elsewhere">
              <h4>Get Involved</h4>
              <ul>

                <li class="chat"><a href="http://webchat.freenode.net/?channels=puppet" rel="external"><span class="indicator"></span><span>Chat with us on IRC</span></a></li>
		<li class="discussion"><a href="http://groups.google.com/group/puppet-dev" rel="external"><span class="indicator"></span><span>Join the Puppet Developer List</span></a></li>
                <li class="discussion"><a href="http://groups.google.com/group/puppet-users?pli=1" rel="external"><span class="indicator"></span><span>Join the Puppet User List</span></a></li>

                <li class="linkedin"><a href="http://www.linkedin.com/groups?about=&gid=696467&trk=anet_ug_grppro" rel="external"><span class="indicator"></span><span>Join the Puppet Users LinkedIn group</span></a></li>

              </ul>
		<p>
		              		<h4>Follow us&#8230;</h4>

              		<ul class="followus">


			<li><a href="http://feeds.feedburner.com/PuppetLabs" target="_blank"><img src="http://www.puppetlabs.com/wp-content/plugins/my-profiles/images/rss.png" border="0"></a></li>
			<li><a href="http://www.facebook.com/pages/Puppet-Labs/219089920711" target="_blank"><img src="http://www.puppetlabs.com//wp-content/plugins/my-profiles/images/facebook.png" border="0"></a></li>
			<li><a href="http://www.twitter.com/puppetlabs" target="_blank"><img src="http://www.puppetlabs.com//wp-content/plugins/my-profiles/images/twitter.png" border="0"></a></li>
			<li><a href="http://www.linkedin.com/groups?about=&amp;gid=696467&amp;trk=anet_ug_grppro" target="_blank"><img src="http://www.puppetlabs.com//wp-content/uploads/2011/01/LinkedIn_IN_Icon_32px.png" border="0"></a></li>    <li><a href="https://github.com/puppetlabs" target="_blank"><img src="http://www.puppetlabs.com//wp-content/uploads/2011/01/github_icon.png" border="0"></a></li>
			<li><a href="https://plus.google.com/112682055028218091774?rel=author" target="_blank"><img src="https://puppetlabs.com/wp-content/uploads/2013/05/google_plus32x32.png" alt="Find Us on Google+" border="0"></a></li>
					</ul>

              	</p>

            </section>
          </div>
          <div class="secondary-content">
            <section id="book-it">
              <h4>Get the book!</h4>

              <p>James Turnbull and Jeff McCune's book <a href="http://www.apress.com/9781430230571" rel="nofollow">Pro Puppet</a> is a comprehensive and up-to-date look at Puppet and MCollective. </p>
              <a href="http://www.apress.com/9781430230571" rel="nofollow"><img src="http://www.puppetlabs.com/wp-content/uploads/2011/05/propuppetthumb.png" /></a>
            </section>
          </div>
        </div>
      </div>
		</footer>

    <div id="copyright">
      <div class="site-width">
        &copy; 2011 <a href="http://www.puppetlabs.com/" title="Puppet Labs">Puppet Labs</a>
        <span class="vcard">
         <span class="org"></span>
         <a class="email" href="mailto:info@puppetlabs.com">info@puppetlabs.com</a>

          <span class="adr">
           <span class="street-address">926 NW 13th Avenue #210</span>
           /
           <span class="locality">Portland</span>,
           <span class="region">OR</span>
           <span class="postal-code">97209</span>

          </span>

         <span class="tel">1-877-575-9775</span>
        </span>
      </div>
    </div>

  	<script type="text/javascript">Cufon.now();</script>
  	<style type="text/css">h1, h2, .btn { visibility : visible; }</style>


	</body>
</html>
