<!DOCTYPE html>
<html dir="ltr" lang="en-US">
  <head>
  	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  	<title>Troubleshooting — Documentation — Puppet Labs</title>
  	<link rel="alternate" type="application/atom+xml" title="Puppet Labs Documentation Updates" href="https://github.com/puppetlabs/puppet-docs/commits/master.atom">
    <link rel="alternate" type="application/atom+xml" title="Puppet Labs Blog Feed" href="http://puppetlabs.com/feed/atom/">
    <link rel='index' title='Puppet Labs Documentation' href='http://docs.puppetlabs.com' />
    <link rel='icon' href='./../favicon.ico' />

  <meta name="description" content="TroubleshootingAnswers to some common problems that may come up.Basic workflow items are covered in the main section of the documentation.  If you&...">




    <!-- FIXME: absolute paths -->

    <script type='text/javascript' src='./../files/javascripts/html5.js'></script>
    <script type='text/javascript' src='./../files/javascripts/jquery-1.3.2.min.js'></script>
    <script type='text/javascript' src='./../files/javascripts/drop_down.js'></script>
    <script type='text/javascript' src='./../files/javascripts/cufon-yui.js'></script>
    <script type='text/javascript' src='./../files/fonts/Klavika_400-Klavika_600.font.js'></script>
    <script type='text/javascript' src='./../files/javascripts/ampersands.js'></script>
    <script type="text/javascript" src="http://puppetlabs.com/wp-content/themes/puppetlabs/javascripts/leadcapture.js"></script>

    <!-- All in One SEO Pack 1.6.10.1 by Michael Torbert of Semper Fi Web Design[127,146] -->
    <meta name="keywords" content="Puppet, puppet labs, reductive labs, open source, system administrator, ruby, data center, automation, support" />
    <!-- /all in one seo pack -->

    <!-- Give us the option of setting a canonical URL in yaml frontmatter -NF -->
    <link rel="canonical" href="http://docs.puppetlabs.com/guides/troubleshooting.html" />

    <!-- FIXME: absolute paths -->

    <link rel="stylesheet" type="text/css" href="./../files/stylesheets/style_legacy.css" media="screen">
    <link rel="stylesheet" type="text/css" href="./../files/stylesheets/syntax.css" media="screen"> <!-- index -->
    <link rel="stylesheet" type="text/css" href="./../files/stylesheets/adbanner.css" media="screen">

    <!--[if IE 7]>
	  <link rel="stylesheet" type="text/css" href="./../files/stylesheets/ie_7.css" media="screen"> <!-- index -->
    <![endif]-->

    <!--[if IE 8]>
	    <link rel="stylesheet" type="text/css" href="./../files/stylesheets/ie_8.css" media="screen"> <!-- index -->
    <![endif]-->

  	<script type="text/javascript">
      Cufon.replace('h1, h2', { fontWeight: '600' });
  	</script>
</head>




  <body id="puppetlabsdocs" class="docs">
  <style type="text/css">h1, h2{ visibility : hidden }</style>
  <!--[if IE 8]>
    <style type="text/css">h1, h2{ visibility : visible }</style>
  <![endif]-->

  	<header id="header">
      <div class="site-width">
    		<h1><a href="http://puppetlabs.com/"><span>Puppet Labs</span></a></h1>
        <a class="screen-reader-content" href="#content">Skip navigation</a>
        <nav>
    		<ul id="global-navigation">
          <li id="puppet-tab" class="with-submenu">
            <a href="http://puppetlabs.com/puppet/puppet-enterprise">
              <span>Products</span>
              <span class="drop-down-trigger"></span>
            </a>
            <ul>
			<li>
                <ul>
                   <a href="http://puppetlabs.com/puppet/what-is-puppet/">What is Puppet?</a>
                </ul>
              </li>
			       <li>
                <ul>
                   <a href="http://puppetlabs.com/puppet/puppet-enterprise/">Puppet Enterprise</a>
                </ul>
              </li>
            <li>
                <ul>
                   <a href="http://puppetlabs.com/puppet/whats-new/">What's New in 2.5</a>
                </ul>
              </li>
            <li>
                <ul>
                   <a href="http://puppetlabs.com/puppet/puppet-open-source/">Puppet Open Source</a>
                </ul>
              </li>
            <li>
                <ul>
                   <a href="http://puppetlabs.com/puppet/enterprise-vs-open-source/">Enterprise vs. Open Source</a>
                </ul>
              </li>
              <li>
                <ul>
                  <a href="http://forge.puppetlabs.com">Puppet Forge</a>
                </ul>
              </li>
              <li>
                <ul>
                  <a href="http://puppetlabs.com/puppet/requirements/">Components &amp; Requirements</a>
                </ul>
              </li>
              <li>
                <ul>
                  <a href="http://puppetlabs.com/puppet/faq/">FAQ</a>
                </ul>
              </li>
			  <li>
                <ul>
                  <a href="http://puppetlabs.com/puppet/how-to-buy/">How to Buy</a>
                </ul>
              </li>
            </ul>
          </li>
          <li id="solutions-tab" class="with-submenu">
            <a href="http://puppetlabs.com/solutions/">
              <span>Solutions</span>
              <span class="drop-down-trigger"></span>
            </a>
            <ul>
              <li class="page_item page-item-12296"><a href="http://puppetlabs.com/solutions/configuration-management/">Configuration Management</a></li>
<li class="page_item page-item-986"><a href="http://puppetlabs.com/solutions/virtualization-management/">Virtualization Management</a></li>
<li class="page_item page-item-993"><a href="http://puppetlabs.com/solutions/cloud-management/">Cloud Management</a></li>
<li class="page_item page-item-996"><a href="http://puppetlabs.com/solutions/it-compliance/">IT Compliance</a></li>
<li class="page_item page-item-9520"><a href="http://puppetlabs.com/solutions/devops/">DevOps</a></li>
<li class="page_item page-item-991"><a href="http://puppetlabs.com/solutions/manage-os-x-resources/">OS X Desktops</a></li>
            </ul>
          </li>
          <li id="services-tab" class="with-submenu">
            <a href="http://puppetlabs.com/services/">
              <span>Services</span>
              <span class="drop-down-trigger"></span>
            </a>
            <ul>
              <li class="page_item page-item-783"><a href="http://puppetlabs.com/services/overview/">Overview</a></li>
<li class="page_item page-item-1052"><a href="http://puppetlabs.com/services/customer-support/">Customer Support</a></li>
<li class="page_item page-item-11022"><a href="http://puppetlabs.com/services/support-plans/">Support Plans</a></li>
<li class="page_item page-item-845"><a href="http://puppetlabs.com/services/training-workshops/">On-Site Education</a></li>
<li class="page_item page-item-4899"><a href="http://puppetlabs.com/services/consulting/">Professional Services</a></li>
<li class="page_item page-item-849"><a href="http://puppetlabs.com/category/events/upcoming/">Events &amp; Workshops</a></li>
<li class="page_item page-item-851"><a href="http://puppetlabs.com/services/partners/">Partners</a></li>
            </ul>
          </li>
                    <li id="resources-tab" class="with-submenu">
            <a href="http://puppetlabs.com/resources/">
              <span>Resources</span>
              <span class="drop-down-trigger"></span>
            </a>
            <ul>
              <li class="page_item page-item-1048"><a href="http://puppetlabs.com/resources/overview-2/">Overview</a></li>
<li class="page_item page-item-1040"><a href="http://docs.puppetlabs.com">Documentation</a></li>
<li class="page_item page-item-872"><a href="http://info.puppetlabs.com/register-download">Downloads</a></li>
<li class="page_item page-item-1961"><a href="http://forge.puppetlabs.com">Puppet Forge</a></li>
<li class="page_item page-item-835"><a href="http://info.puppetlabs.com/download-whitepapers.html">White Papers</a></li>
<li class="page_item page-item-1967"><a href="http://projects.puppetlabs.com/projects/puppet/wiki">Wiki</a></li>
<li class="page_item page-item-7279"><a href="http://puppetlabs.com/resources/webinars/">Upcoming Webinars</a></li>
<li class="page_item page-item-10183"><a href="http://puppetlabs.com/resources/newsletter/">Newsletter</a></li>
<li class="page_item page-item-12263"><a href="http://puppetlabs.com/resources/tech-notes/">Tech Notes</a></li>
<li class="page_item page-item-10265"><a href="http://info.puppetlabs.com/pe2-webinar.html">Webinars</a></li>
            </ul>
          </li>

          <li id="customers-tab" class="with-submenu">
            <a href="http://puppetlabs.com/customers/companies/">
              <span>Customers</span>
              <span class="drop-down-trigger"></span>
            </a>
            <ul>
			<li>
                <ul>
                  <a href="http://puppetlabs.com/customers/companies/">Companies</a>
                </ul>
              </li>
			  <li>
                <ul>
                  <a href="http://puppetlabs.com/customers/case-studies/">Case Studies</a>
                </ul>
              </li>
			  <li>
                <ul>
                  <a href="http://puppetlabs.com/customers/product-testimonials/">Product Testimonials</a>
                </ul>
              </li>
			    <li>
                <ul>
                  <a href="http://puppetlabs.com/customers/what-customers-are-saying/">Service Testimonials</a>
                </ul>
              </li>
            </ul>
          </li>
          <li id="community-tab" class="with-submenu">
            <a href="http://puppetlabs.com/community/">
              <span>Community</span>
              <span class="drop-down-trigger"></span>
            </a>

 <ul>
			<li>
                <ul>
                  <a href="http://puppetlabs.com/community/overview/">Overview</a>
                </ul>
              </li>
			<li>
                <ul>
                  <a href="http://puppetlabs.com/blog">Blog</a>
                </ul>
              </li>
			  <li>
                <ul>
                  <a href="http://puppetlabs.com/community/puppet-camp/">Puppet Camp</a>
                </ul>
              </li>
			  <li>
                <ul>
                  <a href="http://puppetlabs.com/community/user-groups-and-devops-groups/">Puppet User Groups & DevOps Groups</a>
                </ul>
              </li>
	          <li>
                <ul>
                  <a href="http://puppetlabs.com/community/presentations/">Presentations</a>
                </ul>
              </li>
			    <li>
                <ul>
                  <a href="http://puppetlabs.com/community/videos/">Videos</a>
                </ul>
              </li>

            </ul>

          <li id="company-tab" class="with-submenu">
            <a href="http://puppetlabs.com/company/">
              <span>Company</span>
              <span class="drop-down-trigger"></span>
            </a>
            <ul>
              <li class="page_item page-item-2316"><a href="http://puppetlabs.com/company/overview/">Overview</a></li>
<li class="page_item page-item-2179"><a href="http://puppetlabs.com/company/news/">News</a>
<ul class='children'>
	<li class="page_item page-item-2338"><a href="http://puppetlabs.com/company/news/press-releases/">Press Releases</a></li>
	<li class="page_item page-item-2383"><a href="http://puppetlabs.com/company/news/media-kit/">Media Kit</a></li>
</ul>
</li>
<li class="page_item page-item-1571"><a href="http://puppetlabs.com/company/careers/">Careers</a></li>
<li class="page_item page-item-10372"><a href="http://puppetlabs.com/company/management/">Management</a></li>
<li class="page_item page-item-10311"><a href="http://puppetlabs.com/company/board-and-advisors/">Board and Advisors</a></li>
<li class="page_item page-item-10367"><a href="http://puppetlabs.com/company/investors/">Investors</a></li>
<li class="page_item page-item-2313"><a href="http://puppetlabs.com/company/contact-us/">Contact Us</a></li>
<li class="page_item page-item-10579"><a href="http://puppetlabs.com/company/awards/">Awards</a></li>
            </ul>
          </li>
    		</ul>
          <div id="misc-navigation">
			  <ul>
				<li><a href="http://puppetlabs.com/security/">Security</a></li>
				<li><a href="http://docs.puppetlabs.com">Documentation</a></li>
				<li><a href="http://puppetlabs.com/resources/customer-support/">Support</a></li>
			        <li><a href="http://projects.puppetlabs.com/">Bug Tracker</a></li>
				<li><a href="http://puppetlabs.com/company/contact/contact-us">Contact Us</a></li>
				<li><a href="http://info.puppetlabs.com/download-pe2.html" class="gateway">Download</a></li>
			  </ul>
			<form action="http://www.google.com/cse" id="cse-search-box">
			  <div>
				<input type="hidden" name="cx" value="017668764424496204839:ubligvgbenm" />
				<input type="hidden" name="ie" value="UTF-8" />
				<input type="text" name="q" class="gsc-input" size="31" />
				<input type="submit" name="sa" class="searchbtn" value="Search" />
			  </div>
			</form>
			<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&lang=en"></script>
          </div>
      </nav>
    	</div>
    </header>

      <section id="masthead">
        <div class="site-width">
          <h1>Docs: <span class="section-name">Troubleshooting</span></h1>
          <ul id="doc-navigation">
            <li><a href="./../index.html">Docs Home</a></li>
            <li class="with-submenu">
              <a href="#">
                <span>Quick Nav</span>
                <span class="drop-down-trigger"></span>
              </a>
               <!-- the following links can't be relative, unfortunately -->
               <!-- future: add some JS to disable this if running from file:// -->
                               <dl>
                  <dt>Puppet Documentation</dt>
                      <dd><a href="./../puppet/3/reference/index.html">Puppet 3 Reference Manual</a></dd>
                      <dd><a href="./../puppet/2.7/reference/index.html">Puppet 2.7 Reference Manual</a></dd>
                      <dd><a href="./../pe/latest/index.html">Puppet Enterprise User's Guide</a></dd>
                      <dd><a href="./../learning/index.html">Learning Puppet</a></dd>
                      <dd><a href="./../references/latest/type.html">Resource Types</a></dd>
                      <dd><a href="./../references/latest/function.html">Functions</a></dd>
                      <dd><a href="./../references/latest/configuration.html">Configuration</a></dd>
                      <dd><a href="./../references/latest/developer/index.html">Developer</a></dd>
                      <dd><a href="./../references/glossary.html">Glossary of Puppet Terms</a></dd>
                      <dd><a href="./../references/index.html">Older References</a></dd>
                  <dt>Facter</dt>
                      <dd><a href="./../facter/latest/core_facts.html">Core Facts Reference</a></dd>
                  <dt>PuppetDB</dt>
                      <dd><a href="./../puppetdb/1/index.html">PuppetDB 1 Manual</a></dd>
                  <dt>MCollective</dt>
                      <dd><a href="./../mcollective/index.html">Index</a></dd>
                      <dd><a href="./../mcollective/reference/index.html">References</a></dd>
                      <dd><a href="./../mcollective/simplerpc/index.html">Writing Plugins</a></dd>
                      <dd><a href="./../mcollective/releasenotes.html">Release Notes</a></dd>
                </dl>

            </li>
            <li><a href="./../contribute.html">Contribute</a></li>
          </ul>
        </div>
        <br />
      </section>

      <section id="content">
        <div class="site-width">
          <div class="primary-secondary-content">
            <div class="primary-content">
              <h1 id="troubleshooting">Troubleshooting</h1>

<p>Answers to some common problems that may come up.</p>

<p>Basic workflow items are covered in the main section of the documentation.  If you&#8217;re looking for how to do something unconventional, you may also wish to read <a href="./techniques.html">Techniques</a>.</p>

<hr />

<h2 id="general">General</h2>

<h3 id="my-catalog-wont-compile-andor-my-code-is-behaving-unpredictably">My Catalog Won&#8217;t Compile and/or My Code is Behaving Unpredictably</h3>
<p>Puppet 3 uses an updated version of Ruby, 1.9 that is much stricter about character encodings than the version of Ruby used previously. As a result, puppet code that contains UTF-8 characters such as accents or other non-ASCII characters can fail or act unpredictably. There are a number of ways UTF-8 characters can make it into puppet code, including, but not limited to, downloading a Forge module where some piece of metadata (e.g., author&#8217;s name) contains UTF-8 characters. With apologies to our international customers, the current solution is to strictly limit puppet code to the ASCII character set only, including any code comments or metadata. Puppet Labs is working on cleaning up character encoding issues in Puppet and the various libraries it interfaces with.</p>

<h3 id="why-hasnt-my-new-node-configuration-been-noticed">Why hasn&#8217;t my new node configuration been noticed?</h3>

<p>If you&#8217;re using separate node definition files and import them into
site.pp (with an <code>import *.node</code>, for example) you&#8217;ll find that new
files added won&#8217;t get noticed until you restart puppetmasterd. This
is due to the fact globs aren&#8217;t evaluated on each run, but only
when the &#8216;parent&#8217; file is re-read.</p>

<p>To make sure your new file is actually read, simply &#8216;touch&#8217; the
site.pp (or importing file) and the glob will be re-evaluated.</p>

<h3 id="why-dont-my-certificates-show-as-waiting-to-be-signed-on-my-server-when-i-do-a-puppet-cert---list">Why don&#8217;t my certificates show as waiting to be signed on my server when I do a &#8220;<code>puppet cert --list</code>&#8221;?</h3>

<p>puppet cert must be run with root privileges. If you are not root, then re-run the
command with sudo:</p>

<pre><code>sudo puppet cert --list
</code></pre>

<h3 id="i-keep-getting-certificates-were-not-trusted-whats-wrong">I keep getting &#8220;certificates were not trusted&#8221;. What&#8217;s wrong?</h3>

<p>Firstly, if you&#8217;re re-installing a machine, you probably haven&#8217;t
cleared the previous certificate for that machine. To correct the
problem:</p>

<ol>
  <li>Run <code>sudo puppet cert --clean {node certname}</code> on the puppet master to
clear the certificates.</li>
  <li>Remove the entire SSL directory of the client machine (<code>sudo rm -r etc/puppet/ssl; rm -r /var/lib/puppet/ssl</code>).</li>
</ol>

<p>Assuming that you&#8217;re not re-installing, by far the most common
cause of SSL problems is that the clock on the client machine is
set incorrectly, which confuses SSL because the &#8220;validFrom&#8221; date in
the certificate is in the future.</p>

<p>You can figure the problem out by manually verifying the
certificate with openssl:</p>

<pre><code>sudo openssl verify -CAfile /etc/puppet/ssl/certs/ca.pem /etc/puppet/ssl/certs/myhostname.domain.com.pem
</code></pre>

<p>This can also happen if you&#8217;ve followed the <a href="./mongrel.html">Using Mongrel</a>
pattern to alleviate file download problems. If your set-up is such
that the host name differs from the name in the Puppet server
certificate, or there is any other SSL certificate negotiation
problem, the SSL handshake between client and server will fail. In
this case, either alleviate the SSL handshake problems (debug using
cURL), or revert to the original Webrick installation.</p>

<h3 id="agents-are-failing-with-a-hostname-was-not-match-with-the-server-certificate-error-whats-wrong">Agents are failing with a &#8220;hostname was not match with the server certificate&#8221; error; what&#8217;s wrong?</h3>

<p>Agent nodes determine the validity of the master&#8217;s certificate based on hostname; if they&#8217;re contacting it using a hostname that wasn&#8217;t included when the certificate was signed, they&#8217;ll reject the certificate. </p>

<p>To fix this error, either: </p>

<ul>
  <li>
    <p>Modify your agent nodes&#8217; settings to point to one of the master&#8217;s certified hostnames. (This may also require adjusting your site&#8217;s DNS.) To see the puppet master&#8217;s certified hostnames, run:</p>

    <pre><code>  $ sudo puppet master --configprint certname
</code></pre>

    <p>&#8230;on the puppet master server.</p>
  </li>
  <li>
    <p>Re-generate the puppet master&#8217;s certificate: </p>
    <ul>
      <li>Stop puppet master.</li>
      <li>
        <p>Delete the puppet master&#8217;s certificate, private key, and public key:</p>

        <pre><code>  $ sudo find $(puppet master --configprint ssldir) -name "$(puppet master --configprint certname).pem" -delete
</code></pre>
      </li>
      <li>Edit the <code>certname</code> setting in the puppet master&#8217;s <code>/etc/puppet/puppet.conf</code> file to match the puppet master&#8217;s actual hostname, and the <code>dns_alt_names</code> setting in that file to match any other DNS names you expect the master to need to respond to.</li>
      <li>
        <p>Start a non-daemonized WEBrick puppet master instance, and wait for it to generate and sign a new certificate:</p>

        <pre><code>  $ sudo puppet master --no-daemonize --verbose
</code></pre>

        <p>You should stop the temporary puppet master with ctrl-C after you see the &#8220;notice: Starting Puppet master version 2.6.9&#8221; message.</p>
      </li>
      <li>Restart the puppet master.</li>
    </ul>
  </li>
</ul>

<h3 id="im-getting-ipv6-errors-whats-wrong">I&#8217;m getting IPv6 errors; what&#8217;s wrong?</h3>

<p>This can happen if Ruby is not compiled with IPv6
support. The only known
solution is to make sure you&#8217;re running a version of Ruby compiled
with IPv6 support.</p>

<h3 id="im-getting-tlsv1-alert-unknown-ca-errors-whats-wrong">I&#8217;m getting tlsv1 alert unknown ca errors; what&#8217;s wrong?</h3>

<p>This problem is caused by puppetmasterd not being able to read its
ca certificate. This problem might occur up to 0.18.4 but has been
fixed in 0.19.0. You can probably fix it for versions before 0.19.0
by changing the group ownership of the /etc/puppet/ssl directory to
the puppet group, but puppetd may change the group back. Having
puppetmasterd start as the root user should fix the problem
permanently until you can upgrade.</p>

<h3 id="why-does-puppet-keep-trying-to-start-a-running-service">Why does Puppet keep trying to start a running service?</h3>

<p>The ideal way to check for a service is to use the hasstatus
attribute, which calls the init script with its <code>status</code> command.
This should report back to Puppet whether the service is running or
stopped.</p>

<p>In some broken scripts, however, the status output will be correct
(&#8220;Ok&#8221; or &#8220;not running&#8221;), but the exit code of the script will be
incorrect. (Most commonly, the script will always blindly return 0.)
Puppet only uses the exit code, and so may behave unpredictably in
these cases.</p>

<p>There are two workarounds, and one fix. If you must deal with the
script&#8217;s broken behavior as is, your resource can either use the &#8220;pattern&#8221;
attribute to look for a particular name in the process table, or use the
&#8220;status&#8221; attribute to specify a custom script that returns the proper exit
code for the service&#8217;s status.</p>

<p>The longer-term fix is to rewrite the service&#8217;s init script to use the proper
exit codes. When rewriting them, or submitting bug reports to vendors or
upstream, be sure to reference the
<a href="http://refspecs.linux-foundation.org/LSB_3.1.0/LSB-Core-generic/LSB-Core-generic/iniscrptact.html">LSB Init Script Actions</a>
standard. This should carry more weight by pointing out an
official, published standard they&#8217;re failing to meet, rather than
trying to explain how their bug is causing problems in Puppet.</p>

<h3 id="why-is-my-external-node-configuration-failing-i-get-no-errors-by-running-the-script-by-hand">Why is my external node configuration failing? I get no errors by running the script by hand.</h3>

<p>Most of the time, if you get the following error when running you
client</p>

<pre><code>warning: Not using cache on failed catalog
err: Could not retrieve catalog; skipping run
</code></pre>

<p>it is because of some invalid YAML output from your external node
script. Check <a href="http://www.yaml.org">yaml.org</a> if you
have doubts about validity.</p>

<h2 id="puppet-syntax-errors">Puppet Syntax Errors</h2>

<p>Puppet generates syntax errors when manifests are incorrectly
written. Sometimes these errors can be a little cryptic. Below is a
list of common errors and their explanations that should help you
trouble-shoot your manifests.</p>

<h3 id="syntax-error-at--expected--at-manifestppnnn">Syntax error at &#8216;}&#8217;; expected &#8216;}&#8217; at manifest.pp:nnn</h3>

<p>This error can occur when:</p>

<pre><code>service { "fred" }
</code></pre>

<p>This contrived example demonstrates one way to get the very
confusing error of Puppet&#8217;s parser expecting what it found. In this
example, the colon ( : ) is missing after the service title. A
variant looks like:</p>

<pre><code>service { "fred"
    ensure =&gt; running
}
</code></pre>

<p>and the error would be Syntax error at &#8216;ensure&#8217;; expected &#8216;}&#8217; .</p>

<p>You can also get the same error if you forget a comma. For
instance, in this example the comma is missing at the end of line
3:
    service {
      &#8220;myservice&#8221;:
        provider =&gt; &#8220;runit&#8221;
        path =&gt; &#8220;/path/to/daemons&#8221;
    }</p>

<h3 id="syntax-error-at--expected--at-manifestppnnn-1">Syntax error at &#8216;:&#8217;; expected &#8216;]&#8217; at manifest.pp:nnn</h3>

<p>This error can occur when:</p>

<pre><code>classname::define_name {
    "jdbc/automation":
        cpoolid     =&gt; "automationPool",
        require     =&gt; [ Classname::other_define_name["automationPool"] ],
}
</code></pre>

<p>The problem here is that Puppet requires that object references in
the require lines to begin with a capital letter. However, since
this is a reference to a class and a define, the define also needs
to have a capital letter, so Classname::Other_define_name would
be the correct syntax.</p>

<h3 id="syntax-error-at--expected--at-manifestppnnn-2">Syntax error at &#8216;.&#8217;; expected &#8216;}&#8217; at manifest.pp:nnn</h3>

<p>This error happens when you use unquoted comparators with dots in
them, a&#8217;la:</p>

<pre><code>class autofs {

  case $kernelversion {
    2.6.9:   { $autofs_packages = ["autofs", "autofs5"] }
    default: { $autofs_packages = ["autofs"] }
  }
}
</code></pre>

<p>That 2.6.9 needs to have double quotes around it, like so:</p>

<pre><code>class autofs {

   case $kernelversion {
     "2.6.9":   { $autofs_packages = ["autofs", "autofs5"] }
     default: { $autofs_packages = ["autofs"] }
   }
 }
</code></pre>

<h3 id="could-not-match-definename-at-manifestppnnn-on-node-nodename">Could not match &#8216;_define_name&#8217; at manifest.pp:nnn on node nodename</h3>

<p>This error can occur using a manifest like:</p>

<pre><code>case $ensure {
    "present": {
        _define_name {
            "$title":
                user        =&gt; $user,
        }
    }
}
</code></pre>

<p>This one is simple - you cannot begin a function name (define name)
with an underscore.</p>

<h3 id="duplicate-definition-classnamedefinenamesystem-is-already-defined-in-file-manifestpp-at-line-nnn-cannot-redefine-at-manifestppnnn-on-node-nodename">Duplicate definition: Classname::Define_name[system] is already defined in file manifest.pp at line nnn; cannot redefine at manifest.pp:nnn on node nodename</h3>

<p>This error can occur when using a manifest like:</p>

<pre><code>Classname::define_name {
     "system":
         properties  =&gt; "Name=system";
     .....
     "system":
          properties  =&gt; "Name=system";
 }
</code></pre>

<p>The most confusing part of this error is that the line numbers are
usually the same - this is the case when using the block format
that Puppet supports for a resource definition. In this contrived
example, the system entry has been defined twice, so one of them
needs removing.</p>

<h3 id="syntax-error-at--expected-">Syntax error at &#8216;=&gt;&#8217;; expected &#8216;)&#8217;</h3>

<p>This error results from incorrect syntax in a defined resource type:</p>

<pre><code>define foo($param =&gt; 'value') { ... }
</code></pre>

<p>Default values for parameters are assigned, not defined, therefore
a &#8216;=&#8217;, not a &#8216;=&gt;&#8217; operator is needed.</p>

<h3 id="syntax-error-at--expected--1">Syntax error at &#8216;&#171;|&#8217;; expected &#8216;|&#187;&#8217;</h3>

<p>You may get this error when using a manifest like:</p>

<pre><code>node a {
   @@foo_module::bar_exported_resource {
        .....
   }
}

node b {
   #where we collect things
   .....

   foo_module::bar_exported_resource &lt;&lt;| |&gt;&gt;
}
</code></pre>

<p>This confusing error is a result of improper (or rather lack of any) capitalization while collecting the exported resource &#8212; <a href="./../puppet/latest/reference/lang_collectors.html#syntax">resource collectors use the capitalized form of the resource type.</a> The manifest for the node b should actually be:</p>

<pre><code>node b {
    #where we collect things
    .....

    Foo_module::Bar_exported_resource &lt;&lt;| |&gt;&gt;
}
</code></pre>

<h3 id="err-exported-resource-blahsometitle-cannot-override-local-resource-on-node-nodename">err: Exported resource Blah[$some_title] cannot override local resource on node $nodename</h3>

<p>While this is not a classic &#8220;syntax&#8221; error, it is a annoying error
none-the-less. The actual error tells you that you have a local
resource Blah[$some_title] that puppet refuses to overwrite with a
collected resource of the same name. What most often happens, that
the same resource is exported by two nodes. One of them is
collected first and when trying to collect the second resource,
this error happens as the first is already converted to a &#8220;local&#8221;
resource.</p>

<h2 id="common-misconceptions">Common Misconceptions</h2>

<h3 id="node-inheritance-and-variable-scope">Node Inheritance and Variable Scope</h3>

<p>It is generally assumed that the following will result in the
/tmp/puppet-test.variable file containing the string &#8216;my_node&#8217;:</p>

<pre><code>class test_class {
    file { "/tmp/puppet-test.variable":
       content =&gt; "$testname",
       ensure =&gt; present,
    }
}

node base_node {
    include test_class
}

node my_node inherits base_node {
    $testname = 'my_node'
}
</code></pre>

<p>Contrary to expectations, /tmp/puppet-test.variable is created with
no contents. This is because the inherited test_class remains in
the scope of base_node, where $testname is undefined.</p>

<p>Node inheritance is currently only really useful for inheriting
static or self-contained classes, and is, as a result, of quite
limited value.</p>

<p>A workaround is to define classes for your node types - essentially
include classes rather than inheriting them. For example:</p>

<pre><code>class test_class {
    file { "/tmp/puppet-test.variable":
       content =&gt; "$testname",
       ensure =&gt; present,
    }
}

class base_node_class {
    include test_class
}

node my_node {
    $testname = 'my_node'
    include base_node_class
}
</code></pre>

<p>/tmp/puppet-test.variable will now contain &#8216;my_node&#8217; as desired.</p>

<h3 id="class-inheritance-and-variable-scope">Class Inheritance and Variable Scope</h3>

<p>The following would also not work as generally expected:</p>

<pre><code>class base_class {
    $myvar = 'bob'
    file {"/tmp/testvar":
         content =&gt; "$myvar",
         ensure =&gt; present,
    }
}

class child_class inherits base_class {
    $myvar = 'fred'
}
</code></pre>

<p>The /tmp/testvar file would be created with the content &#8216;bob&#8217;, as
this is the value of $myvar where the type is defined.</p>

<p>A workaround would be to &#8216;include&#8217; the base_class, rather than
inheriting it, and also to strip the $myvar out of the included
class itself (otherwise it will cause a variable scope conflict -
$myvar would be set twice in the same child_class scope):</p>

<pre><code>$myvar = 'bob'

class base_class {
    file {"/tmp/testvar":
         content =&gt; "$myvar",
         ensure =&gt; present,
    }
}

class child_class {
    $myvar = 'fred'
    include base_class
}
</code></pre>

<p>In some cases you can reset the content of the file resource so
that the scope used for the content (e.g., template) is rebound.
Example:</p>

<pre><code>class base_class {
    $myvar = 'bob'
    file { "/tmp/testvar":
         content =&gt; template("john.erb"),
    }
}

class child_class inherits base_class {
    $myvar = 'fred'
    File["/tmp/testvar"] { content =&gt; template("john.erb") }
}
</code></pre>

<p>(john.erb contains a reference like &lt;%= myvar %&gt;.)</p>

<p>To avoid the duplication of the template filename, it is better to
sidestep the problem altogether with a define:</p>

<pre><code>class base_class {
    define testvar_file($myvar="bob") {
         file { $name:
             content =&gt; template("john.erb"),
         }
    }
    testvar_file { "/tmp/testvar": }
}

class child_class inherits base_class {
    Base_class::Testvar_file["/tmp/testvar"] { myvar =&gt; fred }
}
</code></pre>

<p>Whilst not directly solving the problem also useful are qualified
variables that allow you to refer to variables from
other classes. Qualified variables might provoke alternate methods
of solving this issue. You can use qualified methods like:</p>

<pre><code>class foo {
    $foovariable = "foobar"
}

class bar {
    $barvariable = $foo::foovariable
}
</code></pre>

<p>In this example the value of the of the $barvariable variable in
the bar class will be set to foobar the value of the $foovariable
variable which was set in the foo class.</p>

<h2 id="custom-type--provider-development">Custom Type &amp; Provider development</h2>

<h3 id="err-could-not-retrieve-catalog-invalid-parameter-foo-for-type-bar">err: Could not retrieve catalog: Invalid parameter &#8216;foo&#8217; for type &#8216;bar&#8217;</h3>

<p>When you are developing new custom types, you should restart both
the puppet master and the puppet agent before running the configuration
using the new custom type. The pluginsync feature will then
synchronise the files and the new code will be loaded when both
daemons are restarted.</p>


              <blockquote><p style="font-size: 1.3em; text-align: center;"><a href="#content">↑ Back to top</a></p></blockquote>
            </div>
            <div class="secondary-content">
                  <div id="subCol">
                      <h3 class="chapter">Contents</h3>

<ol class="toc">
  <li class="toc-lv2"><a href="#general">General</a>
<ol class="toc">
   <li class="toc-lv3"><a href="#my-catalog-wont-compile-andor-my-code-is-behaving-unpredictably">My Catalog Won&#8217;t Compile and/or My Code is Behaving Unpredictably</a></li>
   <li class="toc-lv3"><a href="#why-hasnt-my-new-node-configuration-been-noticed">Why hasn&#8217;t my new node configuration been noticed?</a></li>
   <li class="toc-lv3"><a href="#why-dont-my-certificates-show-as-waiting-to-be-signed-on-my-server-when-i-do-a-puppet-cert---list">Why don&#8217;t my certificates show as waiting to be signed on my server when I do a &#8220;puppet cert --list&#8221;?</a></li>
   <li class="toc-lv3"><a href="#i-keep-getting-certificates-were-not-trusted-whats-wrong">I keep getting &#8220;certificates were not trusted&#8221;. What&#8217;s wrong?</a></li>
   <li class="toc-lv3"><a href="#agents-are-failing-with-a-hostname-was-not-match-with-the-server-certificate-error-whats-wrong">Agents are failing with a &#8220;hostname was not match with the server certificate&#8221; error; what&#8217;s wrong?</a></li>
   <li class="toc-lv3"><a href="#im-getting-ipv6-errors-whats-wrong">I&#8217;m getting IPv6 errors; what&#8217;s wrong?</a></li>
   <li class="toc-lv3"><a href="#im-getting-tlsv1-alert-unknown-ca-errors-whats-wrong">I&#8217;m getting tlsv1 alert unknown ca errors; what&#8217;s wrong?</a></li>
   <li class="toc-lv3"><a href="#why-does-puppet-keep-trying-to-start-a-running-service">Why does Puppet keep trying to start a running service?</a></li>
   <li class="toc-lv3"><a href="#why-is-my-external-node-configuration-failing-i-get-no-errors-by-running-the-script-by-hand">Why is my external node configuration failing? I get no errors by running the script by hand.</a></li>
</ol></li>
  <li class="toc-lv2"><a href="#puppet-syntax-errors">Puppet Syntax Errors</a>
<ol class="toc">
   <li class="toc-lv3"><a href="#syntax-error-at--expected--at-manifestppnnn">Syntax error at &#8216;}&#8217;; expected &#8216;}&#8217; at manifest.pp:nnn</a></li>
   <li class="toc-lv3"><a href="#syntax-error-at--expected--at-manifestppnnn-1">Syntax error at &#8216;:&#8217;; expected &#8216;]&#8217; at manifest.pp:nnn</a></li>
   <li class="toc-lv3"><a href="#syntax-error-at--expected--at-manifestppnnn-2">Syntax error at &#8216;.&#8217;; expected &#8216;}&#8217; at manifest.pp:nnn</a></li>
   <li class="toc-lv3"><a href="#could-not-match-definename-at-manifestppnnn-on-node-nodename">Could not match &#8216;_define_name&#8217; at manifest.pp:nnn on node nodename</a></li>
   <li class="toc-lv3"><a href="#duplicate-definition-classnamedefinenamesystem-is-already-defined-in-file-manifestpp-at-line-nnn-cannot-redefine-at-manifestppnnn-on-node-nodename">Duplicate definition: Classname::Define_name[system] is already defined in file manifest.pp at line nnn; cannot redefine at manifest.pp:nnn on node nodename</a></li>
   <li class="toc-lv3"><a href="#syntax-error-at--expected-">Syntax error at &#8216;=&gt;&#8217;; expected &#8216;)&#8217;</a></li>
   <li class="toc-lv3"><a href="#syntax-error-at--expected--1">Syntax error at &#8216;&#171;|&#8217;; expected &#8216;|&#187;&#8217;</a></li>
   <li class="toc-lv3"><a href="#err-exported-resource-blahsometitle-cannot-override-local-resource-on-node-nodename">err: Exported resource Blah[$some_title] cannot override local resource on node $nodename</a></li>
</ol></li>
  <li class="toc-lv2"><a href="#common-misconceptions">Common Misconceptions</a>
<ol class="toc">
   <li class="toc-lv3"><a href="#node-inheritance-and-variable-scope">Node Inheritance and Variable Scope</a></li>
   <li class="toc-lv3"><a href="#class-inheritance-and-variable-scope">Class Inheritance and Variable Scope</a></li>
</ol></li>
  <li class="toc-lv2"><a href="#custom-type--provider-development">Custom Type &amp; Provider development</a>
<ol class="toc">
   <li class="toc-lv3"><a href="#err-could-not-retrieve-catalog-invalid-parameter-foo-for-type-bar">err: Could not retrieve catalog: Invalid parameter &#8216;foo&#8217; for type &#8216;bar&#8217;</a></li>
</ol></li>
</ol>
                      <div style="margin-top: 1.5em; padding-bottom: 10px;">
                          <p style="font-family: 'Lucida Grande',Lucida,Verdana,sans-serif;font-size: 16px; font-weight: bold; line-height: 22px; margin-bottom: 10px;">Download the Docs</p>
                          <a href="http://info.puppetlabs.com/download-pdfs.html"><img src="./../images/smallbits_small_docs.png" alt="Puppet docs download"></a>
                      </div>
                      <div style="margin-top: 0; padding-bottom: 10px;">
                          <p style="font-family: 'Lucida Grande',Lucida,Verdana,sans-serif;font-size: 16px; font-weight: bold; line-height: 22px; margin-bottom: 10px;">Download Puppet Enterprise</p>
                          <a href="http://info.puppetlabs.com/download-pe.html"><img src="./../images/puppet_cert_home.jpg" alt="Puppet Enterprise promo"></a>
                      </div>
                  </div>
            </div>
          </div>
        </div>
      </section>

		<footer id="footer">
      <div class="site-width">

        <div class="primary-secondary-content">
          <div class="primary-content">
            <section id="newsletter">
                 <h4>Puppet Labs is Hiring</h4>
                 <p><a href="http://www.puppetlabs.com/company/jobs/">Engineers, developers & consultants</a>
                  <p>
		<h4>Newsletter</h4>

              <p>Stay up to date on all things puppet</p>

				<form class="lpeRegForm formNotEmpty" method="post" enctype="application/x-www-form-urlencoded" action="http://info.puppetlabs.com/index.php/leadCapture/save"; id="mktForm_1013" name="mktForm_1013">

				<label>Email Address:</label><span class='mktInput'><input class='mktFormText mktFormEmail' name="Email" id="Email" type='text' value="" maxlength='255'  /><span class='mktFormMsg'></span></span>

				<input id='mktFrmSubmit' type='submit' class='btn' style="width: auto; overflow: visible; padding-left: .25em; padding-right: .25em;" value='Subscribe' name='submitButton' onclick='formSubmit(document.getElementById("mktForm_1013")); return false;' />

				<input style='display: none;' id='mktFrmReset' type='reset' value='Clear' name='resetButton' onclick='formReset(document.getElementById("mktForm_1013")); return false;' />

				<span style="display:none;"><input type="text" name="_marketo_comments" value="" /></span>
				<input type="hidden" name="lpId" value="-1" />
				<input type="hidden" name="subId" value="100" />

				<input type="hidden" name="kw" value="" />
				<input type="hidden" name="cr" value="" />

				<input type="hidden" name="searchstr" value="" />
				<input type="hidden" name="lpurl" value="http://info.puppetlabs.com/testsubscription.html?cr={creative}&kw={keyword}"; />
				<input type="hidden" name="formid" value="1013" />
				<input type="hidden" name="returnURL" value="http://www.puppetlabs.com/misc/subscription-thank-you/"; />
				<input type="hidden" name="retURL" value="http://www.puppetlabs.com/misc/subscription-thank-you/"; />
				<input type="hidden" name="_mkt_disp" value="return" />
				<input type="hidden" name="_mkt_trk" value="" />

				</form>
				<script type="text/javascript" src="http://info.puppetlabs.com/js/mktFormSupport.js"></script>

				<script type="text/javascript">
				function formSubmit(elt) {
				return Mkto.formSubmit(elt);
				}
				function formReset(elt) {
				return Mkto.formReset(elt);
				}
				</script>

<a href="http://info.puppetlabs.com/puppet-enterprise" class="fbtn">Try Puppet Enterprise FREE</a>

            </section>
            <section id="elsewhere">
              <h4>Get Involved</h4>
              <ul>

                <li class="chat"><a href="http://webchat.freenode.net/?channels=puppet" rel="external"><span class="indicator"></span><span>Chat with us on IRC</span></a></li>
		<li class="discussion"><a href="http://groups.google.com/group/puppet-dev" rel="external"><span class="indicator"></span><span>Join the Puppet Developer List</span></a></li>
                <li class="discussion"><a href="http://groups.google.com/group/puppet-users?pli=1" rel="external"><span class="indicator"></span><span>Join the Puppet User List</span></a></li>

                <li class="linkedin"><a href="http://www.linkedin.com/groups?about=&gid=696467&trk=anet_ug_grppro" rel="external"><span class="indicator"></span><span>Join the Puppet Users LinkedIn group</span></a></li>

              </ul>
		<p>
		              		<h4>Follow us&#8230;</h4>

              		<ul class="followus">


			<li><a href="http://feeds.feedburner.com/PuppetLabs" target="_blank"><img src="http://www.puppetlabs.com/wp-content/plugins/my-profiles/images/rss.png" border="0"></a></li>
			<li><a href="http://www.facebook.com/pages/Puppet-Labs/219089920711" target="_blank"><img src="http://www.puppetlabs.com//wp-content/plugins/my-profiles/images/facebook.png" border="0"></a></li>
			<li><a href="http://www.twitter.com/puppetlabs" target="_blank"><img src="http://www.puppetlabs.com//wp-content/plugins/my-profiles/images/twitter.png" border="0"></a></li>
			<li><a href="http://www.linkedin.com/groups?about=&amp;gid=696467&amp;trk=anet_ug_grppro" target="_blank"><img src="http://www.puppetlabs.com//wp-content/uploads/2011/01/LinkedIn_IN_Icon_32px.png" border="0"></a></li>    <li><a href="https://github.com/puppetlabs" target="_blank"><img src="http://www.puppetlabs.com//wp-content/uploads/2011/01/github_icon.png" border="0"></a></li>
			<li><a href="https://plus.google.com/112682055028218091774?rel=author" target="_blank"><img src="https://puppetlabs.com/wp-content/uploads/2013/05/google_plus32x32.png" alt="Find Us on Google+" border="0"></a></li>
					</ul>

              	</p>

            </section>
          </div>
          <div class="secondary-content">
            <section id="book-it">
              <h4>Get the book!</h4>

              <p>James Turnbull and Jeff McCune's book <a href="http://www.apress.com/9781430230571" rel="nofollow">Pro Puppet</a> is a comprehensive and up-to-date look at Puppet and MCollective. </p>
              <a href="http://www.apress.com/9781430230571" rel="nofollow"><img src="http://www.puppetlabs.com/wp-content/uploads/2011/05/propuppetthumb.png" /></a>
            </section>
          </div>
        </div>
      </div>
		</footer>

    <div id="copyright">
      <div class="site-width">
        &copy; 2011 <a href="http://www.puppetlabs.com/" title="Puppet Labs">Puppet Labs</a>
        <span class="vcard">
         <span class="org"></span>
         <a class="email" href="mailto:info@puppetlabs.com">info@puppetlabs.com</a>

          <span class="adr">
           <span class="street-address">926 NW 13th Avenue #210</span>
           /
           <span class="locality">Portland</span>,
           <span class="region">OR</span>
           <span class="postal-code">97209</span>

          </span>

         <span class="tel">1-877-575-9775</span>
        </span>
      </div>
    </div>

  	<script type="text/javascript">Cufon.now();</script>
  	<style type="text/css">h1, h2, .btn { visibility : visible; }</style>

	</body>
</html>
