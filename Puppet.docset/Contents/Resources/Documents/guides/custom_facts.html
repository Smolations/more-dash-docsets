<!DOCTYPE html>
<html dir="ltr" lang="en-US">
  <head>
  	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  	<title>Custom Facts — Documentation — Puppet Labs</title>
  	<link rel="alternate" type="application/atom+xml" title="Puppet Labs Documentation Updates" href="https://github.com/puppetlabs/puppet-docs/commits/master.atom">
    <link rel="alternate" type="application/atom+xml" title="Puppet Labs Blog Feed" href="http://puppetlabs.com/feed/atom/">
    <link rel='index' title='Puppet Labs Documentation' href='http://docs.puppetlabs.com' />
    <link rel='icon' href='./../favicon.ico' />

  <meta name="description" content="Custom FactsExtend facter by writing your own custom facts to provide information to Puppet.Ruby FactsAdding Custom Facts to FacterSometimes you ne...">




    <!-- FIXME: absolute paths -->

    <script type='text/javascript' src='./../files/javascripts/html5.js'></script>
    <script type='text/javascript' src='./../files/javascripts/jquery-1.3.2.min.js'></script>
    <script type='text/javascript' src='./../files/javascripts/drop_down.js'></script>
    <script type='text/javascript' src='./../files/javascripts/cufon-yui.js'></script>
    <script type='text/javascript' src='./../files/fonts/Klavika_400-Klavika_600.font.js'></script>
    <script type='text/javascript' src='./../files/javascripts/ampersands.js'></script>
    <script type="text/javascript" src="http://puppetlabs.com/wp-content/themes/puppetlabs/javascripts/leadcapture.js"></script>

    <!-- All in One SEO Pack 1.6.10.1 by Michael Torbert of Semper Fi Web Design[127,146] -->
    <meta name="keywords" content="Puppet, puppet labs, reductive labs, open source, system administrator, ruby, data center, automation, support" />
    <!-- /all in one seo pack -->

    <!-- Give us the option of setting a canonical URL in yaml frontmatter -NF -->
    <link rel="canonical" href="http://docs.puppetlabs.com/guides/custom_facts.html" />

    <!-- FIXME: absolute paths -->

    <link rel="stylesheet" type="text/css" href="./../files/stylesheets/style_legacy.css" media="screen">
    <link rel="stylesheet" type="text/css" href="./../files/stylesheets/syntax.css" media="screen"> <!-- index -->
    <link rel="stylesheet" type="text/css" href="./../files/stylesheets/adbanner.css" media="screen">

    <!--[if IE 7]>
	  <link rel="stylesheet" type="text/css" href="./../files/stylesheets/ie_7.css" media="screen"> <!-- index -->
    <![endif]-->

    <!--[if IE 8]>
	    <link rel="stylesheet" type="text/css" href="./../files/stylesheets/ie_8.css" media="screen"> <!-- index -->
    <![endif]-->

  	<script type="text/javascript">
      Cufon.replace('h1, h2', { fontWeight: '600' });
  	</script>
</head>




  <body id="puppetlabsdocs" class="docs">
  <style type="text/css">h1, h2{ visibility : hidden }</style>
  <!--[if IE 8]>
    <style type="text/css">h1, h2{ visibility : visible }</style>
  <![endif]-->

  	<header id="header">
      <div class="site-width">
    		<h1><a href="http://puppetlabs.com/"><span>Puppet Labs</span></a></h1>
        <a class="screen-reader-content" href="#content">Skip navigation</a>
        <nav>
    		<ul id="global-navigation">
          <li id="puppet-tab" class="with-submenu">
            <a href="http://puppetlabs.com/puppet/puppet-enterprise">
              <span>Products</span>
              <span class="drop-down-trigger"></span>
            </a>
            <ul>
			<li>
                <ul>
                   <a href="http://puppetlabs.com/puppet/what-is-puppet/">What is Puppet?</a>
                </ul>
              </li>
			       <li>
                <ul>
                   <a href="http://puppetlabs.com/puppet/puppet-enterprise/">Puppet Enterprise</a>
                </ul>
              </li>
            <li>
                <ul>
                   <a href="http://puppetlabs.com/puppet/whats-new/">What's New in 2.5</a>
                </ul>
              </li>
            <li>
                <ul>
                   <a href="http://puppetlabs.com/puppet/puppet-open-source/">Puppet Open Source</a>
                </ul>
              </li>
            <li>
                <ul>
                   <a href="http://puppetlabs.com/puppet/enterprise-vs-open-source/">Enterprise vs. Open Source</a>
                </ul>
              </li>
              <li>
                <ul>
                  <a href="http://forge.puppetlabs.com">Puppet Forge</a>
                </ul>
              </li>
              <li>
                <ul>
                  <a href="http://puppetlabs.com/puppet/requirements/">Components &amp; Requirements</a>
                </ul>
              </li>
              <li>
                <ul>
                  <a href="http://puppetlabs.com/puppet/faq/">FAQ</a>
                </ul>
              </li>
			  <li>
                <ul>
                  <a href="http://puppetlabs.com/puppet/how-to-buy/">How to Buy</a>
                </ul>
              </li>
            </ul>
          </li>
          <li id="solutions-tab" class="with-submenu">
            <a href="http://puppetlabs.com/solutions/">
              <span>Solutions</span>
              <span class="drop-down-trigger"></span>
            </a>
            <ul>
              <li class="page_item page-item-12296"><a href="http://puppetlabs.com/solutions/configuration-management/">Configuration Management</a></li>
<li class="page_item page-item-986"><a href="http://puppetlabs.com/solutions/virtualization-management/">Virtualization Management</a></li>
<li class="page_item page-item-993"><a href="http://puppetlabs.com/solutions/cloud-management/">Cloud Management</a></li>
<li class="page_item page-item-996"><a href="http://puppetlabs.com/solutions/it-compliance/">IT Compliance</a></li>
<li class="page_item page-item-9520"><a href="http://puppetlabs.com/solutions/devops/">DevOps</a></li>
<li class="page_item page-item-991"><a href="http://puppetlabs.com/solutions/manage-os-x-resources/">OS X Desktops</a></li>
            </ul>
          </li>
          <li id="services-tab" class="with-submenu">
            <a href="http://puppetlabs.com/services/">
              <span>Services</span>
              <span class="drop-down-trigger"></span>
            </a>
            <ul>
              <li class="page_item page-item-783"><a href="http://puppetlabs.com/services/overview/">Overview</a></li>
<li class="page_item page-item-1052"><a href="http://puppetlabs.com/services/customer-support/">Customer Support</a></li>
<li class="page_item page-item-11022"><a href="http://puppetlabs.com/services/support-plans/">Support Plans</a></li>
<li class="page_item page-item-845"><a href="http://puppetlabs.com/services/training-workshops/">On-Site Education</a></li>
<li class="page_item page-item-4899"><a href="http://puppetlabs.com/services/consulting/">Professional Services</a></li>
<li class="page_item page-item-849"><a href="http://puppetlabs.com/category/events/upcoming/">Events &amp; Workshops</a></li>
<li class="page_item page-item-851"><a href="http://puppetlabs.com/services/partners/">Partners</a></li>
            </ul>
          </li>
                    <li id="resources-tab" class="with-submenu">
            <a href="http://puppetlabs.com/resources/">
              <span>Resources</span>
              <span class="drop-down-trigger"></span>
            </a>
            <ul>
              <li class="page_item page-item-1048"><a href="http://puppetlabs.com/resources/overview-2/">Overview</a></li>
<li class="page_item page-item-1040"><a href="http://docs.puppetlabs.com">Documentation</a></li>
<li class="page_item page-item-872"><a href="http://info.puppetlabs.com/register-download">Downloads</a></li>
<li class="page_item page-item-1961"><a href="http://forge.puppetlabs.com">Puppet Forge</a></li>
<li class="page_item page-item-835"><a href="http://info.puppetlabs.com/download-whitepapers.html">White Papers</a></li>
<li class="page_item page-item-1967"><a href="http://projects.puppetlabs.com/projects/puppet/wiki">Wiki</a></li>
<li class="page_item page-item-7279"><a href="http://puppetlabs.com/resources/webinars/">Upcoming Webinars</a></li>
<li class="page_item page-item-10183"><a href="http://puppetlabs.com/resources/newsletter/">Newsletter</a></li>
<li class="page_item page-item-12263"><a href="http://puppetlabs.com/resources/tech-notes/">Tech Notes</a></li>
<li class="page_item page-item-10265"><a href="http://info.puppetlabs.com/pe2-webinar.html">Webinars</a></li>
            </ul>
          </li>

          <li id="customers-tab" class="with-submenu">
            <a href="http://puppetlabs.com/customers/companies/">
              <span>Customers</span>
              <span class="drop-down-trigger"></span>
            </a>
            <ul>
			<li>
                <ul>
                  <a href="http://puppetlabs.com/customers/companies/">Companies</a>
                </ul>
              </li>
			  <li>
                <ul>
                  <a href="http://puppetlabs.com/customers/case-studies/">Case Studies</a>
                </ul>
              </li>
			  <li>
                <ul>
                  <a href="http://puppetlabs.com/customers/product-testimonials/">Product Testimonials</a>
                </ul>
              </li>
			    <li>
                <ul>
                  <a href="http://puppetlabs.com/customers/what-customers-are-saying/">Service Testimonials</a>
                </ul>
              </li>
            </ul>
          </li>
          <li id="community-tab" class="with-submenu">
            <a href="http://puppetlabs.com/community/">
              <span>Community</span>
              <span class="drop-down-trigger"></span>
            </a>

 <ul>
			<li>
                <ul>
                  <a href="http://puppetlabs.com/community/overview/">Overview</a>
                </ul>
              </li>
			<li>
                <ul>
                  <a href="http://puppetlabs.com/blog">Blog</a>
                </ul>
              </li>
			  <li>
                <ul>
                  <a href="http://puppetlabs.com/community/puppet-camp/">Puppet Camp</a>
                </ul>
              </li>
			  <li>
                <ul>
                  <a href="http://puppetlabs.com/community/user-groups-and-devops-groups/">Puppet User Groups & DevOps Groups</a>
                </ul>
              </li>
	          <li>
                <ul>
                  <a href="http://puppetlabs.com/community/presentations/">Presentations</a>
                </ul>
              </li>
			    <li>
                <ul>
                  <a href="http://puppetlabs.com/community/videos/">Videos</a>
                </ul>
              </li>

            </ul>

          <li id="company-tab" class="with-submenu">
            <a href="http://puppetlabs.com/company/">
              <span>Company</span>
              <span class="drop-down-trigger"></span>
            </a>
            <ul>
              <li class="page_item page-item-2316"><a href="http://puppetlabs.com/company/overview/">Overview</a></li>
<li class="page_item page-item-2179"><a href="http://puppetlabs.com/company/news/">News</a>
<ul class='children'>
	<li class="page_item page-item-2338"><a href="http://puppetlabs.com/company/news/press-releases/">Press Releases</a></li>
	<li class="page_item page-item-2383"><a href="http://puppetlabs.com/company/news/media-kit/">Media Kit</a></li>
</ul>
</li>
<li class="page_item page-item-1571"><a href="http://puppetlabs.com/company/careers/">Careers</a></li>
<li class="page_item page-item-10372"><a href="http://puppetlabs.com/company/management/">Management</a></li>
<li class="page_item page-item-10311"><a href="http://puppetlabs.com/company/board-and-advisors/">Board and Advisors</a></li>
<li class="page_item page-item-10367"><a href="http://puppetlabs.com/company/investors/">Investors</a></li>
<li class="page_item page-item-2313"><a href="http://puppetlabs.com/company/contact-us/">Contact Us</a></li>
<li class="page_item page-item-10579"><a href="http://puppetlabs.com/company/awards/">Awards</a></li>
            </ul>
          </li>
    		</ul>
          <div id="misc-navigation">
			  <ul>
				<li><a href="http://puppetlabs.com/security/">Security</a></li>
				<li><a href="http://docs.puppetlabs.com">Documentation</a></li>
				<li><a href="http://puppetlabs.com/resources/customer-support/">Support</a></li>
			        <li><a href="http://projects.puppetlabs.com/">Bug Tracker</a></li>
				<li><a href="http://puppetlabs.com/company/contact/contact-us">Contact Us</a></li>
				<li><a href="http://info.puppetlabs.com/download-pe2.html" class="gateway">Download</a></li>
			  </ul>
			<form action="http://www.google.com/cse" id="cse-search-box">
			  <div>
				<input type="hidden" name="cx" value="017668764424496204839:ubligvgbenm" />
				<input type="hidden" name="ie" value="UTF-8" />
				<input type="text" name="q" class="gsc-input" size="31" />
				<input type="submit" name="sa" class="searchbtn" value="Search" />
			  </div>
			</form>
			<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&lang=en"></script>
          </div>
      </nav>
    	</div>
    </header>

      <section id="masthead">
        <div class="site-width">
          <h1>Docs: <span class="section-name">Custom Facts</span></h1>
          <ul id="doc-navigation">
            <li><a href="./../index.html">Docs Home</a></li>
            <li class="with-submenu">
              <a href="#">
                <span>Quick Nav</span>
                <span class="drop-down-trigger"></span>
              </a>
               <!-- the following links can't be relative, unfortunately -->
               <!-- future: add some JS to disable this if running from file:// -->
                               <dl>
                  <dt>Puppet Documentation</dt>
                      <dd><a href="./../puppet/3/reference/index.html">Puppet 3 Reference Manual</a></dd>
                      <dd><a href="./../puppet/2.7/reference/index.html">Puppet 2.7 Reference Manual</a></dd>
                      <dd><a href="./../pe/latest/index.html">Puppet Enterprise User's Guide</a></dd>
                      <dd><a href="./../learning/index.html">Learning Puppet</a></dd>
                      <dd><a href="./../references/latest/type.html">Resource Types</a></dd>
                      <dd><a href="./../references/latest/function.html">Functions</a></dd>
                      <dd><a href="./../references/latest/configuration.html">Configuration</a></dd>
                      <dd><a href="./../references/latest/developer/index.html">Developer</a></dd>
                      <dd><a href="./../references/glossary.html">Glossary of Puppet Terms</a></dd>
                      <dd><a href="./../references/index.html">Older References</a></dd>
                  <dt>Facter</dt>
                      <dd><a href="./../facter/latest/core_facts.html">Core Facts Reference</a></dd>
                  <dt>PuppetDB</dt>
                      <dd><a href="./../puppetdb/1/index.html">PuppetDB 1 Manual</a></dd>
                  <dt>MCollective</dt>
                      <dd><a href="./../mcollective/index.html">Index</a></dd>
                      <dd><a href="./../mcollective/reference/index.html">References</a></dd>
                      <dd><a href="./../mcollective/simplerpc/index.html">Writing Plugins</a></dd>
                      <dd><a href="./../mcollective/releasenotes.html">Release Notes</a></dd>
                </dl>

            </li>
            <li><a href="./../contribute.html">Contribute</a></li>
          </ul>
        </div>
        <br />
      </section>

      <section id="content">
        <div class="site-width">
          <div class="primary-secondary-content">
            <div class="primary-content">
              <h1 id="custom-facts">Custom Facts</h1>

<p>Extend facter by writing your own custom facts to provide information to Puppet.</p>

<hr />

<h2 id="ruby-facts">Ruby Facts</h2>

<h2 id="adding-custom-facts-to-facter">Adding Custom Facts to Facter</h2>

<p>Sometimes you need to be able to write conditional expressions
based on site-specific data that just isn&#8217;t available via Facter (or use
a variable in a template that isn&#8217;t there).
A solution can be achieved by adding a new fact to Facter. These additional facts
can then be distributed to Puppet clients and are available for use
in manifests.</p>

<h2 id="the-concept">The Concept</h2>

<p>You can add new facts by writing a snippet of Ruby code on the
Puppet master. We then use <a href="./plugins_in_modules.html">Plugins In Modules</a> to distribute our
facts to the client.</p>

<h2 id="an-example">An Example</h2>

<p>Let&#8217;s say we need to get the output of uname -i to single out a
specific type of workstation. To do these we create a fact. We
start by giving the fact a name, in this case, <code>hardware_platform</code>,
and create our new fact in a file, <code>hardware_platform.rb</code>, on the
Puppet master server:</p>

<pre><code># hardware_platform.rb

Facter.add("hardware_platform") do
  setcode do
    Facter::Util::Resolution.exec('/bin/uname -i')
  end
end
</code></pre>

<blockquote>
  <p><strong>Note:</strong> Prior to Facter 1.5.8, values returned by <code>Facter::Util::Resolution.exec</code> often had trailing newlines. If your custom fact will also be used by older versions of Facter, you may need to call <code>chomp</code> on these values. (In the example above, this would look like <code>Facter::Util::Resolution.exec('/bin/uname -i').chomp</code>.)</p>
</blockquote>

<p>We then use the instructions in <a href="./plugins_in_modules.html">Plugins In Modules</a> page to copy
our new fact to a module and distribute it. During your next Puppet
run the value of our new fact will be available to use in your
manifests.</p>

<p>The best place to get ideas about how to write your own custom facts is to look at the existing Facter fact code. You will find lots of examples of how to interpret different types of system data and return useful facts.</p>

<h2 id="using-other-facts">Using other facts</h2>

<p>You can write a fact which uses other facts by accessing
Facter.value(&#8220;somefact&#8221;) or simply Facter.somefact. The former will
return nil for unknown facts, the latter will raise an exception.
An example:</p>

<pre><code>Facter.add("osfamily") do
  setcode do
    distid = Facter.value('lsbdistid')
    case distid
    when /RedHatEnterprise|CentOS|Fedora/
      "redhat"
    when "ubuntu"
      "debian"
    else
      distid
    end
  end
end
</code></pre>

<h2 id="loading-custom-facts">Loading Custom Facts</h2>

<p>Facter offers a few methods of loading facts:</p>

<ul>
  <li>$LOAD_PATH, or the ruby library load path</li>
  <li>The environment variable &#8216;FACTERLIB&#8217;</li>
  <li>Facts distributed using pluginsync</li>
</ul>

<p>You can use these methods of loading facts do to things like test files locally
before distributing them, or have a specific set of facts available on certain
machines.</p>

<p>Facter will search all directories in the ruby $LOAD_PATH variable for
subdirectories named &#8216;facter&#8217;, and will load all ruby files in those directories.
If you had some directory in your $LOAD_PATH like ~/lib/ruby, set up like
this:</p>

<pre><code>{~/lib/ruby}
└── facter
    ├── rackspace.rb
    ├── system_load.rb
    └── users.rb
</code></pre>

<p>Facter would try to load &#8216;facter/system_load.rb&#8217;, &#8216;facter/users.rb&#8217;, and
&#8216;facter/rackspace.rb&#8217;.</p>

<p>Facter also will check the environment variable <code>FACTERLIB</code> for a colon delimited
set of directories, and will try to load all ruby files in those directories.
This allows you to do something like this:</p>

<pre><code>$ ls my_facts
system_load.rb
$ ls my_other_facts
users.rb
$ export FACTERLIB="./my_facts:./my_other_facts"
$ facter system_load users
system_load =&gt; 0.25
users =&gt; thomas,pat
</code></pre>

<p>Facter can also easily load fact files distributed using pluginsync. Running
<code>facter -p</code> will load all the facts that have been distributed via pluginsync,
so if you&#8217;re using a lot of custom facts inside puppet, you can easily use
these facts with standalone facter.</p>

<p>Custom facts can be distributed to clients using the <a href="./plugins_in_modules.html">Plugins In Modules</a> method.</p>

<h2 id="configuring-facts">Configuring Facts</h2>

<p>Facts have a few properties that you can use to customize how facts are evaluated.</p>

<h3 id="confining-facts">Confining Facts</h3>

<p>One of the more commonly used properties is the <code>confine</code> statement, which
restricts the fact to only run on systems that matches another given fact.</p>

<p>An example of the confine statement would be something like the following:</p>

<pre><code>Facter.add(:powerstates) do
  confine :kernel =&gt; "Linux"
  setcode do
    Facter::Util::Resolution.exec('cat /sys/power/states')
  end
end
</code></pre>

<p>This fact uses sysfs on linux to get a list of the power states that are
available on the given system. Since this is only available on Linux systems,
we use the confine statement to ensure that this fact isn&#8217;t needlessly run on
systems that don&#8217;t support this type of enumeration.</p>

<h3 id="fact-precedence">Fact precedence</h3>

<p>Another property of facts is the <code>weight</code> property. Facts with a higher weight
are run earlier, which allows you to either override or provide fallbacks to
existing facts, or ensure that facts are evaluated in a specific order.
By default, the weight of a fact is the number of confines for that fact, so
that more specific facts are evaluated first.</p>

<pre><code># Check to see if this server has been marked as a postgres server
Facter.add(:role) do
  has_weight 100
  setcode do
    if File.exist? "/etc/postgres_server"
      "postgres_server"
    end
  end
end

# Guess if this is a server by the presence of the pg_create binary
Facter.add(:role) do
  has_weight 50
  setcode do
    if File.exist? "/usr/sbin/pg_create"
      "postgres_server"
    end
  end
end

# If this server doesn't look like a server, it must be a desktop
Facter.add(:role) do
  setcode do
    "desktop"
  end
end
</code></pre>

<h3 id="timing-out">Timing out</h3>

<p>If you have facts that are unreliable and may not finish running, you can use
the <code>timeout</code> property. If a fact is defined with a timeout and the evaluation
of the setcode block exceeds the timeout, Facter will halt the resolution of
that fact and move on.</p>

<pre><code># Sleep
Facter.add(:sleep, :timeout =&gt; 10) do
  setcode do
      sleep 999999
  end
end
</code></pre>

<h2 id="viewing-fact-values">Viewing Fact Values</h2>

<p>[puppetdb]:
If your puppet master(s) are configured to use [PuppetDB][] and/or the <a href="./../guides/inventory_service.html">inventory service</a>, you can view and search all of the facts for any node, including custom facts. See the PuppetDB or inventory service docs for more info.</p>

<h2 id="external-facts">External Facts</h2>

<p><strong>External facts are available only in Facter 1.7 and later.</strong></p>

<h3 id="what-are-external-facts">What are external facts?</h3>

<p>External facts provide a way to use arbitrary executables or scripts as facts, or set facts statically with structured data. If you&#8217;ve ever wanted to write a custom fact in Perl, C, or a one-line text file, this is how.</p>

<h3 id="fact-locations">Fact Locations</h3>

<p>External facts must go in a standard directory. The location of this directory varies depending on whether you&#8217;re using Puppet Enterprise or an open source release of Facter.</p>

<p>On Unix/Linux:</p>

<pre><code>/etc/facter/facts.d/ # Puppet Open Source
/etc/puppetlabs/facter/facts.d/ # Puppet Enterprise
</code></pre>

<blockquote>
  <p><strong>Note:</strong> These directories will not necessarily exist by default; you may need to create them.</p>
</blockquote>

<h3 id="executable-facts-----unix">Executable facts &#8212; Unix</h3>

<p>Executable facts on Unix work by dropping an executable file into the standard
external fact path above.</p>

<p>An example external fact written in Python:</p>

<pre><code>#!/usr/bin/env python
data = {"key1" : "value1", "key2" : "value2" }

for k in data:
        print "%s=%s" % (k,data[k])
</code></pre>

<p>You must ensure that the script has its execute bit set:</p>

<pre><code>chmod +x /etc/facter/facts.d/my_fact_script.py
</code></pre>

<p>For Facter to parse the output, the script must return key/value pairs on
STDOUT in the format:</p>

<pre><code>key1=value1
key2=value2
key3=value3
</code></pre>

<p>Using this format, a single script can return multiple facts.</p>

<h3 id="executable-facts-----windows">Executable facts &#8212; Windows</h3>

<p>Executable facts are not currently supported on Windows.</p>

<h3 id="structured-data-facts">Structured Data Facts</h3>

<p>Facter can parse structured data files stored in the external facts directory and set facts based on their contents.</p>

<p>Structured data files must use one of the supported data types and must have the correct file extension. At the moment, Facter supports the following extensions and data types:</p>

<ul>
  <li>
    <p><code>.yaml</code>: YAML data, in the following format:</p>

    <pre><code>  ---
  key1: val1
  key2: val2
  key3: val3
</code></pre>
  </li>
  <li>
    <p><code>.json</code>: JSON data, in the following format:</p>

    <pre><code>  {
      "key1": "val1",
      "key2": "val2",
      "key3": "val3"
  }
</code></pre>
  </li>
  <li>
    <p><code>.txt</code>: Key value pairs, in the following format:</p>

    <pre><code>  key1=value1
  key2=value2
  key3=value3
</code></pre>
  </li>
</ul>

<p>As with executable facts, structured data files can set multiple facts at once.</p>

<h3 id="troubleshooting">Troubleshooting</h3>

<p>If your external fact is not appearing in Facter&#8217;s output, running
Facter in debug mode should give you a meaningful reason and tell you which file is causing the problem:</p>

<pre><code># facter --debug
</code></pre>

<p>An example would be in cases where a fact returns invalid characters.
Let say you used a hyphen instead of an equals sign in your script <code>test.sh</code>:</p>

<pre><code>#!/bin/bash

echo "key1-value1"
</code></pre>

<p>Running <code>facter --debug</code> should yield a useful error message:</p>

<pre><code>...
Fact file /etc/facter/facts.d/sample.txt was parsed but returned an empty data set
...
</code></pre>

<p>If you are interested in finding out where any bottlenecks are, you can run
Facter in timing mode and it will reflect how long it takes to parse your
external facts:</p>

<pre><code>facter --timing
</code></pre>

<p>The output should look similar to the timing for Ruby facts, but will name external facts with their full paths. For example:</p>

<pre><code>$ facter --timing
kernel: 14.81ms
/usr/lib/facter/ext/abc.sh: 48.72ms
/usr/lib/facter/ext/foo.sh: 32.69ms
/usr/lib/facter/ext/full.json: 104.71ms
/usr/lib/facter/ext/sample.txt: 0.65ms
....
</code></pre>

<h4 id="external-facts-and-stdlib">External Facts and stdlib</h4>

<p>If you find that an external fact does not match what you have configured in your <code>facts.d</code>
directory, make sure you have not defined the same fact using the external facts capabilities
found in the stdlib module.</p>

<h3 id="drawbacks">Drawbacks</h3>

<p>While external facts provide a mostly-equal way to create variables for Puppet, they have a few drawbacks:</p>

<ul>
  <li>An external fact cannot internally reference another fact. However, due to parse order, you can reference an external fact from a Ruby fact.</li>
  <li>External executable facts are forked instead of executed within the same process.</li>
  <li>Although we plan to allow distribution of external facts through Puppet&#8217;s pluginsync capability, this is not yet supported. See <a href="https://projects.puppetlabs.com/issues/9546">ticket #9546</a></li>
</ul>


              <blockquote><p style="font-size: 1.3em; text-align: center;"><a href="#content">↑ Back to top</a></p></blockquote>
            </div>
            <div class="secondary-content">
                  <div id="subCol">
                      <h3 class="chapter">Contents</h3>

<ol class="toc">
  <li class="toc-lv2"><a href="#ruby-facts">Ruby Facts</a></li>
  <li class="toc-lv2"><a href="#adding-custom-facts-to-facter">Adding Custom Facts to Facter</a></li>
  <li class="toc-lv2"><a href="#the-concept">The Concept</a></li>
  <li class="toc-lv2"><a href="#an-example">An Example</a></li>
  <li class="toc-lv2"><a href="#using-other-facts">Using other facts</a></li>
  <li class="toc-lv2"><a href="#loading-custom-facts">Loading Custom Facts</a></li>
  <li class="toc-lv2"><a href="#configuring-facts">Configuring Facts</a>
<ol class="toc">
   <li class="toc-lv3"><a href="#confining-facts">Confining Facts</a></li>
   <li class="toc-lv3"><a href="#fact-precedence">Fact precedence</a></li>
   <li class="toc-lv3"><a href="#timing-out">Timing out</a></li>
</ol></li>
  <li class="toc-lv2"><a href="#viewing-fact-values">Viewing Fact Values</a></li>
  <li class="toc-lv2"><a href="#external-facts">External Facts</a>
<ol class="toc">
   <li class="toc-lv3"><a href="#what-are-external-facts">What are external facts?</a></li>
   <li class="toc-lv3"><a href="#fact-locations">Fact Locations</a></li>
   <li class="toc-lv3"><a href="#executable-facts-----unix">Executable facts &#8212; Unix</a></li>
   <li class="toc-lv3"><a href="#executable-facts-----windows">Executable facts &#8212; Windows</a></li>
   <li class="toc-lv3"><a href="#structured-data-facts">Structured Data Facts</a></li>
   <li class="toc-lv3"><a href="#troubleshooting">Troubleshooting</a></li>
   <li class="toc-lv3"><a href="#drawbacks">Drawbacks</a></li>
</ol></li>
</ol>
                      <div style="margin-top: 1.5em; padding-bottom: 10px;">
                          <p style="font-family: 'Lucida Grande',Lucida,Verdana,sans-serif;font-size: 16px; font-weight: bold; line-height: 22px; margin-bottom: 10px;">Download the Docs</p>
                          <a href="http://info.puppetlabs.com/download-pdfs.html"><img src="./../images/smallbits_small_docs.png" alt="Puppet docs download"></a>
                      </div>
                      <div style="margin-top: 0; padding-bottom: 10px;">
                          <p style="font-family: 'Lucida Grande',Lucida,Verdana,sans-serif;font-size: 16px; font-weight: bold; line-height: 22px; margin-bottom: 10px;">Download Puppet Enterprise</p>
                          <a href="http://info.puppetlabs.com/download-pe.html"><img src="./../images/puppet_cert_home.jpg" alt="Puppet Enterprise promo"></a>
                      </div>
                  </div>
            </div>
          </div>
        </div>
      </section>

		<footer id="footer">
      <div class="site-width">

        <div class="primary-secondary-content">
          <div class="primary-content">
            <section id="newsletter">
                 <h4>Puppet Labs is Hiring</h4>
                 <p><a href="http://www.puppetlabs.com/company/jobs/">Engineers, developers & consultants</a>
                  <p>
		<h4>Newsletter</h4>

              <p>Stay up to date on all things puppet</p>

				<form class="lpeRegForm formNotEmpty" method="post" enctype="application/x-www-form-urlencoded" action="http://info.puppetlabs.com/index.php/leadCapture/save"; id="mktForm_1013" name="mktForm_1013">

				<label>Email Address:</label><span class='mktInput'><input class='mktFormText mktFormEmail' name="Email" id="Email" type='text' value="" maxlength='255'  /><span class='mktFormMsg'></span></span>

				<input id='mktFrmSubmit' type='submit' class='btn' style="width: auto; overflow: visible; padding-left: .25em; padding-right: .25em;" value='Subscribe' name='submitButton' onclick='formSubmit(document.getElementById("mktForm_1013")); return false;' />

				<input style='display: none;' id='mktFrmReset' type='reset' value='Clear' name='resetButton' onclick='formReset(document.getElementById("mktForm_1013")); return false;' />

				<span style="display:none;"><input type="text" name="_marketo_comments" value="" /></span>
				<input type="hidden" name="lpId" value="-1" />
				<input type="hidden" name="subId" value="100" />

				<input type="hidden" name="kw" value="" />
				<input type="hidden" name="cr" value="" />

				<input type="hidden" name="searchstr" value="" />
				<input type="hidden" name="lpurl" value="http://info.puppetlabs.com/testsubscription.html?cr={creative}&kw={keyword}"; />
				<input type="hidden" name="formid" value="1013" />
				<input type="hidden" name="returnURL" value="http://www.puppetlabs.com/misc/subscription-thank-you/"; />
				<input type="hidden" name="retURL" value="http://www.puppetlabs.com/misc/subscription-thank-you/"; />
				<input type="hidden" name="_mkt_disp" value="return" />
				<input type="hidden" name="_mkt_trk" value="" />

				</form>
				<script type="text/javascript" src="http://info.puppetlabs.com/js/mktFormSupport.js"></script>

				<script type="text/javascript">
				function formSubmit(elt) {
				return Mkto.formSubmit(elt);
				}
				function formReset(elt) {
				return Mkto.formReset(elt);
				}
				</script>

<a href="http://info.puppetlabs.com/puppet-enterprise" class="fbtn">Try Puppet Enterprise FREE</a>

            </section>
            <section id="elsewhere">
              <h4>Get Involved</h4>
              <ul>

                <li class="chat"><a href="http://webchat.freenode.net/?channels=puppet" rel="external"><span class="indicator"></span><span>Chat with us on IRC</span></a></li>
		<li class="discussion"><a href="http://groups.google.com/group/puppet-dev" rel="external"><span class="indicator"></span><span>Join the Puppet Developer List</span></a></li>
                <li class="discussion"><a href="http://groups.google.com/group/puppet-users?pli=1" rel="external"><span class="indicator"></span><span>Join the Puppet User List</span></a></li>

                <li class="linkedin"><a href="http://www.linkedin.com/groups?about=&gid=696467&trk=anet_ug_grppro" rel="external"><span class="indicator"></span><span>Join the Puppet Users LinkedIn group</span></a></li>

              </ul>
		<p>
		              		<h4>Follow us&#8230;</h4>

              		<ul class="followus">


			<li><a href="http://feeds.feedburner.com/PuppetLabs" target="_blank"><img src="http://www.puppetlabs.com/wp-content/plugins/my-profiles/images/rss.png" border="0"></a></li>
			<li><a href="http://www.facebook.com/pages/Puppet-Labs/219089920711" target="_blank"><img src="http://www.puppetlabs.com//wp-content/plugins/my-profiles/images/facebook.png" border="0"></a></li>
			<li><a href="http://www.twitter.com/puppetlabs" target="_blank"><img src="http://www.puppetlabs.com//wp-content/plugins/my-profiles/images/twitter.png" border="0"></a></li>
			<li><a href="http://www.linkedin.com/groups?about=&amp;gid=696467&amp;trk=anet_ug_grppro" target="_blank"><img src="http://www.puppetlabs.com//wp-content/uploads/2011/01/LinkedIn_IN_Icon_32px.png" border="0"></a></li>    <li><a href="https://github.com/puppetlabs" target="_blank"><img src="http://www.puppetlabs.com//wp-content/uploads/2011/01/github_icon.png" border="0"></a></li>
			<li><a href="https://plus.google.com/112682055028218091774?rel=author" target="_blank"><img src="https://puppetlabs.com/wp-content/uploads/2013/05/google_plus32x32.png" alt="Find Us on Google+" border="0"></a></li>
					</ul>

              	</p>

            </section>
          </div>
          <div class="secondary-content">
            <section id="book-it">
              <h4>Get the book!</h4>

              <p>James Turnbull and Jeff McCune's book <a href="http://www.apress.com/9781430230571" rel="nofollow">Pro Puppet</a> is a comprehensive and up-to-date look at Puppet and MCollective. </p>
              <a href="http://www.apress.com/9781430230571" rel="nofollow"><img src="http://www.puppetlabs.com/wp-content/uploads/2011/05/propuppetthumb.png" /></a>
            </section>
          </div>
        </div>
      </div>
		</footer>

    <div id="copyright">
      <div class="site-width">
        &copy; 2011 <a href="http://www.puppetlabs.com/" title="Puppet Labs">Puppet Labs</a>
        <span class="vcard">
         <span class="org"></span>
         <a class="email" href="mailto:info@puppetlabs.com">info@puppetlabs.com</a>

          <span class="adr">
           <span class="street-address">926 NW 13th Avenue #210</span>
           /
           <span class="locality">Portland</span>,
           <span class="region">OR</span>
           <span class="postal-code">97209</span>

          </span>

         <span class="tel">1-877-575-9775</span>
        </span>
      </div>
    </div>

  	<script type="text/javascript">Cufon.now();</script>
  	<style type="text/css">h1, h2, .btn { visibility : visible; }</style>

	</body>
</html>
