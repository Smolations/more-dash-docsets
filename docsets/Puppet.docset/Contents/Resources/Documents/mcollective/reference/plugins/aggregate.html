<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-US" xml:lang="en-US">
  <head>
  	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  	<title>Aggregate Plugins &#8212; Documentation &#8212; Puppet Labs</title>
  	<link rel="alternate" type="application/atom+xml" title="Puppet Labs Documentation Updates" href="https://github.com/puppetlabs/puppet-docs/commits/master.atom" />
    <link rel="alternate" type="application/atom+xml" title="Puppet Labs Blog Feed" href="http://puppetlabs.com/feed/atom/" />
    <link rel="index" title="Puppet Labs Documentation" href="http://docs.puppetlabs.com" />
    <link rel="icon" href="./../../../favicon.ico" />


  <meta name="description" content="OverviewMCollective Agents return data and we try to provide as much usable userinterface for free. To aid in this we require agents to have DDL fi..." />



    <!-- FIXME: absolute paths -->

    <script type="text/javascript" src="./../../../files/javascripts/html5.js"></script>
    <script type="text/javascript" src="./../../../files/javascripts/jquery-1.3.2.min.js"></script>
    <script type="text/javascript" src="./../../../files/javascripts/drop_down.js"></script>
    <script type="text/javascript" src="./../../../files/javascripts/cufon-yui.js"></script>
    <script type="text/javascript" src="./../../../files/fonts/Klavika_400-Klavika_600.font.js"></script>
    <script type="text/javascript" src="./../../../files/javascripts/ampersands.js"></script>
    <script type="text/javascript" src="./../../../files/javascripts/navigation-accordion.js"></script>

    <script type="text/javascript" src="http://puppetlabs.com/wp-content/themes/puppetlabs/javascripts/leadcapture.js"></script>

    <!-- All in One SEO Pack 1.6.10.1 by Michael Torbert of Semper Fi Web Design[127,146] -->
    <meta name="keywords" content="Puppet, puppet labs, reductive labs, open source, system administrator, ruby, data center, automation, support" />
    <!-- /all in one seo pack -->

    <!-- Give us the option of setting a canonical URL in yaml frontmatter -NF -->
    <link rel="canonical" href="http://docs.puppetlabs.com/mcollective/reference/plugins/aggregate.html" />

    <!-- FIXME: absolute paths -->

    <link rel="stylesheet" type="text/css" href="./../../../files/stylesheets/style.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="./../../../files/stylesheets/syntax.css" media="screen" /> <!-- index -->
    <link rel="stylesheet" type="text/css" href="./../../../files/stylesheets/adbanner.css" media="screen" />

    <!--[if IE 7]>
	  <link rel="stylesheet" type="text/css" href="/files/stylesheets/ie_7.css" media="screen"> <!-- index -->
    

    <!--[if IE 8]>
	    <link rel="stylesheet" type="text/css" href="/files/stylesheets/ie_8.css" media="screen"> <!-- index -->
    

  	<script type="text/javascript"><![CDATA[
      Cufon.replace('h1, h2', { fontWeight: '600' });
  	]]></script>
</head>




  <body id="puppetlabsdocs" class="docs">
  <style type="text/css"><![CDATA[h1, h2{ visibility : hidden }]]></style>
  <!--[if IE 8]>
    <style type="text/css">h1, h2{ visibility : visible }</style>
  <![endif]-->

  	<header id="header">
      <div class="site-width">
    		<h1><a href="http://puppetlabs.com/"><span>Puppet Labs</span></a></h1>
        <a class="screen-reader-content" href="#content">Skip navigation</a>
        <nav>
    		<ul id="global-navigation">
          <li id="puppet-tab" class="with-submenu">
            <a href="http://puppetlabs.com/puppet/puppet-enterprise">
              <span>Products</span>
              <span class="drop-down-trigger"></span>
            </a>
            <ul>
			<li>
                <ul>
                   <a href="http://puppetlabs.com/puppet/what-is-puppet/">What is Puppet?</a>
                </ul>
              </li>
			       <li>
                <ul>
                   <a href="http://puppetlabs.com/puppet/puppet-enterprise/">Puppet Enterprise</a>
                </ul>
              </li>
            <li>
                <ul>
                   <a href="http://puppetlabs.com/puppet/whats-new/">What's New in 2.5</a>
                </ul>
              </li>
            <li>
                <ul>
                   <a href="http://puppetlabs.com/puppet/puppet-open-source/">Puppet Open Source</a>
                </ul>
              </li>
            <li>
                <ul>
                   <a href="http://puppetlabs.com/puppet/enterprise-vs-open-source/">Enterprise vs. Open Source</a>
                </ul>
              </li>
              <li>
                <ul>
                  <a href="http://forge.puppetlabs.com">Puppet Forge</a>
                </ul>
              </li>
              <li>
                <ul>
                  <a href="http://puppetlabs.com/puppet/requirements/">Components &amp; Requirements</a>
                </ul>
              </li>
              <li>
                <ul>
                  <a href="http://puppetlabs.com/puppet/faq/">FAQ</a>
                </ul>
              </li>
			  <li>
                <ul>
                  <a href="http://puppetlabs.com/puppet/how-to-buy/">How to Buy</a>
                </ul>
              </li>
            </ul>
          </li>
          <li id="solutions-tab" class="with-submenu">
            <a href="http://puppetlabs.com/solutions/">
              <span>Solutions</span>
              <span class="drop-down-trigger"></span>
            </a>
            <ul>
              <li class="page_item page-item-12296"><a href="http://puppetlabs.com/solutions/configuration-management/">Configuration Management</a></li>
<li class="page_item page-item-986"><a href="http://puppetlabs.com/solutions/virtualization-management/">Virtualization Management</a></li>
<li class="page_item page-item-993"><a href="http://puppetlabs.com/solutions/cloud-management/">Cloud Management</a></li>
<li class="page_item page-item-996"><a href="http://puppetlabs.com/solutions/it-compliance/">IT Compliance</a></li>
<li class="page_item page-item-9520"><a href="http://puppetlabs.com/solutions/devops/">DevOps</a></li>
<li class="page_item page-item-991"><a href="http://puppetlabs.com/solutions/manage-os-x-resources/">OS X Desktops</a></li>
            </ul>
          </li>
          <li id="services-tab" class="with-submenu">
            <a href="http://puppetlabs.com/services/">
              <span>Services</span>
              <span class="drop-down-trigger"></span>
            </a>
            <ul>
              <li class="page_item page-item-783"><a href="http://puppetlabs.com/services/overview/">Overview</a></li>
<li class="page_item page-item-1052"><a href="http://puppetlabs.com/services/customer-support/">Customer Support</a></li>
<li class="page_item page-item-11022"><a href="http://puppetlabs.com/services/support-plans/">Support Plans</a></li>
<li class="page_item page-item-845"><a href="http://puppetlabs.com/services/training-workshops/">On-Site Education</a></li>
<li class="page_item page-item-4899"><a href="http://puppetlabs.com/services/consulting/">Professional Services</a></li>
<li class="page_item page-item-849"><a href="http://puppetlabs.com/category/events/upcoming/">Events &amp; Workshops</a></li>
<li class="page_item page-item-851"><a href="http://puppetlabs.com/services/partners/">Partners</a></li>
            </ul>
          </li>
                    <li id="resources-tab" class="with-submenu">
            <a href="http://puppetlabs.com/resources/">
              <span>Resources</span>
              <span class="drop-down-trigger"></span>
            </a>
            <ul>
              <li class="page_item page-item-1048"><a href="http://puppetlabs.com/resources/overview-2/">Overview</a></li>
<li class="page_item page-item-1040"><a href="http://docs.puppetlabs.com">Documentation</a></li>
<li class="page_item page-item-872"><a href="http://info.puppetlabs.com/register-download">Downloads</a></li>
<li class="page_item page-item-1961"><a href="http://forge.puppetlabs.com">Puppet Forge</a></li>
<li class="page_item page-item-835"><a href="http://info.puppetlabs.com/download-whitepapers.html">White Papers</a></li>
<li class="page_item page-item-1967"><a href="http://projects.puppetlabs.com/projects/puppet/wiki">Wiki</a></li>
<li class="page_item page-item-7279"><a href="http://puppetlabs.com/resources/webinars/">Upcoming Webinars</a></li>
<li class="page_item page-item-10183"><a href="http://puppetlabs.com/resources/newsletter/">Newsletter</a></li>
<li class="page_item page-item-12263"><a href="http://puppetlabs.com/resources/tech-notes/">Tech Notes</a></li>
<li class="page_item page-item-10265"><a href="http://info.puppetlabs.com/pe2-webinar.html">Webinars</a></li>
            </ul>
          </li>

          <li id="customers-tab" class="with-submenu">
            <a href="http://puppetlabs.com/customers/companies/">
              <span>Customers</span>
              <span class="drop-down-trigger"></span>
            </a>
            <ul>
			<li>
                <ul>
                  <a href="http://puppetlabs.com/customers/companies/">Companies</a>
                </ul>
              </li>
			  <li>
                <ul>
                  <a href="http://puppetlabs.com/customers/case-studies/">Case Studies</a>
                </ul>
              </li>
			  <li>
                <ul>
                  <a href="http://puppetlabs.com/customers/product-testimonials/">Product Testimonials</a>
                </ul>
              </li>
			    <li>
                <ul>
                  <a href="http://puppetlabs.com/customers/what-customers-are-saying/">Service Testimonials</a>
                </ul>
              </li>
            </ul>
          </li>
          <li id="community-tab" class="with-submenu">
            <a href="http://puppetlabs.com/community/">
              <span>Community</span>
              <span class="drop-down-trigger"></span>
            </a>

 <ul>
			<li>
                <ul>
                  <a href="http://puppetlabs.com/community/overview/">Overview</a>
                </ul>
              </li>
			<li>
                <ul>
                  <a href="http://puppetlabs.com/blog">Blog</a>
                </ul>
              </li>
			  <li>
                <ul>
                  <a href="http://puppetlabs.com/community/puppet-camp/">Puppet Camp</a>
                </ul>
              </li>
			  <li>
                <ul>
                  <a href="http://puppetlabs.com/community/user-groups-and-devops-groups/">Puppet User Groups &amp; DevOps Groups</a>
                </ul>
              </li>
	          <li>
                <ul>
                  <a href="http://puppetlabs.com/community/presentations/">Presentations</a>
                </ul>
              </li>
			    <li>
                <ul>
                  <a href="http://puppetlabs.com/community/videos/">Videos</a>
                </ul>
              </li>
            </ul>

          </li><li id="company-tab" class="with-submenu">
            <a href="http://puppetlabs.com/company/">
              <span>Company</span>
              <span class="drop-down-trigger"></span>
            </a>
            <ul>
              <li class="page_item page-item-2316"><a href="http://puppetlabs.com/company/overview/">Overview</a></li>
<li class="page_item page-item-2179"><a href="http://puppetlabs.com/company/news/">News</a>
<ul class="children">
	<li class="page_item page-item-2338"><a href="http://puppetlabs.com/company/news/press-releases/">Press Releases</a></li>
	<li class="page_item page-item-2383"><a href="http://puppetlabs.com/company/news/media-kit/">Media Kit</a></li>
</ul>
</li>
<li class="page_item page-item-1571"><a href="http://puppetlabs.com/company/careers/">Careers</a></li>
<li class="page_item page-item-10372"><a href="http://puppetlabs.com/company/management/">Management</a></li>
<li class="page_item page-item-10311"><a href="http://puppetlabs.com/company/board-and-advisors/">Board and Advisors</a></li>
<li class="page_item page-item-10367"><a href="http://puppetlabs.com/company/investors/">Investors</a></li>
<li class="page_item page-item-2313"><a href="http://puppetlabs.com/company/contact-us/">Contact Us</a></li>
<li class="page_item page-item-10579"><a href="http://puppetlabs.com/company/awards/">Awards</a></li>
            </ul>
          </li>
    		</ul>
          <div id="misc-navigation">
			  <ul>
				<li><a href="http://puppetlabs.com/security/">Security</a></li>
				<li><a href="http://docs.puppetlabs.com">Documentation</a></li>
				<li><a href="http://puppetlabs.com/resources/customer-support/">Support</a></li>
			        <li><a href="http://projects.puppetlabs.com/">Bug Tracker</a></li>
				<li><a href="http://puppetlabs.com/company/contact/contact-us">Contact Us</a></li>
				<li><a href="http://info.puppetlabs.com/download-pe2.html" class="gateway">Download</a></li>
			  </ul>
			<form action="http://www.google.com/cse" id="cse-search-box">
			  <div>
				<input type="hidden" name="cx" value="017668764424496204839:ubligvgbenm" />
				<input type="hidden" name="ie" value="UTF-8" />
				<input type="text" name="q" class="gsc-input" size="31" />
				<input type="submit" name="sa" class="searchbtn" value="Search" />
			  </div>
			</form>
			<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script>
          </div>
      </nav>
    	</div>
    </header>

      <section id="masthead">
        <div class="site-width">
          <h1>Docs: <span class="section-name">Aggregate Plugins</span></h1>
          <ul id="doc-navigation">
            <li><a href="./../../../index.html">Docs Home</a></li>
            <li class="with-submenu">
              <a href="#">
                <span>Quick Nav</span>
                <span class="drop-down-trigger"></span>
              </a>
               <!-- the following links can't be relative, unfortunately -->
               <!-- future: add some JS to disable this if running from file:// -->
                               <dl>
                  <dt>Puppet Documentation</dt>
                      <dd><a href="./../../../puppet/3/reference/index.html">Puppet 3 Reference Manual</a></dd>
                      <dd><a href="./../../../puppet/2.7/reference/index.html">Puppet 2.7 Reference Manual</a></dd>
                      <dd><a href="./../../../pe/latest/index.html">Puppet Enterprise User's Guide</a></dd>
                      <dd><a href="./../../../learning/index.html">Learning Puppet</a></dd>
                      <dd><a href="./../../../references/latest/type.html">Resource Types</a></dd>
                      <dd><a href="./../../../references/latest/function.html">Functions</a></dd>
                      <dd><a href="./../../../references/latest/configuration.html">Configuration</a></dd>
                      <dd><a href="./../../../references/latest/developer/index.html">Developer</a></dd>
                      <dd><a href="./../../../references/glossary.html">Glossary of Puppet Terms</a></dd>
                      <dd><a href="./../../../references/index.html">Older References</a></dd>
                  <dt>Facter</dt>
                      <dd><a href="./../../../facter/latest/core_facts.html">Core Facts Reference</a></dd>
                  <dt>PuppetDB</dt>
                      <dd><a href="./../../../puppetdb/1/index.html">PuppetDB 1 Manual</a></dd>
                  <dt>MCollective</dt>
                      <dd><a href="./../../../mcollective/index.html">Index</a></dd>
                      <dd><a href="./../../../mcollective/reference/index.html">References</a></dd>
                      <dd><a href="./../../../mcollective/simplerpc/index.html">Writing Plugins</a></dd>
                      <dd><a href="./../../../mcollective/releasenotes.html">Release Notes</a></dd>
                </dl>

            </li>
            <li><a href="./../../../contribute.html">Contribute</a></li>
          </ul>
        </div>
        <br />
      </section>

      <section id="content">
        <div class="site-width">
          <div class="primary-secondary-content">
            <div class="primary-content">
              <h1>Aggregate Plugins</h1>
              <nav class="in-page" id="page-nav">
<ol class="toc">
  <li class="toc-lv2"><a href="#overview">Overview</a></li>
  <li class="toc-lv2"><a href="#using-existing-plugins">Using existing plugins</a>
<ol class="toc">
   <li class="toc-lv3"><a href="#updating-the-ddl">Updating the DDL</a></li>
   <li class="toc-lv3"><a href="#viewing-summaries-on-the-cli">Viewing summaries on the CLI</a></li>
   <li class="toc-lv3"><a href="#producing-summaries-in-your-own-clients">Producing summaries in your own clients</a></li>
   <li class="toc-lv3"><a href="#getting-access-to-the-raw-summary-results">Getting access to the raw summary results</a></li>
</ol></li>
  <li class="toc-lv2"><a href="#writing-your-own-function">Writing your own function</a>
<ol class="toc">
   <li class="toc-lv3"><a href="#startuphook">startup_hook</a></li>
   <li class="toc-lv3"><a href="#processresult">process_result</a></li>
   <li class="toc-lv3"><a href="#summarize">summarize</a></li>
   <li class="toc-lv3"><a href="#deploy-and-update-the-ddl">Deploy and update the DDL</a></li>
</ol></li>
</ol></nav>

<h2 id="overview">Overview</h2>
<p>MCollective Agents return data and we try to provide as much usable user
interface for free. To aid in this we require agents to have <a href="./../../../mcollective/reference/plugins/ddl.html">DDL</a> files that
describe the data that the agent returns.</p>

<p>DDL files are used to configure the client but also to assist with user
interface generation.  They are used to ask questions that an action needs but
also to render the results when the replies come in.  For example we turn
<em>:freecpu</em> into &#8220;Free CPU&#8221; when displaying the data based on the DDL.</p>

<p>Previously if data that agents returned required any summarization this had to
be done using a custom application.  Here is an example from <em>mco nrpe</em>:</p>

<div class="highlight"><pre><code class="console"><span class="gp">%</span> mco nrpe check_load
<span class="go">.</span>
<span class="go">.</span>
<span class="go">Finished processing 25 / 25 hosts in 556.48 ms</span>

<span class="go">              OK: 25</span>
<span class="go">         WARNING: 0</span>
<span class="go">        CRITICAL: 0</span>
<span class="go">         UNKNOWN: 0</span>
</code></pre>
</div>

<p>Here to get the summary of results displayed in a way that has contextual
relevance to the nrpe plugin a custom application had to be written and anyone
who interacts with the agent using other RPC clients would not get the benefit
of this summary.</p>

<p>By using aggregate plugins and updating the DDL we can now provide such a
summary in all result sets and display it using the <em>mco rpc</em> application and
any calls to <em>printrpc</em>.</p>

<div class="highlight"><pre><code class="console"><span class="gp">%</span> mco rpc nrpe runcommand <span class="nb">command</span><span class="o">=</span>check_load
<span class="go">Discovering hosts using the mongo method .... 25</span>

<span class="go"> * [============================================================&gt; ] 25 / 25</span>

<span class="go">Summary of Exit Code:</span>

<span class="go">            OK : 25</span>
<span class="go">       WARNING : 0</span>
<span class="go">       UNKNOWN : 0</span>
<span class="go">      CRITICAL : 0</span>


<span class="go">Finished processing 25 / 25 hosts in 390.70 ms</span>
</code></pre>
</div>

<p>Here you get a similar summary as before, all that had to be done was a simple
aggregate plugin be written and distributed with your clients.</p>

<p>The results are shown as above using <em>printrpcstats</em> but you can also get access to
the raw data so you can decide to render it in some other way - perhaps using a
graph on a web interface.</p>

<p>We provide a number of aggregate plugins with MCollective and anyone can write
more.</p>

<p>For examples that already use functions see the <em>rpcutil</em> agent - its
<em>collective_info</em>, <em>get_fact</em>, <em>daemon_stats</em> and <em>get_config_item</em> actions all
have summaries applied.</p>

<p><em>NOTE:</em> This feature is available since version 2.1.0</p>

<h2 id="using-existing-plugins">Using existing plugins</h2>

<h3 id="updating-the-ddl">Updating the DDL</h3>
<p>At present MCollective supplies 3 plugins <em>average()</em>, <em>summary()</em> and <em>sum()</em>
you can use these in any agent, here is an example from the <em>rpcutil</em> agent DDL
file:</p>

<div class="highlight"><pre><code class="ruby"><span class="n">action</span> <span class="s2">"get_config_item"</span><span class="p">,</span> <span class="ss">:description</span> <span class="o">=&gt;</span> <span class="s2">"Get the active value of a specific config property"</span> <span class="k">do</span>
    <span class="n">output</span> <span class="ss">:value</span><span class="p">,</span>
           <span class="ss">:description</span> <span class="o">=&gt;</span> <span class="s2">"The value that is in use"</span><span class="p">,</span>
           <span class="ss">:display_as</span> <span class="o">=&gt;</span> <span class="s2">"Value"</span>

    <span class="n">summarize</span> <span class="k">do</span>
        <span class="n">aggregate</span> <span class="n">summary</span><span class="p">(</span><span class="ss">:value</span><span class="p">)</span>
    <span class="k">end</span>
<span class="k">end</span>
</code></pre>
</div>

<p>We&#8217;ve removed a few lines from this example DDL block leaving only the relevant
lines.  You can see the agent outputs data called <em>:value</em> and we reference that
output in the summary function <em>summary(:value)</em>, the result would look like
this:</p>

<h3 id="viewing-summaries-on-the-cli">Viewing summaries on the CLI</h3>

<div class="highlight"><pre><code class="console"><span class="gp">%</span> mco rpc rpcutil get_config_item <span class="nv">item</span><span class="o">=</span>collectives
<span class="go">.</span>
<span class="go">.</span>
<span class="go">dev8</span>
<span class="go">   Property: collectives</span>
<span class="go">      Value: ["mcollective", "uk_collective"]</span>

<span class="go">Summary of Value:</span>

<span class="go">      mcollective = 25</span>
<span class="go">    uk_collective = 15</span>
<span class="go">    fr_collective = 9</span>
<span class="go">    us_collective = 1</span>

<span class="go">Finished processing 25 / 25 hosts in 349.70 ms</span>
</code></pre>
</div>

<p>You can see that the value in this case contains arrays, the <em>summary()</em>
function produce the table in the output showing the data distribution.</p>

<h3 id="producing-summaries-in-your-own-clients">Producing summaries in your own clients</h3>
<p>You can enable the same display in your own code, here is ruby code that has the
same affect as the CLI call above:</p>

<div class="highlight"><pre><code class="ruby"><span class="nb">require</span> <span class="s1">'mcollective'</span>

<span class="kp">include</span> <span class="no">MCollective</span><span class="o">::</span><span class="no">RPC</span>

<span class="n">c</span> <span class="o">=</span> <span class="n">rpcclient</span><span class="p">(</span><span class="s2">"rpcutil"</span><span class="p">)</span>

<span class="n">printrpc</span> <span class="n">c</span><span class="o">.</span><span class="n">get_config_item</span><span class="p">(</span><span class="ss">:item</span> <span class="o">=&gt;</span> <span class="s2">"collectives"</span><span class="p">)</span>

<span class="n">printrpcstats</span> <span class="ss">:summarize</span> <span class="o">=&gt;</span> <span class="kp">true</span>
</code></pre>
</div>

<p>Without passing in the <em>:summarize =&gt; true</em> you would not see the summaries</p>

<h3 id="getting-access-to-the-raw-summary-results">Getting access to the raw summary results</h3>
<p>If you wanted to do something else entirely like produce a graph on a web page
of the summaries you can get access to the raw data, here&#8217;s some ruby code to
show all computed summaries:</p>

<div class="highlight"><pre><code class="ruby"><span class="nb">require</span> <span class="s1">'mcollective'</span>

<span class="kp">include</span> <span class="no">MCollective</span><span class="o">::</span><span class="no">RPC</span>

<span class="n">c</span> <span class="o">=</span> <span class="n">rpcclient</span><span class="p">(</span><span class="s2">"rpcutil"</span><span class="p">)</span>
<span class="n">c</span><span class="o">.</span><span class="n">progress</span> <span class="o">=</span> <span class="kp">false</span>

<span class="n">c</span><span class="o">.</span><span class="n">get_config_item</span><span class="p">(</span><span class="ss">:item</span> <span class="o">=&gt;</span> <span class="s2">"collectives"</span><span class="p">)</span>

<span class="n">c</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">aggregate_summary</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">summary</span><span class="o">|</span>
  <span class="nb">puts</span> <span class="s2">"Summary of type: %s"</span> <span class="o">%</span> <span class="n">summary</span><span class="o">.</span><span class="n">result_type</span>
  <span class="nb">puts</span> <span class="s2">"Display format: '%s'"</span> <span class="o">%</span> <span class="n">summary</span><span class="o">.</span><span class="n">aggregate_format</span>
  <span class="nb">puts</span>
  <span class="n">pp</span> <span class="n">summary</span><span class="o">.</span><span class="n">result</span>
<span class="k">end</span>
</code></pre>
</div>

<p>As you can see you will get an array of summaries this is because each DDL can
use many aggregate calls, this would be an array of all the computed summaries:</p>

<div class="highlight"><pre><code class="console"><span class="go">Summary of type: collection</span>
<span class="go">Display format: '%13s = %s'</span>

<span class="go">{:type=&gt;:collection,</span>
<span class="go"> :value=&gt;</span>
<span class="go">  {"mcollective"=&gt;25,</span>
<span class="go">   "fr_collective"=&gt;9,</span>
<span class="go">   "us_collective"=&gt;1,</span>
<span class="go">   "uk_collective"=&gt;15},</span>
<span class="go"> :output=&gt;:value}</span>
</code></pre>
</div>

<p>There are 2 types of result <em>:collection</em> and <em>:numeric</em>, in the case of numeric
results the :value would just be a number.</p>

<p>The <em>aggregate_format</em> is either a user supplied format or a dynamically
computed format to display the summary results on the console.  In this case
each pair of the hash should be displayed using the format to produce a nice
right justified list of keys and values.</p>

<h2 id="writing-your-own-function">Writing your own function</h2>
<p>We&#8217;ll cover writing your own function by looking at the Nagios one from earlier
in this example.  You can look at <a href="https://github.com/puppetlabs/marionette-collective/tree/master/plugins/mcollective/aggregate">the functions supplied with
MCollective</a> for more examples using other types than the one below.</p>

<p>First lets look at the DDL for the existing <em>nrpe</em> Agent:</p>

<div class="highlight"><pre><code class="ruby"><span class="n">action</span> <span class="s2">"runcommand"</span><span class="p">,</span> <span class="ss">:description</span> <span class="o">=&gt;</span> <span class="s2">"Run a NRPE command"</span> <span class="k">do</span>
    <span class="n">input</span> <span class="ss">:command</span><span class="p">,</span>
          <span class="ss">:prompt</span>      <span class="o">=&gt;</span> <span class="s2">"Command"</span><span class="p">,</span>
          <span class="ss">:description</span> <span class="o">=&gt;</span> <span class="s2">"NRPE command to run"</span><span class="p">,</span>
          <span class="ss">:type</span>        <span class="o">=&gt;</span> <span class="ss">:string</span><span class="p">,</span>
          <span class="ss">:validation</span>  <span class="o">=&gt;</span> <span class="s1">'\A[a-zA-Z0-9_-]+\z'</span><span class="p">,</span>
          <span class="ss">:optional</span>    <span class="o">=&gt;</span> <span class="kp">false</span><span class="p">,</span>
          <span class="ss">:maxlength</span>   <span class="o">=&gt;</span> <span class="mi">50</span>

    <span class="n">output</span> <span class="ss">:output</span><span class="p">,</span>
           <span class="ss">:description</span> <span class="o">=&gt;</span> <span class="s2">"Output from the Nagios plugin"</span><span class="p">,</span>
           <span class="ss">:display_as</span>  <span class="o">=&gt;</span> <span class="s2">"Output"</span><span class="p">,</span>
           <span class="ss">:default</span>     <span class="o">=&gt;</span> <span class="s2">""</span>

    <span class="n">output</span> <span class="ss">:exitcode</span><span class="p">,</span>
           <span class="ss">:description</span>  <span class="o">=&gt;</span> <span class="s2">"Exit Code from the Nagios plugin"</span><span class="p">,</span>
           <span class="ss">:display_as</span>   <span class="o">=&gt;</span> <span class="s2">"Exit Code"</span><span class="p">,</span>
           <span class="ss">:default</span>      <span class="o">=&gt;</span> <span class="mi">3</span>

    <span class="n">output</span> <span class="ss">:perfdata</span><span class="p">,</span>
           <span class="ss">:description</span>  <span class="o">=&gt;</span> <span class="s2">"Performance Data from the Nagios plugin"</span><span class="p">,</span>
           <span class="ss">:display_as</span>   <span class="o">=&gt;</span> <span class="s2">"Performance Data"</span><span class="p">,</span>
           <span class="ss">:default</span>      <span class="o">=&gt;</span> <span class="s2">""</span>
<span class="k">end</span>
</code></pre>
</div>

<p>You can see it will return an <em>:exitcode</em> item and from the default value you
can gather this is going to be a number.  Nagios defines 4 possibly exit codes
for a Nagios plugin and we need to convert this <em>:exitcode</em> into a string like
WARNING, CRITICAL, UNKNOWN or OK.</p>

<p>Usually when writing any kind of summarizer for an array of results your code
might contain 3 phases.</p>

<p>Given a series of Nagios results like this:</p>

<div class="highlight"><pre><code class="ruby"><span class="o">[</span>
 <span class="p">{</span><span class="ss">:exitcode</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="ss">:output</span> <span class="o">=&gt;</span> <span class="s2">"OK"</span><span class="p">,</span> <span class="ss">:perfdata</span> <span class="o">=&gt;</span> <span class="s2">""</span><span class="p">},</span>
 <span class="p">{</span><span class="ss">:exitcode</span> <span class="o">=&gt;</span> <span class="mi">2</span><span class="p">,</span> <span class="ss">:output</span> <span class="o">=&gt;</span> <span class="s2">"failure"</span><span class="p">,</span> <span class="ss">:perfdata</span> <span class="o">=&gt;</span> <span class="s2">""</span><span class="p">}</span>
<span class="o">]</span>
</code></pre>
</div>

<p>You would write a nagios_states() function that does roughly this:</p>

<div class="highlight"><pre><code class="ruby"><span class="k">def</span> <span class="nf">nagios_states</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
  <span class="c1"># set initial values</span>
  <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
  <span class="n">status_map</span> <span class="o">=</span> <span class="o">[</span><span class="s2">"OK"</span><span class="p">,</span> <span class="s2">"WARNING"</span><span class="p">,</span> <span class="s2">"CRITICAL"</span><span class="p">,</span> <span class="s2">"UNKNOWN"</span><span class="o">]</span>
  <span class="n">status_map</span><span class="o">.</span><span class="n">each</span> <span class="p">{</span><span class="o">|</span><span class="n">s</span><span class="o">|</span> <span class="n">result</span><span class="o">[</span><span class="n">s</span><span class="o">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">}</span>

  <span class="c1"># loop over all the data, increment the count for OK etc</span>
  <span class="n">results</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">result</span><span class="o">|</span>
    <span class="n">status</span> <span class="o">=</span> <span class="n">status_map</span><span class="o">[</span><span class="n">result</span><span class="o">[</span><span class="ss">:exitcode</span><span class="o">]]</span>
    <span class="n">result</span><span class="o">[</span><span class="n">status</span><span class="o">]</span> <span class="o">+=</span> <span class="mi">1</span>
  <span class="k">end</span>

  <span class="c1"># return the result hash, {"OK" =&gt; 1, "CRITICAL" =&gt; 1, "WARN" =&gt; 0, "UNKNOWN" =&gt; 0}</span>
  <span class="k">return</span> <span class="n">result</span>
<span class="k">end</span>
</code></pre>
</div>

<p>You could optimise the code but you can see there are 3 major stages in the life
of this code.</p>

<ul>
  <li>Set initial values for the return data</li>
  <li>Loop the data building up the state</li>
  <li>Return the data.</li>
</ul>

<p>Given this, here is our Nagios exitcode summary function, it is roughly the same
code with a bit more boiler plate to plugin into mcollective, but the same code
can be seen:</p>

<div class="highlight"><pre><code class="ruby"><span class="k">module</span> <span class="nn">MCollective</span>
  <span class="k">class</span> <span class="nc">Aggregate</span>
    <span class="k">class</span> <span class="nc">Nagios_states</span><span class="o">&lt;</span><span class="no">Base</span>
      <span class="c1"># Before function is run processing</span>
      <span class="k">def</span> <span class="nf">startup_hook</span>
        <span class="c1"># :collection or :numeric</span>
        <span class="vi">@result</span><span class="o">[</span><span class="ss">:type</span><span class="o">]</span> <span class="o">=</span> <span class="ss">:collection</span>

        <span class="c1"># set default aggregate_format if it is undefined</span>
        <span class="vi">@aggregate_format</span> <span class="o">=</span> <span class="s2">"%10s : %s"</span> <span class="k">unless</span> <span class="vi">@aggregate_format</span>

        <span class="vi">@result</span><span class="o">[</span><span class="ss">:value</span><span class="o">]</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="vi">@status_map</span> <span class="o">=</span> <span class="o">[</span><span class="s2">"OK"</span><span class="p">,</span> <span class="s2">"WARNING"</span><span class="p">,</span> <span class="s2">"CRITICAL"</span><span class="p">,</span> <span class="s2">"UNKNOWN"</span><span class="o">]</span>
        <span class="vi">@status_map</span><span class="o">.</span><span class="n">each</span> <span class="p">{</span><span class="o">|</span><span class="n">s</span><span class="o">|</span> <span class="vi">@result</span><span class="o">[</span><span class="ss">:value</span><span class="o">][</span><span class="n">s</span><span class="o">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">}</span>

      <span class="k">end</span>

      <span class="c1"># Determines the average of a set of numerical values</span>
      <span class="k">def</span> <span class="nf">process_result</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">reply</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">value</span>
          <span class="n">status</span> <span class="o">=</span> <span class="vi">@status_map</span><span class="o">[</span><span class="n">value</span><span class="o">]</span>
          <span class="vi">@result</span><span class="o">[</span><span class="ss">:value</span><span class="o">][</span><span class="n">status</span><span class="o">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span>
          <span class="vi">@result</span><span class="o">[</span><span class="s2">"UNKNOWN"</span><span class="o">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">end</span>
      <span class="k">end</span>

      <span class="c1"># Post processing hook that returns the summary result</span>
      <span class="k">def</span> <span class="nf">summarize</span>
        <span class="n">result_class</span><span class="p">(</span><span class="vi">@result</span><span class="o">[</span><span class="ss">:type</span><span class="o">]</span><span class="p">)</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="vi">@result</span><span class="p">,</span> <span class="vi">@aggregate_format</span><span class="p">,</span> <span class="vi">@action</span><span class="p">)</span>
      <span class="k">end</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
</div>

<p>This shows that an aggregate function has the same 3 basic parts.  First we set
the initial state using the <em>startup_hook</em>.  We then process each result as it
comes in from the network using <em>process_result</em>.  Finally we turn that into a
the result objects that you saw earlier in the ruby client examples using the
<em>summarize</em> method.</p>

<h3 id="startuphook"><em>startup_hook</em></h3>
<p>Each function needs a startup hook, without one you&#8217;ll get exceptions.  The
startup hook lets you set up the initial state.</p>

<p>The first thing to do is set the type of result this will be.  Currently we
support 2 types of result either a plain number indicated using <em>:numeric</em> or a
complex <em>:collection</em> type that can be a hash with keys and values.</p>

<p>Functions can take display formats in the DDL, in this example we set
<em>@aggregate_format</em> to a <em>printf</em> default that would display a table of results
but we still let the user supply his own format.</p>

<p>We then just initialize the result hash to and build a map from the English
representation of the Nagios status codes.</p>

<h3 id="processresult"><em>process_result</em></h3>
<p>Every reply that comes in from the network gets passed into your
<em>process_result</em> method.  The first argument will be just the single value the
DDL indicates you are interested in but you&#8217;ll also get the whole rely so you
can get access to other reply values and such.</p>

<p>This gets called each time, we just look at the value and increment each Nagios
status or treat it as an unknown - in case the result data is missformed.</p>

<h3 id="summarize"><em>summarize</em></h3>
<p>The summarize method lets you take the state you built up and convert that into
an answer.  The summarize method is optional what you see here is the default
action if you do not supply one.</p>

<p>The <em>result_class</em> method accepts either <em>:collection</em> or <em>:numeric</em> as
arguments and it is basically a factory for the correct result structure.</p>

<h3 id="deploy-and-update-the-ddl">Deploy and update the DDL</h3>
<p>You should deploy this function into your <em>libdir/aggregate</em> directory called
<em>nagios_states.rb</em> on the client machines - no harm deploying it everywhere
though.</p>

<p>Update the DDL so it looks like:</p>

<div class="highlight"><pre><code class="ruby"><span class="n">action</span> <span class="s2">"runcommand"</span><span class="p">,</span> <span class="ss">:description</span> <span class="o">=&gt;</span> <span class="s2">"Run a NRPE command"</span> <span class="k">do</span>
    <span class="o">.</span>
    <span class="o">.</span>
    <span class="o">.</span>

    <span class="k">if</span> <span class="nb">respond_to?</span><span class="p">(</span><span class="ss">:summarize</span><span class="p">)</span>
        <span class="n">summarize</span> <span class="k">do</span>
            <span class="n">aggregate</span> <span class="n">nagios_states</span><span class="p">(</span><span class="ss">:exitcode</span><span class="p">)</span>
        <span class="k">end</span>
    <span class="k">end</span>
<span class="k">end</span>
</code></pre>
</div>

<p>Add the last few lines - we check that we&#8217;re running in a version of MCollective
that supports this feature and then we call our function with the <em>:exitcode</em>
results.</p>


              <blockquote><p style="font-size: 1.3em; text-align: center;"><a href="#content">&#8593; Back to top</a></p></blockquote>
            </div>
            <nav class="main">
                  <div id="subCol">


<ul>
  <li><strong>Overview</strong>
    <ul>
      <li><a href="./../../../mcollective/index.html">Introduction</a></li>
      <li><a href="./../../../mcollective/overview_components.html">Overview of Components</a></li>
      <li><a href="./../../../mcollective/terminology.html">Terminology</a></li>
      <li><a href="./../../../mcollective/screencasts.html">Screencasts</a></li>
      <li><a href="./../../../mcollective/releasenotes.html">Release Notes</a></li>
      <li><a href="./../../../mcollective/changelog.html">Changelog</a></li>
    </ul>
  </li>
  <li><strong>Deploying MCollective</strong>
    <ul>
      <li><a href="./../../../mcollective/deploy/index.html">Index</a></li>
      <li><a href="./../../../mcollective/deploy/demo.html">Demo</a></li>
      <li><a href="./../../../mcollective/deploy/standard.html">Getting Started (Standard Deployment)</a></li>
    </ul>
  </li>
  <li><strong>Configuration / Deployment Topics</strong>
    <ul>
      <li><strong>Installation:</strong></li>
      <li><a href="./../../../mcollective/deploy/install.html">Installing MCollective</a></li>
      <li><a href="./../../../mcollective/deploy/plugins.html">Installing Plugins</a></li>
      <li><strong>Configuration:</strong></li>
      <li><a href="./../../../mcollective/configure/server.html">Server Config Reference</a></li>
      <li><a href="./../../../mcollective/configure/client.html">Client Config Reference</a></li>
      <li><a href="./../../../mcollective/reference/integration/puppet.html">Puppet Integration</a></li>
      <li><a href="./../../../mcollective/reference/integration/chef.html">Chef Integration</a></li>
      <li><strong>Middleware:</strong></li>
      <li><a href="./../../../mcollective/deploy/middleware/index.html">Middleware Types</a></li>
      <li><a href="./../../../mcollective/deploy/middleware/activemq.html">ActiveMQ Configs for MCollective</a></li>
      <li><a href="./../../../mcollective/deploy/middleware/activemq_keystores.html">ActiveMQ TLS Keystore Setup</a></li>
      <li><a href="./../../../mcollective/reference/integration/activemq_clusters.html">ActiveMQ Clustering</a></li>
      <li><a href="./../../../mcollective/reference/integration/activemq_ssl.html">ActiveMQ TLS</a></li>
      <li><a href="./../../../mcollective/reference/integration/activemq_security.html">ActiveMQ Security</a></li>
      <li><strong>Connector Plugins:</strong></li>
      <li><a href="./../../../mcollective/reference/plugins/connector_activemq.html">The ActiveMQ Connector</a></li>
      <li><a href="./../../../mcollective/reference/plugins/connector_rabbitmq.html">The RabbitMQ Connector</a></li>
      <li><strong>Security Plugins:</strong></li>
      <li><a href="./../../../mcollective/reference/plugins/security_ssl.html">Configuring SSL Validation Security</a></li>
      <li><strong>Advanced Features:</strong></li>
      <li><a href="./../../../mcollective/reference/basic/subcollectives.html">Subcollectives and Partitioning</a></li>
      <li><a href="./../../../mcollective/simplerpc/auditing.html">Auditing</a> <!-- contains plugin-writing info --></li>
    </ul>
  </li>
  <li><strong>Use and Administer MCollective</strong>
    <ul>
      <li><a href="./../../../mcollective/reference/basic/basic_cli_usage.html">Command Line Usage Instructions</a></li>
      <li><a href="./../../../mcollective/reference/ui/filters.html">Command Filtering and Discovery</a></li>
      <li><a href="./../../../mcollective/reference/basic/daemon.html">Controlling the MCollective Daemon</a></li>
      <li><a href="./../../../mcollective/reference/plugins/rpcutil.html">Controlling the MCollective Daemon with the rpcutil Agent</a></li>
      <li><a href="./../../../mcollective/reference/ui/nodereports.html">On-Demand Node Reports</a></li>
    </ul>
  </li>
  <li><strong>Write Agent Plugins</strong>
    <ul>
      <li><a href="./../../../mcollective/simplerpc/agents.html">Writing Agent Plugins</a></li>
      <li><a href="./../../../mcollective/reference/plugins/ddl.html">Writing DDL Files</a></li>
      <li><span class="currentpage">Aggregating Results</span> <!-- mixes DDL info with info about writing aggregate plugins --></li>
    </ul>
  </li>
  <li><strong>Write Clients and Applications</strong>
    <ul>
      <li><a href="./../../../mcollective/simplerpc/clients.html">Writing Clients</a></li>
      <li><a href="./../../../mcollective/reference/plugins/application.html">Writing New mco Subcommands</a></li>
    </ul>
  </li>
  <li><strong>Write Other Plugins</strong>
    <ul>
      <li><a href="./../../../mcollective/simplerpc/authorization.html">Writing Authorization Plugins and Enabling Authorization</a> <!-- contains deploy/config info --></li>
      <li><a href="./../../../mcollective/reference/plugins/data.html">Writing Data Plugins</a></li>
      <li><a href="./../../../mcollective/reference/plugins/discovery.html">Writing and Using Discovery Plugins</a> <!-- contains usage info --></li>
      <li><a href="./../../../mcollective/reference/plugins/facts.html">Writing Facts Plugins</a></li>
      <li><a href="./../../../mcollective/reference/plugins/registration.html">Writing Registration Plugins</a></li>
      <li><a href="./../../../mcollective/reference/plugins/validator.html">Writing Validator Plugins</a></li>
    </ul>
  </li>
  <li><a href="http://projects.puppetlabs.com/projects/mcollective-plugins/wiki">Plugin Directory</a></li>
  <li><strong>Internals</strong>
    <ul>
      <li><a href="./../../../mcollective/reference/basic/messageflow.html">Message Flow</a> <!-- needs more/needs update --></li>
      <li><a href="./../../../mcollective/simplerpc/index.html">SimpleRPC Overview</a></li>
      <li><a href="./../../../mcollective/simplerpc/messageformat.html">SimpleRPC Message Format</a></li>
      <li><a href="./../../../mcollective/reference/basic/messageformat.html">Core Message Format</a></li>
      <li><a href="./../../../mcollective/security.html">Security Overview</a></li>
    </ul>
  </li>
  <li><strong>Older and Non-Recommended Information</strong>
    <ul>
      <li><a href="./../../../mcollective/reference/plugins/security_aes.html">Configuring AES Security</a></li>
      <li><a href="./../../../mcollective/reference/plugins/connector_stomp.html">Configuring the Generic Stomp Connector</a></li>
      <li><a href="./../../../mcollective/reference/basic/basic_agent_and_client.html">Writing Old-Style Agent Plugins</a></li>
      <li><a href="./../../../mcollective/reference/index.html">Alternate Index</a></li>
    </ul>
  </li>
</ul>

                      <div style="margin-top: 1.5em; padding-bottom: 10px;">
                          <p style="font-family: 'Lucida Grande',Lucida,Verdana,sans-serif;font-size: 16px; font-weight: bold; line-height: 22px; margin-bottom: 10px;">Download the Docs</p>
                          <a href="http://info.puppetlabs.com/download-pdfs.html"><img src="./../../../images/smallbits_small_docs.png" alt="Puppet docs download" /></a>
                      </div>
                      <div style="margin-top: 0; padding-bottom: 10px;">
                          <p style="font-family: 'Lucida Grande',Lucida,Verdana,sans-serif;font-size: 16px; font-weight: bold; line-height: 22px; margin-bottom: 10px;">Download Puppet Enterprise</p>
                          <a href="http://info.puppetlabs.com/download-pe.html"><img src="./../../../images/puppet_cert_home.jpg" alt="Puppet Enterprise promo" /></a>
                      </div>
                  </div>
            </nav>
          </div>
        </div>
      </section>

		<footer id="footer">
      <div class="site-width">

        <div class="primary-secondary-content">
          <div class="primary-content">
            <section id="newsletter">
                 <h4>Puppet Labs is Hiring</h4>
                 <p><a href="http://www.puppetlabs.com/company/jobs/">Engineers, developers &amp; consultants</a>
                  </p><p>
		</p><h4>Newsletter</h4>

              <p>Stay up to date on all things puppet</p>

				<form class="lpeRegForm formNotEmpty" method="post" enctype="application/x-www-form-urlencoded" action="http://info.puppetlabs.com/index.php/leadCapture/save" id="mktForm_1013" name="mktForm_1013">

				<label>Email Address:</label><span class="mktInput"><input class="mktFormText mktFormEmail" name="Email" id="Email" type="text" value="" maxlength="255" /><span class="mktFormMsg"></span></span>

				<input id="mktFrmSubmit" type="submit" class="btn" style="width: auto; overflow: visible; padding-left: .25em; padding-right: .25em;" value="Subscribe" name="submitButton" onclick="formSubmit(document.getElementById(&quot;mktForm_1013&quot;)); return false;" />

				<input style="display: none;" id="mktFrmReset" type="reset" value="Clear" name="resetButton" onclick="formReset(document.getElementById(&quot;mktForm_1013&quot;)); return false;" />

				<span style="display:none;"><input type="text" name="_marketo_comments" value="" /></span>
				<input type="hidden" name="lpId" value="-1" />
				<input type="hidden" name="subId" value="100" />

				<input type="hidden" name="kw" value="" />
				<input type="hidden" name="cr" value="" />

				<input type="hidden" name="searchstr" value="" />
				<input type="hidden" name="lpurl" value="http://info.puppetlabs.com/testsubscription.html?cr={creative}&amp;kw={keyword}" />
				<input type="hidden" name="formid" value="1013" />
				<input type="hidden" name="returnURL" value="http://www.puppetlabs.com/misc/subscription-thank-you/" />
				<input type="hidden" name="retURL" value="http://www.puppetlabs.com/misc/subscription-thank-you/" />
				<input type="hidden" name="_mkt_disp" value="return" />
				<input type="hidden" name="_mkt_trk" value="" />

				</form>
				<script type="text/javascript" src="http://info.puppetlabs.com/js/mktFormSupport.js"></script>

				<script type="text/javascript"><![CDATA[
				function formSubmit(elt) {
				return Mkto.formSubmit(elt);
				}
				function formReset(elt) {
				return Mkto.formReset(elt);
				}
				]]></script>

<a href="http://info.puppetlabs.com/puppet-enterprise" class="fbtn">Try Puppet Enterprise FREE</a>

            </section>
            <section id="elsewhere">
              <h4>Get Involved</h4>
              <ul>

                <li class="chat"><a href="http://webchat.freenode.net/?channels=puppet" rel="external"><span class="indicator"></span><span>Chat with us on IRC</span></a></li>
		<li class="discussion"><a href="http://groups.google.com/group/puppet-dev" rel="external"><span class="indicator"></span><span>Join the Puppet Developer List</span></a></li>
                <li class="discussion"><a href="http://groups.google.com/group/puppet-users?pli=1" rel="external"><span class="indicator"></span><span>Join the Puppet User List</span></a></li>

                <li class="linkedin"><a href="http://www.linkedin.com/groups?about=&amp;gid=696467&amp;trk=anet_ug_grppro" rel="external"><span class="indicator"></span><span>Join the Puppet Users LinkedIn group</span></a></li>

              </ul>
		<p>
		              		</p><h4>Follow us&#8230;</h4>

              		<ul class="followus">


			<li><a href="http://feeds.feedburner.com/PuppetLabs" target="_blank"><img src="http://www.puppetlabs.com/wp-content/plugins/my-profiles/images/rss.png" border="0" /></a></li>
			<li><a href="http://www.facebook.com/pages/Puppet-Labs/219089920711" target="_blank"><img src="http://www.puppetlabs.com//wp-content/plugins/my-profiles/images/facebook.png" border="0" /></a></li>
			<li><a href="http://www.twitter.com/puppetlabs" target="_blank"><img src="http://www.puppetlabs.com//wp-content/plugins/my-profiles/images/twitter.png" border="0" /></a></li>
			<li><a href="http://www.linkedin.com/groups?about=&amp;gid=696467&amp;trk=anet_ug_grppro" target="_blank"><img src="http://www.puppetlabs.com//wp-content/uploads/2011/01/LinkedIn_IN_Icon_32px.png" border="0" /></a></li>    <li><a href="https://github.com/puppetlabs" target="_blank"><img src="http://www.puppetlabs.com//wp-content/uploads/2011/01/github_icon.png" border="0" /></a></li>
			<li><a href="https://plus.google.com/112682055028218091774?rel=author" target="_blank"><img src="https://puppetlabs.com/wp-content/uploads/2013/05/google_plus32x32.png" alt="Find Us on Google+" border="0" /></a></li>
					</ul>

              	

            </section>
          </div>
          <div class="secondary-content">
            <section id="book-it">
              <h4>Get the book!</h4>

              <p>James Turnbull and Jeff McCune's book <a href="http://www.apress.com/9781430230571" rel="nofollow">Pro Puppet</a> is a comprehensive and up-to-date look at Puppet and MCollective. </p>
              <a href="http://www.apress.com/9781430230571" rel="nofollow"><img src="http://www.puppetlabs.com/wp-content/uploads/2011/05/propuppetthumb.png" /></a>
            </section>
          </div>
        </div>
      </div>
		</footer>

    <div id="copyright">
      <div class="site-width">
        &#169; 2011 <a href="http://www.puppetlabs.com/" title="Puppet Labs">Puppet Labs</a>
        <span class="vcard">
         <span class="org"></span>
         <a class="email" href="mailto:info@puppetlabs.com">info@puppetlabs.com</a>

          <span class="adr">
           <span class="street-address">926 NW 13th Avenue #210</span>
           /
           <span class="locality">Portland</span>,
           <span class="region">OR</span>
           <span class="postal-code">97209</span>

          </span>

         <span class="tel">1-877-575-9775</span>
        </span>
      </div>
    </div>

  	<script type="text/javascript"><![CDATA[Cufon.now();]]></script>
  	<style type="text/css"><![CDATA[h1, h2, .btn { visibility : visible; }]]></style>


	</body>
</html>
