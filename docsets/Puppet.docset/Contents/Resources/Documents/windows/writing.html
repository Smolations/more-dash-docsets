<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-US" xml:lang="en-US">
  <head>
  	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  	<title>Writing Manifests for Windows &#8212; Documentation &#8212; Puppet Labs</title>
  	<link rel="alternate" type="application/atom+xml" title="Puppet Labs Documentation Updates" href="https://github.com/puppetlabs/puppet-docs/commits/master.atom" />
    <link rel="alternate" type="application/atom+xml" title="Puppet Labs Blog Feed" href="http://puppetlabs.com/feed/atom/" />
    <link rel="index" title="Puppet Labs Documentation" href="http://docs.puppetlabs.com" />
    <link rel="icon" href="./../favicon.ico" />


  <meta name="description" content="This documentation applies to Puppet &#8805; 2.7.6 and Puppet Enterprise &#8805; 2.5. Earlier versions may behave differently.Just as on *nix systems, Pupp..." />



    <!-- FIXME: absolute paths -->

    <script type="text/javascript" src="./../files/javascripts/html5.js"></script>
    <script type="text/javascript" src="./../files/javascripts/jquery-1.3.2.min.js"></script>
    <script type="text/javascript" src="./../files/javascripts/drop_down.js"></script>
    <script type="text/javascript" src="./../files/javascripts/cufon-yui.js"></script>
    <script type="text/javascript" src="./../files/fonts/Klavika_400-Klavika_600.font.js"></script>
    <script type="text/javascript" src="./../files/javascripts/ampersands.js"></script>
    <script type="text/javascript" src="./../files/javascripts/navigation-accordion.js"></script>

    <script type="text/javascript" src="http://puppetlabs.com/wp-content/themes/puppetlabs/javascripts/leadcapture.js"></script>

    <!-- All in One SEO Pack 1.6.10.1 by Michael Torbert of Semper Fi Web Design[127,146] -->
    <meta name="keywords" content="Puppet, puppet labs, reductive labs, open source, system administrator, ruby, data center, automation, support" />
    <!-- /all in one seo pack -->

    <!-- Give us the option of setting a canonical URL in yaml frontmatter -NF -->
    <link rel="canonical" href="http://docs.puppetlabs.com/windows/writing.html" />

    <!-- FIXME: absolute paths -->

    <link rel="stylesheet" type="text/css" href="./../files/stylesheets/style.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="./../files/stylesheets/syntax.css" media="screen" /> <!-- index -->
    <link rel="stylesheet" type="text/css" href="./../files/stylesheets/adbanner.css" media="screen" />

    <!--[if IE 7]>
	  <link rel="stylesheet" type="text/css" href="/files/stylesheets/ie_7.css" media="screen"> <!-- index -->
    

    <!--[if IE 8]>
	    <link rel="stylesheet" type="text/css" href="/files/stylesheets/ie_8.css" media="screen"> <!-- index -->
    

  	<script type="text/javascript"><![CDATA[
      Cufon.replace('h1, h2', { fontWeight: '600' });
  	]]></script>
</head>




  <body id="puppetlabsdocs" class="docs">
  <style type="text/css"><![CDATA[h1, h2{ visibility : hidden }]]></style>
  <!--[if IE 8]>
    <style type="text/css">h1, h2{ visibility : visible }</style>
  <![endif]-->

  	<header id="header">
      <div class="site-width">
    		<h1><a href="http://puppetlabs.com/"><span>Puppet Labs</span></a></h1>
        <a class="screen-reader-content" href="#content">Skip navigation</a>
        <nav>
    		<ul id="global-navigation">
          <li id="puppet-tab" class="with-submenu">
            <a href="http://puppetlabs.com/puppet/puppet-enterprise">
              <span>Products</span>
              <span class="drop-down-trigger"></span>
            </a>
            <ul>
			<li>
                <ul>
                   <a href="http://puppetlabs.com/puppet/what-is-puppet/">What is Puppet?</a>
                </ul>
              </li>
			       <li>
                <ul>
                   <a href="http://puppetlabs.com/puppet/puppet-enterprise/">Puppet Enterprise</a>
                </ul>
              </li>
            <li>
                <ul>
                   <a href="http://puppetlabs.com/puppet/whats-new/">What's New in 2.5</a>
                </ul>
              </li>
            <li>
                <ul>
                   <a href="http://puppetlabs.com/puppet/puppet-open-source/">Puppet Open Source</a>
                </ul>
              </li>
            <li>
                <ul>
                   <a href="http://puppetlabs.com/puppet/enterprise-vs-open-source/">Enterprise vs. Open Source</a>
                </ul>
              </li>
              <li>
                <ul>
                  <a href="http://forge.puppetlabs.com">Puppet Forge</a>
                </ul>
              </li>
              <li>
                <ul>
                  <a href="http://puppetlabs.com/puppet/requirements/">Components &amp; Requirements</a>
                </ul>
              </li>
              <li>
                <ul>
                  <a href="http://puppetlabs.com/puppet/faq/">FAQ</a>
                </ul>
              </li>
			  <li>
                <ul>
                  <a href="http://puppetlabs.com/puppet/how-to-buy/">How to Buy</a>
                </ul>
              </li>
            </ul>
          </li>
          <li id="solutions-tab" class="with-submenu">
            <a href="http://puppetlabs.com/solutions/">
              <span>Solutions</span>
              <span class="drop-down-trigger"></span>
            </a>
            <ul>
              <li class="page_item page-item-12296"><a href="http://puppetlabs.com/solutions/configuration-management/">Configuration Management</a></li>
<li class="page_item page-item-986"><a href="http://puppetlabs.com/solutions/virtualization-management/">Virtualization Management</a></li>
<li class="page_item page-item-993"><a href="http://puppetlabs.com/solutions/cloud-management/">Cloud Management</a></li>
<li class="page_item page-item-996"><a href="http://puppetlabs.com/solutions/it-compliance/">IT Compliance</a></li>
<li class="page_item page-item-9520"><a href="http://puppetlabs.com/solutions/devops/">DevOps</a></li>
<li class="page_item page-item-991"><a href="http://puppetlabs.com/solutions/manage-os-x-resources/">OS X Desktops</a></li>
            </ul>
          </li>
          <li id="services-tab" class="with-submenu">
            <a href="http://puppetlabs.com/services/">
              <span>Services</span>
              <span class="drop-down-trigger"></span>
            </a>
            <ul>
              <li class="page_item page-item-783"><a href="http://puppetlabs.com/services/overview/">Overview</a></li>
<li class="page_item page-item-1052"><a href="http://puppetlabs.com/services/customer-support/">Customer Support</a></li>
<li class="page_item page-item-11022"><a href="http://puppetlabs.com/services/support-plans/">Support Plans</a></li>
<li class="page_item page-item-845"><a href="http://puppetlabs.com/services/training-workshops/">On-Site Education</a></li>
<li class="page_item page-item-4899"><a href="http://puppetlabs.com/services/consulting/">Professional Services</a></li>
<li class="page_item page-item-849"><a href="http://puppetlabs.com/category/events/upcoming/">Events &amp; Workshops</a></li>
<li class="page_item page-item-851"><a href="http://puppetlabs.com/services/partners/">Partners</a></li>
            </ul>
          </li>
                    <li id="resources-tab" class="with-submenu">
            <a href="http://puppetlabs.com/resources/">
              <span>Resources</span>
              <span class="drop-down-trigger"></span>
            </a>
            <ul>
              <li class="page_item page-item-1048"><a href="http://puppetlabs.com/resources/overview-2/">Overview</a></li>
<li class="page_item page-item-1040"><a href="http://docs.puppetlabs.com">Documentation</a></li>
<li class="page_item page-item-872"><a href="http://info.puppetlabs.com/register-download">Downloads</a></li>
<li class="page_item page-item-1961"><a href="http://forge.puppetlabs.com">Puppet Forge</a></li>
<li class="page_item page-item-835"><a href="http://info.puppetlabs.com/download-whitepapers.html">White Papers</a></li>
<li class="page_item page-item-1967"><a href="http://projects.puppetlabs.com/projects/puppet/wiki">Wiki</a></li>
<li class="page_item page-item-7279"><a href="http://puppetlabs.com/resources/webinars/">Upcoming Webinars</a></li>
<li class="page_item page-item-10183"><a href="http://puppetlabs.com/resources/newsletter/">Newsletter</a></li>
<li class="page_item page-item-12263"><a href="http://puppetlabs.com/resources/tech-notes/">Tech Notes</a></li>
<li class="page_item page-item-10265"><a href="http://info.puppetlabs.com/pe2-webinar.html">Webinars</a></li>
            </ul>
          </li>

          <li id="customers-tab" class="with-submenu">
            <a href="http://puppetlabs.com/customers/companies/">
              <span>Customers</span>
              <span class="drop-down-trigger"></span>
            </a>
            <ul>
			<li>
                <ul>
                  <a href="http://puppetlabs.com/customers/companies/">Companies</a>
                </ul>
              </li>
			  <li>
                <ul>
                  <a href="http://puppetlabs.com/customers/case-studies/">Case Studies</a>
                </ul>
              </li>
			  <li>
                <ul>
                  <a href="http://puppetlabs.com/customers/product-testimonials/">Product Testimonials</a>
                </ul>
              </li>
			    <li>
                <ul>
                  <a href="http://puppetlabs.com/customers/what-customers-are-saying/">Service Testimonials</a>
                </ul>
              </li>
            </ul>
          </li>
          <li id="community-tab" class="with-submenu">
            <a href="http://puppetlabs.com/community/">
              <span>Community</span>
              <span class="drop-down-trigger"></span>
            </a>

 <ul>
			<li>
                <ul>
                  <a href="http://puppetlabs.com/community/overview/">Overview</a>
                </ul>
              </li>
			<li>
                <ul>
                  <a href="http://puppetlabs.com/blog">Blog</a>
                </ul>
              </li>
			  <li>
                <ul>
                  <a href="http://puppetlabs.com/community/puppet-camp/">Puppet Camp</a>
                </ul>
              </li>
			  <li>
                <ul>
                  <a href="http://puppetlabs.com/community/user-groups-and-devops-groups/">Puppet User Groups &amp; DevOps Groups</a>
                </ul>
              </li>
	          <li>
                <ul>
                  <a href="http://puppetlabs.com/community/presentations/">Presentations</a>
                </ul>
              </li>
			    <li>
                <ul>
                  <a href="http://puppetlabs.com/community/videos/">Videos</a>
                </ul>
              </li>
            </ul>

          </li><li id="company-tab" class="with-submenu">
            <a href="http://puppetlabs.com/company/">
              <span>Company</span>
              <span class="drop-down-trigger"></span>
            </a>
            <ul>
              <li class="page_item page-item-2316"><a href="http://puppetlabs.com/company/overview/">Overview</a></li>
<li class="page_item page-item-2179"><a href="http://puppetlabs.com/company/news/">News</a>
<ul class="children">
	<li class="page_item page-item-2338"><a href="http://puppetlabs.com/company/news/press-releases/">Press Releases</a></li>
	<li class="page_item page-item-2383"><a href="http://puppetlabs.com/company/news/media-kit/">Media Kit</a></li>
</ul>
</li>
<li class="page_item page-item-1571"><a href="http://puppetlabs.com/company/careers/">Careers</a></li>
<li class="page_item page-item-10372"><a href="http://puppetlabs.com/company/management/">Management</a></li>
<li class="page_item page-item-10311"><a href="http://puppetlabs.com/company/board-and-advisors/">Board and Advisors</a></li>
<li class="page_item page-item-10367"><a href="http://puppetlabs.com/company/investors/">Investors</a></li>
<li class="page_item page-item-2313"><a href="http://puppetlabs.com/company/contact-us/">Contact Us</a></li>
<li class="page_item page-item-10579"><a href="http://puppetlabs.com/company/awards/">Awards</a></li>
            </ul>
          </li>
    		</ul>
          <div id="misc-navigation">
			  <ul>
				<li><a href="http://puppetlabs.com/security/">Security</a></li>
				<li><a href="http://docs.puppetlabs.com">Documentation</a></li>
				<li><a href="http://puppetlabs.com/resources/customer-support/">Support</a></li>
			        <li><a href="http://projects.puppetlabs.com/">Bug Tracker</a></li>
				<li><a href="http://puppetlabs.com/company/contact/contact-us">Contact Us</a></li>
				<li><a href="http://info.puppetlabs.com/download-pe2.html" class="gateway">Download</a></li>
			  </ul>
			<form action="http://www.google.com/cse" id="cse-search-box">
			  <div>
				<input type="hidden" name="cx" value="017668764424496204839:ubligvgbenm" />
				<input type="hidden" name="ie" value="UTF-8" />
				<input type="text" name="q" class="gsc-input" size="31" />
				<input type="submit" name="sa" class="searchbtn" value="Search" />
			  </div>
			</form>
			<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script>
          </div>
      </nav>
    	</div>
    </header>

      <section id="masthead">
        <div class="site-width">
          <h1>Docs: <span class="section-name">Writing Manifests for Windows</span></h1>
          <ul id="doc-navigation">
            <li><a href="./../index.html">Docs Home</a></li>
            <li class="with-submenu">
              <a href="#">
                <span>Quick Nav</span>
                <span class="drop-down-trigger"></span>
              </a>
               <!-- the following links can't be relative, unfortunately -->
               <!-- future: add some JS to disable this if running from file:// -->
                               <dl>
                  <dt>Puppet Documentation</dt>
                      <dd><a href="./../puppet/3/reference/index.html">Puppet 3 Reference Manual</a></dd>
                      <dd><a href="./../puppet/2.7/reference/index.html">Puppet 2.7 Reference Manual</a></dd>
                      <dd><a href="./../pe/latest/index.html">Puppet Enterprise User's Guide</a></dd>
                      <dd><a href="./../learning/index.html">Learning Puppet</a></dd>
                      <dd><a href="./../references/latest/type.html">Resource Types</a></dd>
                      <dd><a href="./../references/latest/function.html">Functions</a></dd>
                      <dd><a href="./../references/latest/configuration.html">Configuration</a></dd>
                      <dd><a href="./../references/latest/developer/index.html">Developer</a></dd>
                      <dd><a href="./../references/glossary.html">Glossary of Puppet Terms</a></dd>
                      <dd><a href="./../references/index.html">Older References</a></dd>
                  <dt>Facter</dt>
                      <dd><a href="./../facter/latest/core_facts.html">Core Facts Reference</a></dd>
                  <dt>PuppetDB</dt>
                      <dd><a href="./../puppetdb/1/index.html">PuppetDB 1 Manual</a></dd>
                  <dt>MCollective</dt>
                      <dd><a href="./../mcollective/index.html">Index</a></dd>
                      <dd><a href="./../mcollective/reference/index.html">References</a></dd>
                      <dd><a href="./../mcollective/simplerpc/index.html">Writing Plugins</a></dd>
                      <dd><a href="./../mcollective/releasenotes.html">Release Notes</a></dd>
                </dl>

            </li>
            <li><a href="./../contribute.html">Contribute</a></li>
          </ul>
        </div>
        <br />
      </section>

      <section id="content">
        <div class="site-width">
          <div class="primary-secondary-content">
            <div class="primary-content">
              <h1>Writing Manifests for Windows</h1>
              <nav class="in-page" id="page-nav">
<ol class="toc">
  <li class="toc-lv2"><a href="#file-paths-on-windows">File Paths on Windows</a>
<ol class="toc">
   <li class="toc-lv3"><a href="#forward-slashes-vs-backslashes">Forward Slashes vs. Backslashes</a></li>
   <li class="toc-lv3"><a href="#using-backslashes-in-double-quoted-strings">Using Backslashes in Double-Quoted Strings</a></li>
   <li class="toc-lv3"><a href="#using-backslashes-in-single-quoted-strings">Using Backslashes in Single-Quoted Strings</a></li>
</ol></li>
  <li class="toc-lv2"><a href="#notable-windows-facts">Notable Windows Facts</a>
<ol class="toc">
   <li class="toc-lv3"><a href="#identifying-facts">Identifying Facts</a></li>
   <li class="toc-lv3"><a href="#windows-specific-facts">Windows-Specific Facts</a></li>
</ol></li>
  <li class="toc-lv2"><a href="#line-endings-in-windows-text-files">Line Endings in Windows Text Files</a></li>
  <li class="toc-lv2"><a href="#resource-types">Resource Types</a>
<ol class="toc">
   <li class="toc-lv3"><a href="#filefile">file</a></li>
   <li class="toc-lv3"><a href="#useruser">user</a></li>
   <li class="toc-lv3"><a href="#groupgroup">group</a></li>
   <li class="toc-lv3"><a href="#scheduledtaskscheduledtask">scheduled_task</a></li>
   <li class="toc-lv3"><a href="#packagepackage">package</a></li>
   <li class="toc-lv3"><a href="#serviceservice">service</a></li>
   <li class="toc-lv3"><a href="#execexec">exec</a></li>
   <li class="toc-lv3"><a href="#hosthost">host</a></li>
</ol></li>
</ol></nav>
              <p><span class="versionnote">This documentation applies to Puppet &#8805; 2.7.6 and Puppet Enterprise &#8805; 2.5. Earlier versions may behave differently.</span></p>

<p>Just as on *nix systems, Puppet manages resources on Windows using manifests written in the <a href="./../puppet/latest/reference/lang_summary.html">Puppet language</a>. There are several major differences to be aware of when writing manifests that manage Windows resources:</p>

<ul>
  <li>Windows primarily uses the backslash as its directory separator character, and Ruby handles it differently in different circumstances. You should <strong>learn when to use and when to avoid backslashes.</strong></li>
  <li>Most classes written for *nix systems will not work on Windows nodes; if you are managing a mixed environment, you should <strong>use conditionals and Windows-specific facts</strong> to govern the behavior of your classes.</li>
  <li>Puppet generally does the right thing with Windows line endings.</li>
  <li>Puppet supports a slightly different set of resource types on Windows.</li>
</ul>

<h2 id="file-paths-on-windows">File Paths on Windows</h2>

<p>Windows file paths must be written in different ways at different times, due to various tools&#8217; conflicting rules for backslash use.</p>

<ul>
  <li>Windows file system APIs accept both the backslash (<code>\</code>) and forwardslash (<code>/</code>) to separate directory and file components in a path.</li>
  <li>Some Windows programs only accept backslashes in file paths.</li>
  <li>*nix shells and many programming languages &#8212; including the Puppet language &#8212; use the backslash as an <a href="http://en.wikipedia.org/wiki/Escape_character">escape character</a>.</li>
</ul>

<p>As a result, any system that interacts with *nix and Windows systems as equal peers will unavoidably have complicated behavior around backslashes.</p>

<p>The following guidelines will help you use backslashes safely in Windows file paths with Puppet.</p>

<h3 id="forward-slashes-vs-backslashes">Forward Slashes vs. Backslashes</h3>

<p>In many cases, you can use forward slashes instead of backslashes when specifying file paths.</p>

<p>Forward slashes <strong>MUST</strong> be used:</p>

<ul>
  <li>
    <p>In template paths passed to the <code>template</code> function. For example:</p>

    <pre><code>  file {'C:/warning.txt':
    ensure  =&gt; present,
    content =&gt; template('my_module/warning.erb'),
  }
</code></pre>
  </li>
  <li>
    <p>In Puppet URLs in a <a href="./../references/latest/type.html#file"><code>file</code></a> resource&#8217;s <code>source</code> attribute.</p>
  </li>
  <li>
    <p>When part of the <code>modulepath</code> configuration option, e.g. <code>puppet apply --modulepath="Z:/path/to/my/modules" "Z:/path/to/my/site.pp"</code> (This restriction applies only to versions of Puppet prior to 3.0.)</p>
  </li>
</ul>

<p>Forward slashes <strong>SHOULD</strong> be used in:</p>

<ul>
  <li>The title or <code>path</code> attribute of a <a href="./../references/latest/type.html#file"><code>file</code></a> resource</li>
  <li>The <code>source</code> attribute of a <a href="./../references/latest/type.html#package"><code>package</code></a> resource</li>
  <li>Local paths in a <a href="./../references/latest/type.html#file"><code>file</code></a> resource&#8217;s <code>source</code> attribute</li>
  <li>The <code>command</code> of an <a href="./../references/latest/type.html#exec"><code>exec</code></a> resource, unless the executable requires backslashes, e.g. cmd.exe</li>
</ul>

<p>Forward slashes <strong>MUST NOT</strong> be used in:</p>

<ul>
  <li>The <code>command</code> of a <a href="./../references/latest/type.html#scheduledtask"><code>scheduled_task</code></a> resource.</li>
  <li>The <code>install_options</code> of a <a href="./../references/latest/type.html#package"><code>package</code></a> resource.</li>
</ul>

<h4 id="the-rule">The Rule</h4>

<p>If Puppet itself is interpreting the file path, forward slashes are okay. If the file path is being passed directly to a Windows program, forward slashes may not be okay.</p>

<h3 id="using-backslashes-in-double-quoted-strings">Using Backslashes in Double-Quoted Strings</h3>

<p>Puppet supports two kinds of string quoting. Strings surrounded by double quotes (<code>"</code>) allow variable interpretation and many escape sequences (including the common <code>\n</code> for a newline), so care must be taken to prevent backslashes from being mistaken for escape sequences.</p>

<p>When using backslashes in a double-quoted string, <strong>you must always use two backslashes</strong> for each literal backslash. There are no exceptions and no special cases.</p>

<h3 id="using-backslashes-in-single-quoted-strings">Using Backslashes in Single-Quoted Strings</h3>

<p>Strings surrounded by single quotes (<code>'</code>) do not allow variable interpretation, and the only escape sequences permitted are <code>\'</code> (a literal single quote) and <code>\\</code> (a literal backslash).</p>

<p>Lone backslashes can usually be used in single-quoted strings. However:</p>

<ul>
  <li>When a backslash occurs at the very end of a single-quoted string, a double backslash must be used instead of a single backslash. For example: <code>path =&gt; 'C:\Program Files(x86)\\'</code></li>
  <li>When a literal double backslash is intended, a quadruple backslash must be used.</li>
</ul>

<h4 id="the-rule-1">The Rule</h4>

<p>In single-quoted strings:</p>

<ul>
  <li>A double backslash always means a literal backslash.</li>
  <li>A single backslash usually means a literal backslash, unless it is followed by a single quote or another backslash.</li>
</ul>

<h2 id="notable-windows-facts">Notable Windows Facts</h2>

<p>Windows nodes with a default install of Puppet will return the following notable facts, which can be useful when writing manifests:</p>

<h3 id="identifying-facts">Identifying Facts</h3>

<p>The following facts can help you determine whether a given machine is running Windows:</p>

<ul>
  <li><code>kernel =&gt; windows</code></li>
  <li><code>operatingsystem =&gt; windows</code></li>
  <li><code>osfamily =&gt; windows</code></li>
</ul>

<h3 id="windows-specific-facts">Windows-Specific Facts</h3>

<p>The following facts are either Windows-only, or have different values on Windows than on *nix:</p>

<ul>
  <li><code>env_windows_installdir</code> &#8212; This fact will contain the directory in which Puppet was installed.</li>
  <li><code>id</code> &#8212; This fact will be <code>&lt;DOMAIN&gt;\&lt;USER NAME&gt;</code>. You can use the user name to determine whether Puppet is running as a service or was triggered manually.</li>
</ul>

<h2 id="line-endings-in-windows-text-files">Line Endings in Windows Text Files</h2>

<p>Windows uses CRLF line endings instead of *nix&#8217;s LF line endings.</p>

<ul>
  <li>If the contents of a file are specified with the <code>content</code> attribute, Puppet will write the content in &#8220;binary&#8221; mode. To create files with CRLF line endings, the <code>\r\n</code> escape sequence should be specified as part of the content.</li>
  <li>If a file is being downloaded to a Windows node with the <code>source</code> attribute, Puppet will transfer the file in &#8220;binary&#8221; mode, leaving the original newlines untouched.</li>
  <li>
    <p>Non-<code>file</code> resource types that make partial edits to a system file (most notably the <a href="./../references/latest/type.html#host"><code>host</code></a> type, which manages the <code>%windir%\system32\drivers\etc\hosts</code> file) manage their files in text mode, and will automatically translate between Windows and *nix line endings.</p>

    <blockquote>
      <p>Note: When writing your own resource types, you can get this behavior by using the <code>flat</code> filetype.</p>
    </blockquote>
  </li>
</ul>

<h2 id="resource-types">Resource Types</h2>

<p>Puppet can manage the following resource types on Windows nodes:</p>

<h3 id="filefile"><a href="./../references/latest/type.html#file"><code>file</code></a></h3>

<div class="highlight"><pre><code class="ruby">    <span class="n">file</span> <span class="p">{</span> <span class="s1">'c:/mysql/my.ini'</span><span class="p">:</span>
      <span class="k">ensure</span> <span class="o">=&gt;</span> <span class="s1">'file'</span><span class="p">,</span>
      <span class="n">mode</span> <span class="o">=&gt;</span> <span class="s1">'0660'</span><span class="p">,</span>
      <span class="n">owner</span> <span class="o">=&gt;</span> <span class="s1">'mysql'</span><span class="p">,</span>
      <span class="n">group</span> <span class="o">=&gt;</span> <span class="s1">'Administrators'</span><span class="p">,</span>
      <span class="n">source</span> <span class="o">=&gt;</span> <span class="s1">'N:/software/mysql/my.ini'</span><span class="p">,</span>
    <span class="p">}</span>
</code></pre>
</div>

<p>Puppet can manage files and directories, including owner, group, permissions, and content. Symbolic links are not supported.</p>

<ul>
  <li>If an <code>owner</code> or <code>group</code> are specified for a file, <strong>you must also specify a <code>mode</code>.</strong> Failing to do so can render a file inaccessible to Puppet. <a href="./troubleshooting.html#file">See here for more details</a>.</li>
  <li>Windows NTFS filesystems are case-preserving, but case-insensitive; Puppet is case-sensitive. Thus, you should be consistent in the case you use when referring to a file resource in multiple places in a manifest.</li>
  <li>In order to manage files that it does not own, Puppet must be running as a member of the local Administrators group (on Windows 2003) or with elevated privileges (Windows 7 and 2008). This gives Puppet the <code>SE_RESTORE_NAME</code> and <code>SE_BACKUP_NAME</code> privileges it requires to manage file permissions.</li>
  <li>Permissions modes are set as though they were *nix-like octal modes; Puppet translates these to the equivalent access controls on Windows.
    <ul>
      <li>The read, write, and execute permissions translate to the <code>FILE_GENERIC_READ</code>, <code>FILE_GENERIC_WRITE</code>, and <code>FILE_GENERIC_EXECUTE</code> access rights.</li>
      <li>The owner of a file/directory always has the <code>FULL_CONTROL</code> access right.</li>
      <li>The <code>Everyone</code> SID is used to represent users other than the owner and group.</li>
    </ul>
  </li>
  <li>Puppet cannot set permission modes where the group has higher permissions than the owner, or other users have higher permissions than the owner or group. (That is, 0640 and 0755 are supported, but 0460 is not.) Directories on Windows can have the sticky bit, which makes it so users can only delete files if they own the containing directory.</li>
  <li>On Windows, the owner of a file can be a group (e.g. <code>owner =&gt; 'Administrators'</code>) and the group of a file can be a user (e.g. <code>group =&gt; 'Administrator'</code>). The owner and group can even be the same, but as that can cause problems when the mode gives different permissions to the owner and group (like <code>0750</code>), this is not recommended.</li>
  <li>The source of a file can be a puppet URL, a local path, or a path to a file on a mapped drive.</li>
  <li>When downloading a file from a puppet master with a <code>puppet:///</code> URI, Puppet will set the permissions mode to match that of the remote file. Be sure to set the proper mode on any remote files.</li>
</ul>

<h3 id="useruser"><a href="./../references/latest/type.html#user"><code>user</code></a></h3>

<p>Puppet can create, edit, and delete local users. Puppet does not support managing domain user accounts, but can add (and remove) domain user accounts to local groups.</p>

<ul>
  <li>The <code>comment</code>, <code>home</code>, and <code>password</code> attributes can be managed, as well as groups to which the user belongs.</li>
  <li>Passwords can only be specified in cleartext. Windows does not provide an API for setting the password hash.</li>
  <li>The user SID is available as a read-only parameter. Attempting to set the parameter will fail</li>
  <li>User names are case-sensitive in Puppet manifests, but insensitive on Windows. Make sure to consistently use the same case in manifests.</li>
</ul>

<h4 id="security-identifiers-sid">Security Identifiers (SID)</h4>

<p>On Windows, user and group account names can take multiple forms, e.g. <code>Administrators</code>, <code>&lt;host&gt;\Administrators</code>, <code>BUILTIN\Administrators</code>, <code>S-1-5-32-544</code>. When comparing two account names, puppet always first transforms account names into their canonical SID form and compares the SIDs instead.</p>

<h3 id="groupgroup"><a href="./../references/latest/type.html#group"><code>group</code></a></h3>

<p>Puppet can create, edit, and delete local groups, and can manage a group&#8217;s members. Puppet does not support managing domain group accounts, but a local group can include both local and domain users as members.</p>

<ul>
  <li>The group SID is available as a read-only parameter. Attempting to set the parameter will fail.</li>
  <li>Group names are case-sensitive in puppet manifests, but insensitive on Windows. Make sure to consistently use the same case in manifests.</li>
  <li>Nested groups are not supported. (Group members must be users, not other groups.)</li>
</ul>

<h3 id="scheduledtaskscheduledtask"><a href="./../references/latest/type.html#scheduledtask"><code>scheduled_task</code></a></h3>

<div class="highlight"><pre><code class="ruby">    <span class="n">scheduled_task</span> <span class="p">{</span> <span class="s1">'Daily task'</span><span class="p">:</span>
      <span class="k">ensure</span>    <span class="o">=&gt;</span> <span class="n">present</span><span class="p">,</span>
      <span class="n">enabled</span>   <span class="o">=&gt;</span> <span class="kp">true</span><span class="p">,</span>
      <span class="n">command</span>   <span class="o">=&gt;</span> <span class="s1">'C:\path\to\command.exe'</span><span class="p">,</span>
      <span class="n">arguments</span> <span class="o">=&gt;</span> <span class="s1">'/flags /to /pass'</span><span class="p">,</span>
      <span class="n">trigger</span>   <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="n">schedule</span>   <span class="o">=&gt;</span> <span class="n">daily</span><span class="p">,</span>
        <span class="n">every</span>      <span class="o">=&gt;</span> <span class="mi">2</span><span class="p">,</span>            <span class="c1"># Defaults to 1</span>
        <span class="n">start_date</span> <span class="o">=&gt;</span> <span class="s1">'2011-08-31'</span><span class="p">,</span> <span class="c1"># Defaults to 'today'</span>
        <span class="n">start_time</span> <span class="o">=&gt;</span> <span class="s1">'08:00'</span><span class="p">,</span>      <span class="c1"># Must be specified</span>
      <span class="p">}</span>
    <span class="p">}</span>
</code></pre>
</div>

<p>Puppet can create, edit, and delete scheduled tasks. It can manage the task name, the enabled/disabled status, the command, any arguments, the working directory, the user and password, and triggers. For more information, see <a href="./../references/latest/type.html#scheduledtask">the reference documentation for the <code>scheduled_task</code> type</a>. This is a Windows-only resource type.</p>

<ul>
  <li>Puppet does not support &#8220;every X minutes&#8221; type triggers.</li>
</ul>

<h3 id="packagepackage"><a href="./../references/latest/type.html#package"><code>package</code></a></h3>

<div class="highlight"><pre><code class="ruby">    <span class="n">package</span> <span class="p">{</span> <span class="s1">'mysql'</span><span class="p">:</span>
      <span class="k">ensure</span>          <span class="o">=&gt;</span> <span class="n">installed</span><span class="p">,</span>
      <span class="n">provider</span>        <span class="o">=&gt;</span> <span class="s1">'msi'</span><span class="p">,</span> <span class="c1"># deprecated in Puppet 3.0</span>
      <span class="n">source</span>          <span class="o">=&gt;</span> <span class="s1">'N:/packages/mysql-5.5.16-winx64.msi'</span><span class="p">,</span>
      <span class="n">install_options</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="s1">'INSTALLDIR'</span> <span class="o">=&gt;</span> <span class="s1">'C:\mysql-5.5'</span> <span class="p">},</span>
    <span class="p">}</span>
</code></pre>
</div>

<p>Puppet can install and remove MSI packages, including specifying package-specific install options, e.g. install directory.</p>

<h4 id="identifying-packages">Identifying Packages</h4>

<p>The <code>title</code> or name of the package must match the value of the <code>DisplayName</code> property in the registry, which is also the value displayed in Add/Remove Programs. Alternately, when a package name is not unique across versions (e.g. VMWare Tools, or where there are 32- and 64-bit versions with the same name), we provide the ability to specify the package&#8217;s PackageCode as the package name. This is a GUID that&#8217;s unique across all MSI builds. For instance:</p>

<div class="highlight"><pre><code class="ruby">	<span class="n">package</span> <span class="p">{</span> <span class="s1">'{XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX}'</span><span class="p">:</span>
	  <span class="k">ensure</span> <span class="o">=&gt;</span> <span class="n">installed</span><span class="p">,</span>
	  <span class="n">source</span> <span class="o">=&gt;</span> <span class="s1">'the.msi'</span><span class="p">,</span>
	  <span class="n">provider</span> <span class="o">=&gt;</span> <span class="n">windows</span>
	<span class="p">}</span>
</code></pre>
</div>

<p>To find the PackageCode from an MSI, you can use Orca, or you can get to it programmatically with Ruby:</p>

<div class="highlight"><pre><code class="ruby">	<span class="nb">require</span> <span class="s1">'win32ole'</span>
	<span class="n">installer</span> <span class="o">=</span> <span class="no">WIN32OLE</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">'WindowsInstaller.Installer'</span><span class="p">)</span>
	<span class="n">db</span> <span class="o">=</span> <span class="n">installer</span><span class="o">.</span><span class="n">OpenDatabase</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="c1"># where 'path' is the path to the MSI</span>
	<span class="nb">puts</span> <span class="n">db</span><span class="o">.</span><span class="n">SummaryInformation</span><span class="o">.</span><span class="n">Property</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
</code></pre>
</div>

<h4 id="additional-notes-on-windows-packages">Additional Notes on Windows Packages</h4>

<ul>
  <li>The source parameter is required, and must refer to a local .msi file, a file from a mapped drive, or a UNC path. You can distribute packages as <code>file</code> resources. Puppet URLs are not currently supported for the <code>package</code> type&#8217;s <code>source</code> attribute.</li>
  <li>The <code>install_options</code> attribute is package-specific; refer to the documentation for the package you are trying to install.
    <ul>
      <li>Any file path arguments within the <code>install_options</code> attribute (such as <code>INSTALLDIR</code>) should use backslashes, not forward slashes.</li>
    </ul>
  </li>
  <li>As of Puppet 3.0, <code>windows</code> is the default provider parameter for all Windows packages. Using <code>msi</code> will result in a deprecation
warning.</li>
</ul>

<h3 id="serviceservice"><a href="./../references/latest/type.html#service"><code>service</code></a></h3>

<div class="highlight"><pre><code class="ruby">    <span class="n">service</span> <span class="p">{</span> <span class="s1">'mysql'</span><span class="p">:</span>
      <span class="k">ensure</span> <span class="o">=&gt;</span> <span class="s1">'running'</span><span class="p">,</span>
      <span class="n">enable</span> <span class="o">=&gt;</span> <span class="kp">true</span><span class="p">,</span>
    <span class="p">}</span>
</code></pre>
</div>

<p>Puppet can start, stop, enable, disable, list, query and configure services. It does not support configuring service dependencies, account to run as, or desktop interaction.</p>

<ul>
  <li>Use the short service name (e.g. <code>wuauserv</code>) in Puppet, not the display name (e.g. <code>Automatic Updates</code>).</li>
  <li>Setting the <code>enable</code> attribute to <code>true</code> will assign a service the &#8220;Automatic&#8221; startup type; setting <code>enable</code> to <code>manual</code> will assign the &#8220;Manual&#8221; startup type.</li>
</ul>

<h3 id="execexec"><a href="./../references/latest/type.html#exec"><code>exec</code></a></h3>

<p>Puppet can execute binaries (exe, com, bat, etc.), and can log the child process output and exit status.</p>

<ul>
  <li>If an extension for the <code>command</code> is not specified (for example, <code>ruby</code> instead of <code>ruby.exe</code>), Puppet will use the <code>PATHEXT</code> environment variable to resolve the appropriate binary. <code>PATHEXT</code> is a Windows-specific variable that lists the valid file extensions for executables.</li>
  <li>Puppet does not support a shell provider for Windows, so if you want to execute shell built-ins (e.g. <code>echo</code>), you must provide a complete <code>cmd.exe</code> invocation as the command. (For example, <code>command =&gt; 'cmd.exe /c echo "foo"'</code>.)</li>
  <li>When executing Powershell scripts, you must specify the <code>remotesigned</code> execution policy as part of the <code>powershell.exe</code> invocation:</li>
</ul>

<div class="highlight"><pre><code class="ruby">    <span class="nb">exec</span> <span class="p">{</span> <span class="s1">'test'</span><span class="p">:</span>
      <span class="n">command</span> <span class="o">=&gt;</span> <span class="s1">'C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -executionpolicy remotesigned -file C:\test.ps1'</span><span class="p">,</span>
    <span class="p">}</span>
</code></pre>
</div>

<h3 id="hosthost"><a href="./../references/latest/type.html#host"><code>host</code></a></h3>

<p>Puppet can manage entries in the hosts file in the same way that is supported on Unix platforms.</p>

              <blockquote><p style="font-size: 1.3em; text-align: center;"><a href="#content">&#8593; Back to top</a></p></blockquote>
            </div>
            <nav class="main">
                  <div id="subCol">


<ul>
<li><a href="./../windows/index.html">Overview</a></li>
<li><a href="./../windows/installing.html">Installing Puppet on Windows</a></li>
<li><a href="./../windows/running.html">Running Puppet on Windows</a></li>
<li><span class="currentpage">Writing Manifests for Windows</span></li>
<li><a href="./../windows/troubleshooting.html">Troubleshooting Puppet on Windows</a></li>
<li><a href="./../windows/from_source.html">Developers Only: Running Puppet from Source on Windows</a></li>
</ul>

                      <div style="margin-top: 1.5em; padding-bottom: 10px;">
                          <p style="font-family: 'Lucida Grande',Lucida,Verdana,sans-serif;font-size: 16px; font-weight: bold; line-height: 22px; margin-bottom: 10px;">Download the Docs</p>
                          <a href="http://info.puppetlabs.com/download-pdfs.html"><img src="./../images/smallbits_small_docs.png" alt="Puppet docs download" /></a>
                      </div>
                      <div style="margin-top: 0; padding-bottom: 10px;">
                          <p style="font-family: 'Lucida Grande',Lucida,Verdana,sans-serif;font-size: 16px; font-weight: bold; line-height: 22px; margin-bottom: 10px;">Download Puppet Enterprise</p>
                          <a href="http://info.puppetlabs.com/download-pe.html"><img src="./../images/puppet_cert_home.jpg" alt="Puppet Enterprise promo" /></a>
                      </div>
                  </div>
            </nav>
          </div>
        </div>
      </section>

		<footer id="footer">
      <div class="site-width">

        <div class="primary-secondary-content">
          <div class="primary-content">
            <section id="newsletter">
                 <h4>Puppet Labs is Hiring</h4>
                 <p><a href="http://www.puppetlabs.com/company/jobs/">Engineers, developers &amp; consultants</a>
                  </p><p>
		</p><h4>Newsletter</h4>

              <p>Stay up to date on all things puppet</p>

				<form class="lpeRegForm formNotEmpty" method="post" enctype="application/x-www-form-urlencoded" action="http://info.puppetlabs.com/index.php/leadCapture/save" id="mktForm_1013" name="mktForm_1013">

				<label>Email Address:</label><span class="mktInput"><input class="mktFormText mktFormEmail" name="Email" id="Email" type="text" value="" maxlength="255" /><span class="mktFormMsg"></span></span>

				<input id="mktFrmSubmit" type="submit" class="btn" style="width: auto; overflow: visible; padding-left: .25em; padding-right: .25em;" value="Subscribe" name="submitButton" onclick="formSubmit(document.getElementById(&quot;mktForm_1013&quot;)); return false;" />

				<input style="display: none;" id="mktFrmReset" type="reset" value="Clear" name="resetButton" onclick="formReset(document.getElementById(&quot;mktForm_1013&quot;)); return false;" />

				<span style="display:none;"><input type="text" name="_marketo_comments" value="" /></span>
				<input type="hidden" name="lpId" value="-1" />
				<input type="hidden" name="subId" value="100" />

				<input type="hidden" name="kw" value="" />
				<input type="hidden" name="cr" value="" />

				<input type="hidden" name="searchstr" value="" />
				<input type="hidden" name="lpurl" value="http://info.puppetlabs.com/testsubscription.html?cr={creative}&amp;kw={keyword}" />
				<input type="hidden" name="formid" value="1013" />
				<input type="hidden" name="returnURL" value="http://www.puppetlabs.com/misc/subscription-thank-you/" />
				<input type="hidden" name="retURL" value="http://www.puppetlabs.com/misc/subscription-thank-you/" />
				<input type="hidden" name="_mkt_disp" value="return" />
				<input type="hidden" name="_mkt_trk" value="" />

				</form>
				<script type="text/javascript" src="http://info.puppetlabs.com/js/mktFormSupport.js"></script>

				<script type="text/javascript"><![CDATA[
				function formSubmit(elt) {
				return Mkto.formSubmit(elt);
				}
				function formReset(elt) {
				return Mkto.formReset(elt);
				}
				]]></script>

<a href="http://info.puppetlabs.com/puppet-enterprise" class="fbtn">Try Puppet Enterprise FREE</a>

            </section>
            <section id="elsewhere">
              <h4>Get Involved</h4>
              <ul>

                <li class="chat"><a href="http://webchat.freenode.net/?channels=puppet" rel="external"><span class="indicator"></span><span>Chat with us on IRC</span></a></li>
		<li class="discussion"><a href="http://groups.google.com/group/puppet-dev" rel="external"><span class="indicator"></span><span>Join the Puppet Developer List</span></a></li>
                <li class="discussion"><a href="http://groups.google.com/group/puppet-users?pli=1" rel="external"><span class="indicator"></span><span>Join the Puppet User List</span></a></li>

                <li class="linkedin"><a href="http://www.linkedin.com/groups?about=&amp;gid=696467&amp;trk=anet_ug_grppro" rel="external"><span class="indicator"></span><span>Join the Puppet Users LinkedIn group</span></a></li>

              </ul>
		<p>
		              		</p><h4>Follow us&#8230;</h4>

              		<ul class="followus">


			<li><a href="http://feeds.feedburner.com/PuppetLabs" target="_blank"><img src="http://www.puppetlabs.com/wp-content/plugins/my-profiles/images/rss.png" border="0" /></a></li>
			<li><a href="http://www.facebook.com/pages/Puppet-Labs/219089920711" target="_blank"><img src="http://www.puppetlabs.com//wp-content/plugins/my-profiles/images/facebook.png" border="0" /></a></li>
			<li><a href="http://www.twitter.com/puppetlabs" target="_blank"><img src="http://www.puppetlabs.com//wp-content/plugins/my-profiles/images/twitter.png" border="0" /></a></li>
			<li><a href="http://www.linkedin.com/groups?about=&amp;gid=696467&amp;trk=anet_ug_grppro" target="_blank"><img src="http://www.puppetlabs.com//wp-content/uploads/2011/01/LinkedIn_IN_Icon_32px.png" border="0" /></a></li>    <li><a href="https://github.com/puppetlabs" target="_blank"><img src="http://www.puppetlabs.com//wp-content/uploads/2011/01/github_icon.png" border="0" /></a></li>
			<li><a href="https://plus.google.com/112682055028218091774?rel=author" target="_blank"><img src="https://puppetlabs.com/wp-content/uploads/2013/05/google_plus32x32.png" alt="Find Us on Google+" border="0" /></a></li>
					</ul>

              	

            </section>
          </div>
          <div class="secondary-content">
            <section id="book-it">
              <h4>Get the book!</h4>

              <p>James Turnbull and Jeff McCune's book <a href="http://www.apress.com/9781430230571" rel="nofollow">Pro Puppet</a> is a comprehensive and up-to-date look at Puppet and MCollective. </p>
              <a href="http://www.apress.com/9781430230571" rel="nofollow"><img src="http://www.puppetlabs.com/wp-content/uploads/2011/05/propuppetthumb.png" /></a>
            </section>
          </div>
        </div>
      </div>
		</footer>

    <div id="copyright">
      <div class="site-width">
        &#169; 2011 <a href="http://www.puppetlabs.com/" title="Puppet Labs">Puppet Labs</a>
        <span class="vcard">
         <span class="org"></span>
         <a class="email" href="mailto:info@puppetlabs.com">info@puppetlabs.com</a>

          <span class="adr">
           <span class="street-address">926 NW 13th Avenue #210</span>
           /
           <span class="locality">Portland</span>,
           <span class="region">OR</span>
           <span class="postal-code">97209</span>

          </span>

         <span class="tel">1-877-575-9775</span>
        </span>
      </div>
    </div>

  	<script type="text/javascript"><![CDATA[Cufon.now();]]></script>
  	<style type="text/css"><![CDATA[h1, h2, .btn { visibility : visible; }]]></style>


	</body>
</html>
