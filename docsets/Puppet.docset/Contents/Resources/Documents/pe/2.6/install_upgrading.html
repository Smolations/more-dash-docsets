<!DOCTYPE html>
<html dir="ltr" lang="en-US">
  <head>
  	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  	<title>PE 2.6  » Installing » Upgrading — Documentation — Puppet Labs</title>
  	<link rel="alternate" type="application/atom+xml" title="Puppet Labs Documentation Updates" href="https://github.com/puppetlabs/puppet-docs/commits/master.atom">
    <link rel="alternate" type="application/atom+xml" title="Puppet Labs Blog Feed" href="http://puppetlabs.com/feed/atom/">
    <link rel='index' title='Puppet Labs Documentation' href='http://docs.puppetlabs.com' />
    <link rel='icon' href='./../../favicon.ico' />


  <meta name="description" content="To upgrade from a previous version of Puppet Enterprise, use the same installer tarball as in a basic installation, but don&#8217;t run the puppet-...">



    <!-- FIXME: absolute paths -->

    <script type='text/javascript' src='./../../files/javascripts/html5.js'></script>
    <script type='text/javascript' src='./../../files/javascripts/jquery-1.3.2.min.js'></script>
    <script type='text/javascript' src='./../../files/javascripts/drop_down.js'></script>
    <script type='text/javascript' src='./../../files/javascripts/cufon-yui.js'></script>
    <script type='text/javascript' src='./../../files/fonts/Klavika_400-Klavika_600.font.js'></script>
    <script type='text/javascript' src='./../../files/javascripts/ampersands.js'></script>
    <script type='text/javascript' src='./../../files/javascripts/navigation-accordion.js'></script>

    <script type="text/javascript" src="http://puppetlabs.com/wp-content/themes/puppetlabs/javascripts/leadcapture.js"></script>

    <!-- All in One SEO Pack 1.6.10.1 by Michael Torbert of Semper Fi Web Design[127,146] -->
    <meta name="keywords" content="Puppet, puppet labs, reductive labs, open source, system administrator, ruby, data center, automation, support" />
    <!-- /all in one seo pack -->

    <!-- Give us the option of setting a canonical URL in yaml frontmatter -NF -->
    <link rel="canonical" href="http://docs.puppetlabs.com/pe/latest/install_upgrading.html" />

    <!-- FIXME: absolute paths -->

    <link rel="stylesheet" type="text/css" href="./../../files/stylesheets/style.css" media="screen">
    <link rel="stylesheet" type="text/css" href="./../../files/stylesheets/syntax.css" media="screen"> <!-- index -->
    <link rel="stylesheet" type="text/css" href="./../../files/stylesheets/adbanner.css" media="screen">

    <!--[if IE 7]>
	  <link rel="stylesheet" type="text/css" href="./../../files/stylesheets/ie_7.css" media="screen"> <!-- index -->
    <![endif]-->

    <!--[if IE 8]>
	    <link rel="stylesheet" type="text/css" href="./../../files/stylesheets/ie_8.css" media="screen"> <!-- index -->
    <![endif]-->

  	<script type="text/javascript">
      Cufon.replace('h1, h2', { fontWeight: '600' });
  	</script>
</head>




  <body id="puppetlabsdocs" class="docs">
  <style type="text/css">h1, h2{ visibility : hidden }</style>
  <!--[if IE 8]>
    <style type="text/css">h1, h2{ visibility : visible }</style>
  <![endif]-->

  	<header id="header">
      <div class="site-width">
    		<h1><a href="http://puppetlabs.com/"><span>Puppet Labs</span></a></h1>
        <a class="screen-reader-content" href="#content">Skip navigation</a>
        <nav>
    		<ul id="global-navigation">
          <li id="puppet-tab" class="with-submenu">
            <a href="http://puppetlabs.com/puppet/puppet-enterprise">
              <span>Products</span>
              <span class="drop-down-trigger"></span>
            </a>
            <ul>
			<li>
                <ul>
                   <a href="http://puppetlabs.com/puppet/what-is-puppet/">What is Puppet?</a>
                </ul>
              </li>
			       <li>
                <ul>
                   <a href="http://puppetlabs.com/puppet/puppet-enterprise/">Puppet Enterprise</a>
                </ul>
              </li>
            <li>
                <ul>
                   <a href="http://puppetlabs.com/puppet/whats-new/">What's New in 2.5</a>
                </ul>
              </li>
            <li>
                <ul>
                   <a href="http://puppetlabs.com/puppet/puppet-open-source/">Puppet Open Source</a>
                </ul>
              </li>
            <li>
                <ul>
                   <a href="http://puppetlabs.com/puppet/enterprise-vs-open-source/">Enterprise vs. Open Source</a>
                </ul>
              </li>
              <li>
                <ul>
                  <a href="http://forge.puppetlabs.com">Puppet Forge</a>
                </ul>
              </li>
              <li>
                <ul>
                  <a href="http://puppetlabs.com/puppet/requirements/">Components &amp; Requirements</a>
                </ul>
              </li>
              <li>
                <ul>
                  <a href="http://puppetlabs.com/puppet/faq/">FAQ</a>
                </ul>
              </li>
			  <li>
                <ul>
                  <a href="http://puppetlabs.com/puppet/how-to-buy/">How to Buy</a>
                </ul>
              </li>
            </ul>
          </li>
          <li id="solutions-tab" class="with-submenu">
            <a href="http://puppetlabs.com/solutions/">
              <span>Solutions</span>
              <span class="drop-down-trigger"></span>
            </a>
            <ul>
              <li class="page_item page-item-12296"><a href="http://puppetlabs.com/solutions/configuration-management/">Configuration Management</a></li>
<li class="page_item page-item-986"><a href="http://puppetlabs.com/solutions/virtualization-management/">Virtualization Management</a></li>
<li class="page_item page-item-993"><a href="http://puppetlabs.com/solutions/cloud-management/">Cloud Management</a></li>
<li class="page_item page-item-996"><a href="http://puppetlabs.com/solutions/it-compliance/">IT Compliance</a></li>
<li class="page_item page-item-9520"><a href="http://puppetlabs.com/solutions/devops/">DevOps</a></li>
<li class="page_item page-item-991"><a href="http://puppetlabs.com/solutions/manage-os-x-resources/">OS X Desktops</a></li>
            </ul>
          </li>
          <li id="services-tab" class="with-submenu">
            <a href="http://puppetlabs.com/services/">
              <span>Services</span>
              <span class="drop-down-trigger"></span>
            </a>
            <ul>
              <li class="page_item page-item-783"><a href="http://puppetlabs.com/services/overview/">Overview</a></li>
<li class="page_item page-item-1052"><a href="http://puppetlabs.com/services/customer-support/">Customer Support</a></li>
<li class="page_item page-item-11022"><a href="http://puppetlabs.com/services/support-plans/">Support Plans</a></li>
<li class="page_item page-item-845"><a href="http://puppetlabs.com/services/training-workshops/">On-Site Education</a></li>
<li class="page_item page-item-4899"><a href="http://puppetlabs.com/services/consulting/">Professional Services</a></li>
<li class="page_item page-item-849"><a href="http://puppetlabs.com/category/events/upcoming/">Events &amp; Workshops</a></li>
<li class="page_item page-item-851"><a href="http://puppetlabs.com/services/partners/">Partners</a></li>
            </ul>
          </li>
                    <li id="resources-tab" class="with-submenu">
            <a href="http://puppetlabs.com/resources/">
              <span>Resources</span>
              <span class="drop-down-trigger"></span>
            </a>
            <ul>
              <li class="page_item page-item-1048"><a href="http://puppetlabs.com/resources/overview-2/">Overview</a></li>
<li class="page_item page-item-1040"><a href="http://docs.puppetlabs.com">Documentation</a></li>
<li class="page_item page-item-872"><a href="http://info.puppetlabs.com/register-download">Downloads</a></li>
<li class="page_item page-item-1961"><a href="http://forge.puppetlabs.com">Puppet Forge</a></li>
<li class="page_item page-item-835"><a href="http://info.puppetlabs.com/download-whitepapers.html">White Papers</a></li>
<li class="page_item page-item-1967"><a href="http://projects.puppetlabs.com/projects/puppet/wiki">Wiki</a></li>
<li class="page_item page-item-7279"><a href="http://puppetlabs.com/resources/webinars/">Upcoming Webinars</a></li>
<li class="page_item page-item-10183"><a href="http://puppetlabs.com/resources/newsletter/">Newsletter</a></li>
<li class="page_item page-item-12263"><a href="http://puppetlabs.com/resources/tech-notes/">Tech Notes</a></li>
<li class="page_item page-item-10265"><a href="http://info.puppetlabs.com/pe2-webinar.html">Webinars</a></li>
            </ul>
          </li>

          <li id="customers-tab" class="with-submenu">
            <a href="http://puppetlabs.com/customers/companies/">
              <span>Customers</span>
              <span class="drop-down-trigger"></span>
            </a>
            <ul>
			<li>
                <ul>
                  <a href="http://puppetlabs.com/customers/companies/">Companies</a>
                </ul>
              </li>
			  <li>
                <ul>
                  <a href="http://puppetlabs.com/customers/case-studies/">Case Studies</a>
                </ul>
              </li>
			  <li>
                <ul>
                  <a href="http://puppetlabs.com/customers/product-testimonials/">Product Testimonials</a>
                </ul>
              </li>
			    <li>
                <ul>
                  <a href="http://puppetlabs.com/customers/what-customers-are-saying/">Service Testimonials</a>
                </ul>
              </li>
            </ul>
          </li>
          <li id="community-tab" class="with-submenu">
            <a href="http://puppetlabs.com/community/">
              <span>Community</span>
              <span class="drop-down-trigger"></span>
            </a>

 <ul>
			<li>
                <ul>
                  <a href="http://puppetlabs.com/community/overview/">Overview</a>
                </ul>
              </li>
			<li>
                <ul>
                  <a href="http://puppetlabs.com/blog">Blog</a>
                </ul>
              </li>
			  <li>
                <ul>
                  <a href="http://puppetlabs.com/community/puppet-camp/">Puppet Camp</a>
                </ul>
              </li>
			  <li>
                <ul>
                  <a href="http://puppetlabs.com/community/user-groups-and-devops-groups/">Puppet User Groups & DevOps Groups</a>
                </ul>
              </li>
	          <li>
                <ul>
                  <a href="http://puppetlabs.com/community/presentations/">Presentations</a>
                </ul>
              </li>
			    <li>
                <ul>
                  <a href="http://puppetlabs.com/community/videos/">Videos</a>
                </ul>
              </li>
            </ul>

          <li id="company-tab" class="with-submenu">
            <a href="http://puppetlabs.com/company/">
              <span>Company</span>
              <span class="drop-down-trigger"></span>
            </a>
            <ul>
              <li class="page_item page-item-2316"><a href="http://puppetlabs.com/company/overview/">Overview</a></li>
<li class="page_item page-item-2179"><a href="http://puppetlabs.com/company/news/">News</a>
<ul class='children'>
	<li class="page_item page-item-2338"><a href="http://puppetlabs.com/company/news/press-releases/">Press Releases</a></li>
	<li class="page_item page-item-2383"><a href="http://puppetlabs.com/company/news/media-kit/">Media Kit</a></li>
</ul>
</li>
<li class="page_item page-item-1571"><a href="http://puppetlabs.com/company/careers/">Careers</a></li>
<li class="page_item page-item-10372"><a href="http://puppetlabs.com/company/management/">Management</a></li>
<li class="page_item page-item-10311"><a href="http://puppetlabs.com/company/board-and-advisors/">Board and Advisors</a></li>
<li class="page_item page-item-10367"><a href="http://puppetlabs.com/company/investors/">Investors</a></li>
<li class="page_item page-item-2313"><a href="http://puppetlabs.com/company/contact-us/">Contact Us</a></li>
<li class="page_item page-item-10579"><a href="http://puppetlabs.com/company/awards/">Awards</a></li>
            </ul>
          </li>
    		</ul>
          <div id="misc-navigation">
			  <ul>
				<li><a href="http://puppetlabs.com/security/">Security</a></li>
				<li><a href="http://docs.puppetlabs.com">Documentation</a></li>
				<li><a href="http://puppetlabs.com/resources/customer-support/">Support</a></li>
			        <li><a href="http://projects.puppetlabs.com/">Bug Tracker</a></li>
				<li><a href="http://puppetlabs.com/company/contact/contact-us">Contact Us</a></li>
				<li><a href="http://info.puppetlabs.com/download-pe2.html" class="gateway">Download</a></li>
			  </ul>
			<form action="http://www.google.com/cse" id="cse-search-box">
			  <div>
				<input type="hidden" name="cx" value="017668764424496204839:ubligvgbenm" />
				<input type="hidden" name="ie" value="UTF-8" />
				<input type="text" name="q" class="gsc-input" size="31" />
				<input type="submit" name="sa" class="searchbtn" value="Search" />
			  </div>
			</form>
			<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&lang=en"></script>
          </div>
      </nav>
    	</div>
    </header>

      <section id="masthead">
        <div class="site-width">
          <h1>Docs: <span class="section-name">PE 2.6  » Installing » Upgrading</span></h1>
          <ul id="doc-navigation">
            <li><a href="./../../index.html">Docs Home</a></li>
            <li class="with-submenu">
              <a href="#">
                <span>Quick Nav</span>
                <span class="drop-down-trigger"></span>
              </a>
               <!-- the following links can't be relative, unfortunately -->
               <!-- future: add some JS to disable this if running from file:// -->
                               <dl>
                  <dt>Puppet Documentation</dt>
                      <dd><a href="./../../puppet/3/reference/index.html">Puppet 3 Reference Manual</a></dd>
                      <dd><a href="./../../puppet/2.7/reference/index.html">Puppet 2.7 Reference Manual</a></dd>
                      <dd><a href="./../../pe/latest/index.html">Puppet Enterprise User's Guide</a></dd>
                      <dd><a href="./../../learning/index.html">Learning Puppet</a></dd>
                      <dd><a href="./../../references/latest/type.html">Resource Types</a></dd>
                      <dd><a href="./../../references/latest/function.html">Functions</a></dd>
                      <dd><a href="./../../references/latest/configuration.html">Configuration</a></dd>
                      <dd><a href="./../../references/latest/developer/index.html">Developer</a></dd>
                      <dd><a href="./../../references/glossary.html">Glossary of Puppet Terms</a></dd>
                      <dd><a href="./../../references/index.html">Older References</a></dd>
                  <dt>Facter</dt>
                      <dd><a href="./../../facter/latest/core_facts.html">Core Facts Reference</a></dd>
                  <dt>PuppetDB</dt>
                      <dd><a href="./../../puppetdb/1/index.html">PuppetDB 1 Manual</a></dd>
                  <dt>MCollective</dt>
                      <dd><a href="./../../mcollective/index.html">Index</a></dd>
                      <dd><a href="./../../mcollective/reference/index.html">References</a></dd>
                      <dd><a href="./../../mcollective/simplerpc/index.html">Writing Plugins</a></dd>
                      <dd><a href="./../../mcollective/releasenotes.html">Release Notes</a></dd>
                </dl>

            </li>
            <li><a href="./../../contribute.html">Contribute</a></li>
          </ul>
        </div>
        <br />
      </section>

      <section id="content">
        <div class="site-width">
          <div class="primary-secondary-content">
            <div class="primary-content">
              <h1>Upgrading Puppet Enterprise</h1>
              <nav class="in-page" id="page-nav">
<ol class="toc">
  <li class="toc-lv2"><a href="#checking-for-updates">Checking For Updates</a></li>
  <li class="toc-lv2"><a href="#downloading-pe">Downloading PE</a></li>
  <li class="toc-lv2"><a href="#starting-the-upgrader">Starting the Upgrader</a>
<ol class="toc">
   <li class="toc-lv3"><a href="#upgrader-options">Upgrader Options</a></li>
</ol></li>
  <li class="toc-lv2"><a href="#configuring-the-upgrade">Configuring the Upgrade</a>
<ol class="toc">
   <li class="toc-lv3"><a href="#cloud-provisioner">Cloud Provisioner</a></li>
   <li class="toc-lv3"><a href="#vendor-packages">Vendor Packages</a></li>
   <li class="toc-lv3"><a href="#puppet-master-options">Puppet Master Options</a></li>
   <li class="toc-lv3"><a href="#console-options">Console Options</a></li>
</ol></li>
  <li class="toc-lv2"><a href="#upgrader-warnings">Upgrader Warnings</a></li>
  <li class="toc-lv2"><a href="#final-steps-from-pe-25-optional">Final Steps: From PE 2.5 (optional)</a></li>
  <li class="toc-lv2"><a href="#final-steps-from-pe-20-or-12">Final Steps: From PE 2.0 or 1.2</a></li>
  <li class="toc-lv2"><a href="#final-steps-from-pe-11-or-10">Final Steps: From PE 1.1 or 1.0</a>
<ol class="toc">
   <li class="toc-lv3"><a href="#stop-pe-httpd">Stop pe-httpd</a></li>
   <li class="toc-lv3"><a href="#create-a-new-inventory-database">Create a New Inventory Database</a></li>
   <li class="toc-lv3"><a href="#edit-puppet-masters-etcpuppetlabspuppetpuppetconf">Edit Puppet Master&#8217;s /etc/puppetlabs/puppet/puppet.conf</a></li>
   <li class="toc-lv3"><a href="#edit-puppet-masters-etcpuppetlabspuppetauthconf">Edit Puppet Master&#8217;s /etc/puppetlabs/puppet/auth.conf</a></li>
   <li class="toc-lv3"><a href="#edit-etcpuppetlabspuppetmanifestssitepp">Edit /etc/puppetlabs/puppet/manifests/site.pp</a></li>
   <li class="toc-lv3"><a href="#edit-etcpuppetlabspuppet-dashboardsettingsyml">Edit /etc/puppetlabs/puppet-dashboard/settings.yml</a></li>
   <li class="toc-lv3"><a href="#generate-and-sign-console-certificates">Generate and Sign Console Certificates</a></li>
   <li class="toc-lv3"><a href="#start-pe-httpd">Start pe-httpd</a></li>
   <li class="toc-lv3"><a href="#edit-puppetconf-on-each-agent-node">Edit puppet.conf on Each Agent Node</a></li>
</ol></li>
</ol></nav>
              <p>To upgrade from a previous version of Puppet Enterprise, use the same installer tarball as in a basic installation, but <strong>don&#8217;t</strong> run the <code>puppet-enterprise-installer</code> script. Instead, run <code>puppet-enterprise-upgrader</code>.</p>

<p>Depending on the version you upgrade from, <strong>you may need to take extra steps</strong> after running the upgrader. See below for your specific version.</p>

<blockquote>
  <p><img src="./images/windows-logo-small.jpg" alt="windows logo" /> To upgrade Windows nodes, simply download and run the new MSI package as described in <a href="./install_windows.html">Installing Windows Agents</a>.</p>
</blockquote>

<p><strong>Note that if your console database is very large, the upgrader may take a long time on the console node, possibly thirty minutes or more.</strong> This is due to a resource-intensive database migration that must be run. Make sure that you schedule your upgrade appropriately, and avoid interrupting the upgrade process.</p>

<p><strong>Warning:</strong> If you have created custom modules and stored them in  <code>/opt/puppet/share/puppet/modules</code>, the upgrader will fail. Before upgrading, you should move your custom modules to <code>/etc/puppetlabs/puppet/modules</code>. Alternatively, you can update your modules manually to have the correct metadata.</p>

<blockquote>
  <p><strong>NOTE:</strong> If you are upgrading from PE 1.2.5, make sure your upgrader is for version 2.6.1 or newer. Going from 1.2.5 to 2.6.0 on SLES systems may cause upgrade failures, which can be fixed by running the 2.6.1 upgrader.</p>
</blockquote>

<h2 id="checking-for-updates">Checking For Updates</h2>

<p><a href="http://info.puppetlabs.com/download-pe.html">Check here</a> to find out what the latest maintenance release of Puppet Enterprise is. You can run <code>puppet --version</code> at the command line to see the version of PE you are currently running.</p>

<h2 id="downloading-pe">Downloading PE</h2>

<p>See the <a href="./install_basic.html#downloading-pe">Installing PE</a> of this guide for information on downloading Puppet Enterprise tarballs.</p>

<h2 id="starting-the-upgrader">Starting the Upgrader</h2>

<p>The upgrader must be run with root privileges:</p>

<pre><code># ./puppet-enterprise-upgrader
</code></pre>

<p>This will start the upgrader in interactive mode. If the puppet master role and the console role are installed on different servers, <strong>you must upgrade the puppet master first.</strong></p>

<p><strong>Note that if your console database is very large, the upgrader may take a long time on the console node, possibly thirty minutes or more.</strong> This is due to a resource-intensive database migration that must be run. Make sure that you schedule your upgrade appropriately, and avoid interrupting the upgrade process.</p>

<h3 id="upgrader-options">Upgrader Options</h3>

<p>Like the installer, the upgrade will accept some command-line options:</p>

<dl>
  <dt><code>-h</code></dt>
  <dd>Display a brief help message.</dd>
  <dt><code>-s &lt;ANSWER FILE&gt;</code></dt>
  <dd>Save answers to file and quit without installing.</dd>
  <dt><code>-a &lt;ANSWER FILE&gt;</code></dt>
  <dd>Read answers from file and fail if an answer is missing. See the <a href="./install_answer_file_reference.html#upgrader-answers">upgrader answers section</a> of the answer file reference for a list of available answers.</dd>
  <dt><code>-A &lt;ANSWER FILE&gt;</code></dt>
  <dd>Read answers from file and prompt for input if an answer is missing. See the <a href="./install_answer_file_reference.html#upgrader-answers">upgrader answers section</a> of the answer file reference for a list of available answers.</dd>
  <dt><code>-D</code></dt>
  <dd>Display debugging information.</dd>
  <dt><code>-l &lt;LOG FILE&gt;</code></dt>
  <dd>Log commands and results to file.</dd>
  <dt><code>-n</code></dt>
  <dd>Run in &#8216;noop&#8217; mode; show commands that would have been run during installation without running them.</dd>
</dl>

<p>Non-interactive upgrades work identically to non-interactive installs, albeit with different answers available.</p>

<h2 id="configuring-the-upgrade">Configuring the Upgrade</h2>

<p>The upgrader will ask you the following questions:</p>

<h3 id="cloud-provisioner">Cloud Provisioner</h3>

<p>PE 2.6 includes a cloud provisioner tool that can be installed on trusted nodes where administrators have shell access. On nodes which lack the cloud provisioner role, you&#8217;ll be asked whether you wish to install it.</p>

<h3 id="vendor-packages">Vendor Packages</h3>

<p>If PE 2.6 needs any packages from your OS&#8217;s repositories, it will ask permission to install them.</p>

<h3 id="puppet-master-options">Puppet Master Options</h3>

<h4 id="removing-mcos-home-directory">Removing <code>mco</code>&#8217;s home directory</h4>

<p>When upgrading from PE 1.2, the <code>mco</code> user gets deleted during the upgrade and is replaced with the <code>peadmin</code> user.</p>

<p>If the <code>mco</code> user had any preference files or documents you need, you should tell the upgrader to preserve the <code>mco</code> user&#8217;s home directory; otherwise, it will be deleted.</p>

<h4 id="installing-wrapper-modules">Installing Wrapper Modules</h4>

<p>When upgrading from PE 1.2, the <code>mcollectivepe</code>, <code>accounts</code>, and <code>baselines</code> modules will be renamed to <code>pe_mcollective, pe_accounts,</code> and <code>pe_compliance</code>, respectively. If you have used any of these modules by their previous names, you should install the wrapper modules so your site will continue to work while you switch over.</p>

<h3 id="console-options">Console Options</h3>

<h4 id="admin-user-email-and-password">Admin User Email and Password</h4>

<p>The console now uses role-based user authentication. You will be asked for an email address and password for the initial admin user; additional users <a href="./console_auth.html">can be configured after the upgrade is completed</a>.</p>

<h2 id="upgrader-warnings">Upgrader Warnings</h2>

<p>On console servers, the upgrader will check your MySQL server&#8217;s <code>innodb_buffer_pool_size</code> setting. If it is too small, the upgrader will advise you to increase it.</p>

<p>If you receive a warning about the <code>innodb_buffer_pool_size</code> setting, you should:</p>

<ul>
  <li>Cancel the upgrade and exit the upgrader.</li>
  <li><a href="./config_advanced.html#increasing-the-mysql-buffer-pool-size">Follow these instructions</a> to increase the buffer size.</li>
  <li>Re-run the upgrader and allow it to finish.</li>
</ul>

<h2 id="final-steps-from-pe-25-optional">Final Steps: From PE 2.5 (optional)</h2>

<p>If your console server has ever run PE 2.5, two of its config files will be lacking commented-out example code that is useful when <a href="./console_auth.html#using-third-party-authentication-services">enabling third-party authentication services</a>. If you expect to use LDAP, ActiveDirectory, or Google to authenticate console users in the future, you may want to copy the example code into place.</p>

<ul>
  <li>Edit <code>/etc/puppetlabs/console-auth/cas_client_config.yml</code> to resemble the <code>cas_client_config.yml.rpmnew</code> or <code>cas_client_config.yml.dpkg-new</code> file in the same directory.</li>
  <li>Edit <code>/etc/puppetlabs/rubycas-server/config.yml</code> to resemble the <code>config.yml.rpmnew</code> or <code>config.yml.dpkg-new</code> file in the same directory.</li>
</ul>

<h2 id="final-steps-from-pe-20-or-12">Final Steps: From PE 2.0 or 1.2</h2>

<ul>
  <li>If you received an upgrader warning on your console server as <a href="#upgrader-warnings">described above</a>, be sure to increase your MySQL server&#8217;s <code>innodb_buffer_pool_size</code>.</li>
</ul>

<p>Otherwise, no extra steps are needed when upgrading from PE 2.0 or 1.2.</p>

<p><strong>Note that some features may not be available until puppet agent has run once on every node.</strong> In normal installations, this means all features will be available within 30 minutes after upgrading all nodes.</p>

<h2 id="final-steps-from-pe-11-or-10">Final Steps: From PE 1.1 or 1.0</h2>

<p><strong>Important note: Upgrades from some configurations of PE 1.1 and 1.0 aren&#8217;t fully supported.</strong> To upgrade from PE 1.1 or 1.0, <strong>you must have originally installed the puppet master and Puppet Dashboard roles on the same node.</strong> Contact Puppet Labs support for help with other configurations on a case-by-case basis, and see <a href="http://projects.puppetlabs.com/issues/10872">issue #10872</a> for more information.</p>

<p>After running the upgrader on the puppet master/Dashboard (now console) node, you must:</p>

<ul>
  <li>Stop the <code>pe-httpd</code> service</li>
  <li>Create a new database for the inventory service and grant all permissions on it to the console&#8217;s MySQL user.</li>
  <li>Manually edit the puppet master&#8217;s <code>puppet.conf</code>, <code>auth.conf</code>, <code>site.pp</code>, and <code>settings.yml</code> files</li>
  <li>Generate and sign certificates for the console, to enable inventory and filebucket viewing.</li>
  <li>Edit <code>passenger-extra.conf</code></li>
  <li>Restart the <code>pe-httpd</code> service.</li>
</ul>

<p>You can upgrade agent nodes after upgrading the puppet master and console. After upgrading an agent node, you must:</p>

<ul>
  <li>Manually edit <code>puppet.conf</code>.</li>
</ul>

<h3 id="stop-pe-httpd">Stop <code>pe-httpd</code></h3>

<p>For the duration of these manual steps, Puppet Enterprise&#8217;s web server should be stopped.</p>

<pre><code>$ sudo /etc/init.d/pe-httpd stop
</code></pre>

<h3 id="create-a-new-inventory-database">Create a New Inventory Database</h3>

<p>To support the inventory service, you must manually create a new database for puppet master to store node facts in. To do this, use the <code>mysql</code> client on the node running the database server. (This will almost always be the same server running the puppet master and console.)</p>

<pre><code># mysql -uroot -p
Enter password:
mysql&gt; CREATE DATABASE console_inventory_service;
mysql&gt; GRANT ALL PRIVILEGES ON console_inventory_service.* TO '&lt;USER&gt;'@'localhost';
</code></pre>

<p>Replace <code>&lt;USER&gt;</code> with the MySQL user name you gave Dashboard during your original installation.</p>

<h3 id="edit-puppet-masters-etcpuppetlabspuppetpuppetconf">Edit Puppet Master&#8217;s <code>/etc/puppetlabs/puppet/puppet.conf</code></h3>

<ul>
  <li>
    <p>To support the inventory service, you must configure Puppet to save facts to a MySQL database.</p>

    <pre><code>  [master]
      # ...
      facts_terminus = inventory_active_record
      dbadapter = mysql
      dbname = console_inventory_service
      dbuser = &lt;CONSOLE/DASHBOARD'S MYSQL USER&gt;
      dbpassword = &lt;PASSWORD FOR CONSOLE'S MYSQL USER&gt;
      dbserver = localhost
</code></pre>

    <p>If you chose a different MySQL user name for Puppet Dashboard when you originally installed PE, use that user name as the <code>dbuser</code> instead of &#8220;dashboard&#8221;. If the database is served by a remote machine, use that server&#8217;s hostname instead of &#8220;localhost&#8221;.</p>
  </li>
  <li>
    <p>If you configured the puppet master to not send reports to the Dashboard, you must configure it to report to the console now:</p>

    <pre><code>  [master]
      # ...
      reports = https, store
      reporturl = https://&lt;CONSOLE HOSTNAME&gt;:&lt;PORT&gt;/reports/upload
</code></pre>
  </li>
  <li>
    <p>Puppet agent on this node also has some new requirements:</p>

    <pre><code>  [agent]
      # support filebucket viewing when using compliance features:
      archive_files = true
      # if you didn't originally enable pluginsync, enable it now:
      pluginsync = true
</code></pre>
  </li>
</ul>

<h3 id="edit-puppet-masters-etcpuppetlabspuppetauthconf">Edit Puppet Master&#8217;s <code>/etc/puppetlabs/puppet/auth.conf</code></h3>

<p>To support the inventory service, you must add the following two stanzas to your puppet master&#8217;s <a href="./../../guides/rest_auth_conf.html"><code>auth.conf</code></a> file:</p>

<pre><code># Allow the console to retrieve inventory facts:

path /facts
auth yes
method find, search
allow pe-internal-dashboard

# Allow puppet master to save facts to the inventory:

path /facts
auth yes
method save
allow &lt;PUPPET MASTER'S CERTNAME&gt;
</code></pre>

<p>These stanzas <strong>must</strong> be inserted <strong>before</strong> the final stanza, which looks like this:</p>

<pre><code>path /
auth any
</code></pre>

<p>If you paste the new stanzas after this final stanza, they will not take effect.</p>

<h3 id="edit-etcpuppetlabspuppetmanifestssitepp">Edit <code>/etc/puppetlabs/puppet/manifests/site.pp</code></h3>

<p>You must add the following lines to site.pp in order to view file contents in the console:</p>

<pre><code># specify remote filebucket
filebucket { 'main':
  server =&gt; '&lt;puppet master's hostname&gt;',
  path =&gt; false,
}

File { backup =&gt; 'main' }
</code></pre>

<h3 id="edit-etcpuppetlabspuppet-dashboardsettingsyml">Edit <code>/etc/puppetlabs/puppet-dashboard/settings.yml</code></h3>

<p>Change the following three settings to point to one of the puppet master&#8217;s valid DNS names:</p>

<pre><code>ca_server: '&lt;PUPPET MASTER HOSTNAME&gt;'
inventory_server: '&lt;PUPPET MASTER HOSTNAME&gt;'
file_bucket_server: '&lt;PUPPET MASTER HOSTNAME&gt;'
</code></pre>

<p>Change the following two settings to true:</p>

<pre><code>enable_inventory_service: true
use_file_bucket_diffs: true
</code></pre>

<p>Ensure that the following settings exist and are set to the suggested values; if any are missing, you will need to add them to <code>settings.yml</code> yourself:</p>

<pre><code>private_key_path: 'certs/pe-internal-dashboard.private_key.pem'
public_key_path: 'certs/pe-internal-dashboard.public_key.pem'
ca_crl_path: 'certs/pe-internal-dashboard.ca_crl.pem'
ca_certificate_path: 'certs/pe-internal-dashboard.ca_cert.pem'
certificate_path: 'certs/pe-internal-dashboard.cert.pem'
key_length: 1024
cn_name: 'pe-internal-dashboard'
</code></pre>

<h3 id="generate-and-sign-console-certificates">Generate and Sign Console Certificates</h3>

<p>First, navigate to the console&#8217;s installation directory:</p>

<pre><code>$ cd /opt/puppet/share/puppet-dashboard
</code></pre>

<p>Next, start a temporary WEBrick puppet master:</p>

<pre><code>$ sudo /opt/puppet/bin/puppet master
</code></pre>

<p>Next, create a keypair and request a certificate:</p>

<pre><code>$ sudo /opt/puppet/bin/rake cert:create_key_pair
$ sudo /opt/puppet/bin/rake cert:request
</code></pre>

<p>Next, sign the certificate request:</p>

<pre><code>$ sudo /opt/puppet/bin/puppet cert sign dashboard
</code></pre>

<p>Next, retrieve the signed certificate:</p>

<pre><code>$ sudo /opt/puppet/bin/rake cert:retrieve
</code></pre>

<p>Next, stop the temporary puppet master:</p>

<pre><code>$ sudo kill $(cat $(puppet master --configprint pidfile) )
</code></pre>

<p>Finally, chown the certificates directory to <code>puppet-dashboard</code>:</p>

<pre><code>$ sudo chown -R puppet-dashboard:puppet-dashboard certs
</code></pre>

<h4 id="troubleshooting">Troubleshooting</h4>

<p>If these rake tasks fail with errors like <code>can't convert nil into String</code>, you may be missing a certificate-related setting from the <code>settings.yml</code> file. Go back to the previous section and make sure all of the required settings exist.</p>

<h3 id="start-pe-httpd">Start <code>pe-httpd</code></h3>

<p>You can now start PE&#8217;s web server again.</p>

<pre><code>$ sudo /etc/init.d/pe-httpd start
</code></pre>

<h3 id="edit-puppetconf-on-each-agent-node">Edit <code>puppet.conf</code> on Each Agent Node</h3>

<p>On each agent node you upgrade to PE 2.6, make the following edits to <code>/etc/puppetlabs/puppet/puppet.conf</code>:</p>

<pre><code>[agent]
    # support filebucket viewing when using compliance features:
    archive_files = true
    # if you didn't originally enable pluginsync, enable it now:
    pluginsync = true
</code></pre>

<hr />

<ul>
  <li><a href="./install_uninstalling.html">Next: Uninstalling</a></li>
</ul>

              <blockquote><p style="font-size: 1.3em; text-align: center;"><a href="#content">↑ Back to top</a></p></blockquote>
            </div>
            <nav class="main">
                  <div id="subCol">


<p class="versionnote">A newer version of Puppet Enterprise has been released!</p>
<ul class="versionnote">
  <li><a href="http://info.puppetlabs.com/download-pe.html">Download PE 3.0</a>.</li>
  <li><a href="./../../pe/3.0/index.html">PE 3.0 user's guide</a></li>
  <li><a href="./../../pe/latest/install_upgrading.html">Jump to newest version of this page</a></li>
</ul>


<h3><a href="./index.html">Puppet Enterprise 2.6</a></h3>

<ul>
  <li><strong>Overview</strong>
    <ul>
      <li><a href="./overview_about_pe.html">About Puppet Enterprise</a></li>
      <li><a href="./overview_whats_new.html">New Features</a></li>
      <li><a href="./overview_getting_support.html">Getting Support</a></li>
    </ul>
  </li>
  <li><strong>Quick Start</strong>
    <ul>
        <li><a href="./quick_start.html">Quick Start: Using PE</a></li>
        <li><a href="./quick_writing.html">Quick Start: Writing Modules</a></li>
    </ul>
  </li>
  <li><strong>Installing Puppet Enterprise</strong>
    <ul>
      <li><a href="./install_system_requirements.html">System Requirements</a></li>
      <li><a href="./install_basic.html">Installing PE</a></li>
      <li><a href="./install_windows.html">Installing Windows Agents</a></li>
      <li><span class="currentpage">Upgrading</span></li>
      <li><a href="./install_uninstalling.html">Uninstalling</a></li>
      <li><a href="./install_automated.html">Automated Installation</a></li>
      <li><a href="./install_answer_file_reference.html">Answer File Reference</a></li>
      <li><a href="./install_what_and_where.html">What gets installed where?</a></li>
    </ul>
  </li>
  <li><strong>The Console</strong>
    <ul>
      <li><a href="./console_accessing.html">Accessing the Console</a></li>
      <li><a href="./console_navigating.html">Navigating the Console</a></li>
      <li><a href="./console_reports.html">Viewing Reports and Inventory Data</a></li>
      <li><a href="./console_auth.html">Managing Users</a></li>
      <li><a href="./console_classes_groups.html">Grouping and Classifying Nodes</a></li>
      <li><a href="./console_live.html">Live Management</a></li>
      <li><a href="./console_live_resources.html">Live Management: Managing Resources</a></li>
      <li><a href="./console_live_puppet.html">Live Management: Controlling Puppet</a></li>
      <li><a href="./console_live_advanced.html">Live Management: Advanced Tasks</a></li>
      <li><a href="./console_maintenance.html">Console Maintenance</a></li>
    </ul>
  </li>
  <li><strong>Puppet</strong>
    <ul>
      <li><a href="./puppet_overview.html">Overview</a></li>
      <li><a href="./puppet_tools.html">Tools</a></li>
      <li><a href="./puppet_modules_manifests.html">Modules and Manifests</a></li>
      <li><a href="./puppet_data_library.html">Puppet Data Library</a></li>
      <li><a href="./puppet_references.html">References</a></li>
    </ul>
  </li>
   <li><strong>Configuring Puppet Enterprise</strong>
    <ul>
     <li><a href="./config_advanced.html">Advanced Configuration</a></li>
     <li><a href="./config_installing_additional.html">Installing Additional Components</a></li>
    </ul>
  </li>
  <li><strong>Orchestration</strong>
    <ul>
      <li><a href="./orchestration_overview.html">Overview</a></li>
      <li><a href="./orchestration_usage.html">Usage and Examples</a></li>
    </ul>
  </li>
  <li><strong>Cloud Provisioning</strong>
    <ul>
      <li><a href="./cloudprovisioner_overview.html">Overview</a></li>
      <li><a href="./cloudprovisioner_configuring.html">Installing & Configuring Cloud Provisioner</a></li>
      <li><a href="./cloudprovisioner_classifying_installing.html">Classifying Nodes & Remotely Installing Puppet</a></li>
      <li><a href="./cloudprovisioner_vmware.html">Provisioning with VMware</a></li>
      <li><a href="./cloudprovisioner_aws.html">Provisioning with AWS</a></li>
      <li><a href="./cloudprovisioner_workflow.html">Sample Workflow</a></li>
      <li><a href="./cloudprovisioner_troubleshooting.html">Troubleshooting</a></li>
    </ul>
  </li>
  <li><strong>The Compliance Workflow</strong>
    <ul>
      <li><a href="./compliance_basics.html">Basics and UI</a></li>
      <li><a href="./compliance_using.html">Using the Compliance Workflow</a></li>
      <li><a href="./compliance_tutorial.html">Tutorial</a></li>
    </ul>
  </li>
  <li><strong>The PE Accounts Module</strong>
    <ul>
      <li><a href="./accounts_user_type.html">The pe_accounts::user Type</a></li>
      <li><a href="./accounts_class.html">The pe_accounts Class</a></li>
    </ul>
  </li>
  <li><strong>Troubleshooting</strong>
    <ul>
     <li> <a href="./trouble_common_problems.html">Common Problems & Solutions</a></li>
    </ul>
  </li>
  <li><strong>Appendix</strong>
    <ul>
      <li><a href="./appendix.html#release-notes">Release Notes</a></li>
      <li><a href="./appendix.html#known-issues">Known Issues</a></li>
    </ul>
  </li>
</ul>




                      <div style="margin-top: 1.5em; padding-bottom: 10px;">
                          <p style="font-family: 'Lucida Grande',Lucida,Verdana,sans-serif;font-size: 16px; font-weight: bold; line-height: 22px; margin-bottom: 10px;">Download the Docs</p>
                          <a href="http://info.puppetlabs.com/download-pdfs.html"><img src="./../../images/smallbits_small_docs.png" alt="Puppet docs download"></a>
                      </div>
                      <div style="margin-top: 0; padding-bottom: 10px;">
                          <p style="font-family: 'Lucida Grande',Lucida,Verdana,sans-serif;font-size: 16px; font-weight: bold; line-height: 22px; margin-bottom: 10px;">Download Puppet Enterprise</p>
                          <a href="http://info.puppetlabs.com/download-pe.html"><img src="./../../images/puppet_cert_home.jpg" alt="Puppet Enterprise promo"></a>
                      </div>
                  </div>
            </nav>
          </div>
        </div>
      </section>

		<footer id="footer">
      <div class="site-width">

        <div class="primary-secondary-content">
          <div class="primary-content">
            <section id="newsletter">
                 <h4>Puppet Labs is Hiring</h4>
                 <p><a href="http://www.puppetlabs.com/company/jobs/">Engineers, developers & consultants</a>
                  <p>
		<h4>Newsletter</h4>

              <p>Stay up to date on all things puppet</p>

				<form class="lpeRegForm formNotEmpty" method="post" enctype="application/x-www-form-urlencoded" action="http://info.puppetlabs.com/index.php/leadCapture/save"; id="mktForm_1013" name="mktForm_1013">

				<label>Email Address:</label><span class='mktInput'><input class='mktFormText mktFormEmail' name="Email" id="Email" type='text' value="" maxlength='255'  /><span class='mktFormMsg'></span></span>

				<input id='mktFrmSubmit' type='submit' class='btn' style="width: auto; overflow: visible; padding-left: .25em; padding-right: .25em;" value='Subscribe' name='submitButton' onclick='formSubmit(document.getElementById("mktForm_1013")); return false;' />

				<input style='display: none;' id='mktFrmReset' type='reset' value='Clear' name='resetButton' onclick='formReset(document.getElementById("mktForm_1013")); return false;' />

				<span style="display:none;"><input type="text" name="_marketo_comments" value="" /></span>
				<input type="hidden" name="lpId" value="-1" />
				<input type="hidden" name="subId" value="100" />

				<input type="hidden" name="kw" value="" />
				<input type="hidden" name="cr" value="" />

				<input type="hidden" name="searchstr" value="" />
				<input type="hidden" name="lpurl" value="http://info.puppetlabs.com/testsubscription.html?cr={creative}&kw={keyword}"; />
				<input type="hidden" name="formid" value="1013" />
				<input type="hidden" name="returnURL" value="http://www.puppetlabs.com/misc/subscription-thank-you/"; />
				<input type="hidden" name="retURL" value="http://www.puppetlabs.com/misc/subscription-thank-you/"; />
				<input type="hidden" name="_mkt_disp" value="return" />
				<input type="hidden" name="_mkt_trk" value="" />

				</form>
				<script type="text/javascript" src="http://info.puppetlabs.com/js/mktFormSupport.js"></script>

				<script type="text/javascript">
				function formSubmit(elt) {
				return Mkto.formSubmit(elt);
				}
				function formReset(elt) {
				return Mkto.formReset(elt);
				}
				</script>

<a href="http://info.puppetlabs.com/puppet-enterprise" class="fbtn">Try Puppet Enterprise FREE</a>

            </section>
            <section id="elsewhere">
              <h4>Get Involved</h4>
              <ul>

                <li class="chat"><a href="http://webchat.freenode.net/?channels=puppet" rel="external"><span class="indicator"></span><span>Chat with us on IRC</span></a></li>
		<li class="discussion"><a href="http://groups.google.com/group/puppet-dev" rel="external"><span class="indicator"></span><span>Join the Puppet Developer List</span></a></li>
                <li class="discussion"><a href="http://groups.google.com/group/puppet-users?pli=1" rel="external"><span class="indicator"></span><span>Join the Puppet User List</span></a></li>

                <li class="linkedin"><a href="http://www.linkedin.com/groups?about=&gid=696467&trk=anet_ug_grppro" rel="external"><span class="indicator"></span><span>Join the Puppet Users LinkedIn group</span></a></li>

              </ul>
		<p>
		              		<h4>Follow us&#8230;</h4>

              		<ul class="followus">


			<li><a href="http://feeds.feedburner.com/PuppetLabs" target="_blank"><img src="http://www.puppetlabs.com/wp-content/plugins/my-profiles/images/rss.png" border="0"></a></li>
			<li><a href="http://www.facebook.com/pages/Puppet-Labs/219089920711" target="_blank"><img src="http://www.puppetlabs.com//wp-content/plugins/my-profiles/images/facebook.png" border="0"></a></li>
			<li><a href="http://www.twitter.com/puppetlabs" target="_blank"><img src="http://www.puppetlabs.com//wp-content/plugins/my-profiles/images/twitter.png" border="0"></a></li>
			<li><a href="http://www.linkedin.com/groups?about=&amp;gid=696467&amp;trk=anet_ug_grppro" target="_blank"><img src="http://www.puppetlabs.com//wp-content/uploads/2011/01/LinkedIn_IN_Icon_32px.png" border="0"></a></li>    <li><a href="https://github.com/puppetlabs" target="_blank"><img src="http://www.puppetlabs.com//wp-content/uploads/2011/01/github_icon.png" border="0"></a></li>
			<li><a href="https://plus.google.com/112682055028218091774?rel=author" target="_blank"><img src="https://puppetlabs.com/wp-content/uploads/2013/05/google_plus32x32.png" alt="Find Us on Google+" border="0"></a></li>
					</ul>

              	</p>

            </section>
          </div>
          <div class="secondary-content">
            <section id="book-it">
              <h4>Get the book!</h4>

              <p>James Turnbull and Jeff McCune's book <a href="http://www.apress.com/9781430230571" rel="nofollow">Pro Puppet</a> is a comprehensive and up-to-date look at Puppet and MCollective. </p>
              <a href="http://www.apress.com/9781430230571" rel="nofollow"><img src="http://www.puppetlabs.com/wp-content/uploads/2011/05/propuppetthumb.png" /></a>
            </section>
          </div>
        </div>
      </div>
		</footer>

    <div id="copyright">
      <div class="site-width">
        &copy; 2011 <a href="http://www.puppetlabs.com/" title="Puppet Labs">Puppet Labs</a>
        <span class="vcard">
         <span class="org"></span>
         <a class="email" href="mailto:info@puppetlabs.com">info@puppetlabs.com</a>

          <span class="adr">
           <span class="street-address">926 NW 13th Avenue #210</span>
           /
           <span class="locality">Portland</span>,
           <span class="region">OR</span>
           <span class="postal-code">97209</span>

          </span>

         <span class="tel">1-877-575-9775</span>
        </span>
      </div>
    </div>

  	<script type="text/javascript">Cufon.now();</script>
  	<style type="text/css">h1, h2, .btn { visibility : visible; }</style>


	</body>
</html>
