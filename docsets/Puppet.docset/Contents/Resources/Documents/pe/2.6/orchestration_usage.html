<!DOCTYPE html>
<html dir="ltr" lang="en-US">
  <head>
  	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  	<title>PE 2.6  » Orchestration » Usage — Documentation — Puppet Labs</title>
  	<link rel="alternate" type="application/atom+xml" title="Puppet Labs Documentation Updates" href="https://github.com/puppetlabs/puppet-docs/commits/master.atom">
    <link rel="alternate" type="application/atom+xml" title="Puppet Labs Blog Feed" href="http://puppetlabs.com/feed/atom/">
    <link rel='index' title='Puppet Labs Documentation' href='http://docs.puppetlabs.com' />
    <link rel='icon' href='./../../favicon.ico' />


  <meta name="description" content="   NOTE: Orchestration and MCollective are not yet supported on Windows nodes.Running ActionsOrchestration actions are grouped and distributed as M...">



    <!-- FIXME: absolute paths -->

    <script type='text/javascript' src='./../../files/javascripts/html5.js'></script>
    <script type='text/javascript' src='./../../files/javascripts/jquery-1.3.2.min.js'></script>
    <script type='text/javascript' src='./../../files/javascripts/drop_down.js'></script>
    <script type='text/javascript' src='./../../files/javascripts/cufon-yui.js'></script>
    <script type='text/javascript' src='./../../files/fonts/Klavika_400-Klavika_600.font.js'></script>
    <script type='text/javascript' src='./../../files/javascripts/ampersands.js'></script>
    <script type='text/javascript' src='./../../files/javascripts/navigation-accordion.js'></script>

    <script type="text/javascript" src="http://puppetlabs.com/wp-content/themes/puppetlabs/javascripts/leadcapture.js"></script>

    <!-- All in One SEO Pack 1.6.10.1 by Michael Torbert of Semper Fi Web Design[127,146] -->
    <meta name="keywords" content="Puppet, puppet labs, reductive labs, open source, system administrator, ruby, data center, automation, support" />
    <!-- /all in one seo pack -->

    <!-- Give us the option of setting a canonical URL in yaml frontmatter -NF -->
    <link rel="canonical" href="http://docs.puppetlabs.com/pe/latest/orchestration_invoke_cli.html" />

    <!-- FIXME: absolute paths -->

    <link rel="stylesheet" type="text/css" href="./../../files/stylesheets/style.css" media="screen">
    <link rel="stylesheet" type="text/css" href="./../../files/stylesheets/syntax.css" media="screen"> <!-- index -->
    <link rel="stylesheet" type="text/css" href="./../../files/stylesheets/adbanner.css" media="screen">

    <!--[if IE 7]>
	  <link rel="stylesheet" type="text/css" href="./../../files/stylesheets/ie_7.css" media="screen"> <!-- index -->
    <![endif]-->

    <!--[if IE 8]>
	    <link rel="stylesheet" type="text/css" href="./../../files/stylesheets/ie_8.css" media="screen"> <!-- index -->
    <![endif]-->

  	<script type="text/javascript">
      Cufon.replace('h1, h2', { fontWeight: '600' });
  	</script>
</head>




  <body id="puppetlabsdocs" class="docs">
  <style type="text/css">h1, h2{ visibility : hidden }</style>
  <!--[if IE 8]>
    <style type="text/css">h1, h2{ visibility : visible }</style>
  <![endif]-->

  	<header id="header">
      <div class="site-width">
    		<h1><a href="http://puppetlabs.com/"><span>Puppet Labs</span></a></h1>
        <a class="screen-reader-content" href="#content">Skip navigation</a>
        <nav>
    		<ul id="global-navigation">
          <li id="puppet-tab" class="with-submenu">
            <a href="http://puppetlabs.com/puppet/puppet-enterprise">
              <span>Products</span>
              <span class="drop-down-trigger"></span>
            </a>
            <ul>
			<li>
                <ul>
                   <a href="http://puppetlabs.com/puppet/what-is-puppet/">What is Puppet?</a>
                </ul>
              </li>
			       <li>
                <ul>
                   <a href="http://puppetlabs.com/puppet/puppet-enterprise/">Puppet Enterprise</a>
                </ul>
              </li>
            <li>
                <ul>
                   <a href="http://puppetlabs.com/puppet/whats-new/">What's New in 2.5</a>
                </ul>
              </li>
            <li>
                <ul>
                   <a href="http://puppetlabs.com/puppet/puppet-open-source/">Puppet Open Source</a>
                </ul>
              </li>
            <li>
                <ul>
                   <a href="http://puppetlabs.com/puppet/enterprise-vs-open-source/">Enterprise vs. Open Source</a>
                </ul>
              </li>
              <li>
                <ul>
                  <a href="http://forge.puppetlabs.com">Puppet Forge</a>
                </ul>
              </li>
              <li>
                <ul>
                  <a href="http://puppetlabs.com/puppet/requirements/">Components &amp; Requirements</a>
                </ul>
              </li>
              <li>
                <ul>
                  <a href="http://puppetlabs.com/puppet/faq/">FAQ</a>
                </ul>
              </li>
			  <li>
                <ul>
                  <a href="http://puppetlabs.com/puppet/how-to-buy/">How to Buy</a>
                </ul>
              </li>
            </ul>
          </li>
          <li id="solutions-tab" class="with-submenu">
            <a href="http://puppetlabs.com/solutions/">
              <span>Solutions</span>
              <span class="drop-down-trigger"></span>
            </a>
            <ul>
              <li class="page_item page-item-12296"><a href="http://puppetlabs.com/solutions/configuration-management/">Configuration Management</a></li>
<li class="page_item page-item-986"><a href="http://puppetlabs.com/solutions/virtualization-management/">Virtualization Management</a></li>
<li class="page_item page-item-993"><a href="http://puppetlabs.com/solutions/cloud-management/">Cloud Management</a></li>
<li class="page_item page-item-996"><a href="http://puppetlabs.com/solutions/it-compliance/">IT Compliance</a></li>
<li class="page_item page-item-9520"><a href="http://puppetlabs.com/solutions/devops/">DevOps</a></li>
<li class="page_item page-item-991"><a href="http://puppetlabs.com/solutions/manage-os-x-resources/">OS X Desktops</a></li>
            </ul>
          </li>
          <li id="services-tab" class="with-submenu">
            <a href="http://puppetlabs.com/services/">
              <span>Services</span>
              <span class="drop-down-trigger"></span>
            </a>
            <ul>
              <li class="page_item page-item-783"><a href="http://puppetlabs.com/services/overview/">Overview</a></li>
<li class="page_item page-item-1052"><a href="http://puppetlabs.com/services/customer-support/">Customer Support</a></li>
<li class="page_item page-item-11022"><a href="http://puppetlabs.com/services/support-plans/">Support Plans</a></li>
<li class="page_item page-item-845"><a href="http://puppetlabs.com/services/training-workshops/">On-Site Education</a></li>
<li class="page_item page-item-4899"><a href="http://puppetlabs.com/services/consulting/">Professional Services</a></li>
<li class="page_item page-item-849"><a href="http://puppetlabs.com/category/events/upcoming/">Events &amp; Workshops</a></li>
<li class="page_item page-item-851"><a href="http://puppetlabs.com/services/partners/">Partners</a></li>
            </ul>
          </li>
                    <li id="resources-tab" class="with-submenu">
            <a href="http://puppetlabs.com/resources/">
              <span>Resources</span>
              <span class="drop-down-trigger"></span>
            </a>
            <ul>
              <li class="page_item page-item-1048"><a href="http://puppetlabs.com/resources/overview-2/">Overview</a></li>
<li class="page_item page-item-1040"><a href="http://docs.puppetlabs.com">Documentation</a></li>
<li class="page_item page-item-872"><a href="http://info.puppetlabs.com/register-download">Downloads</a></li>
<li class="page_item page-item-1961"><a href="http://forge.puppetlabs.com">Puppet Forge</a></li>
<li class="page_item page-item-835"><a href="http://info.puppetlabs.com/download-whitepapers.html">White Papers</a></li>
<li class="page_item page-item-1967"><a href="http://projects.puppetlabs.com/projects/puppet/wiki">Wiki</a></li>
<li class="page_item page-item-7279"><a href="http://puppetlabs.com/resources/webinars/">Upcoming Webinars</a></li>
<li class="page_item page-item-10183"><a href="http://puppetlabs.com/resources/newsletter/">Newsletter</a></li>
<li class="page_item page-item-12263"><a href="http://puppetlabs.com/resources/tech-notes/">Tech Notes</a></li>
<li class="page_item page-item-10265"><a href="http://info.puppetlabs.com/pe2-webinar.html">Webinars</a></li>
            </ul>
          </li>

          <li id="customers-tab" class="with-submenu">
            <a href="http://puppetlabs.com/customers/companies/">
              <span>Customers</span>
              <span class="drop-down-trigger"></span>
            </a>
            <ul>
			<li>
                <ul>
                  <a href="http://puppetlabs.com/customers/companies/">Companies</a>
                </ul>
              </li>
			  <li>
                <ul>
                  <a href="http://puppetlabs.com/customers/case-studies/">Case Studies</a>
                </ul>
              </li>
			  <li>
                <ul>
                  <a href="http://puppetlabs.com/customers/product-testimonials/">Product Testimonials</a>
                </ul>
              </li>
			    <li>
                <ul>
                  <a href="http://puppetlabs.com/customers/what-customers-are-saying/">Service Testimonials</a>
                </ul>
              </li>
            </ul>
          </li>
          <li id="community-tab" class="with-submenu">
            <a href="http://puppetlabs.com/community/">
              <span>Community</span>
              <span class="drop-down-trigger"></span>
            </a>

 <ul>
			<li>
                <ul>
                  <a href="http://puppetlabs.com/community/overview/">Overview</a>
                </ul>
              </li>
			<li>
                <ul>
                  <a href="http://puppetlabs.com/blog">Blog</a>
                </ul>
              </li>
			  <li>
                <ul>
                  <a href="http://puppetlabs.com/community/puppet-camp/">Puppet Camp</a>
                </ul>
              </li>
			  <li>
                <ul>
                  <a href="http://puppetlabs.com/community/user-groups-and-devops-groups/">Puppet User Groups & DevOps Groups</a>
                </ul>
              </li>
	          <li>
                <ul>
                  <a href="http://puppetlabs.com/community/presentations/">Presentations</a>
                </ul>
              </li>
			    <li>
                <ul>
                  <a href="http://puppetlabs.com/community/videos/">Videos</a>
                </ul>
              </li>
            </ul>

          <li id="company-tab" class="with-submenu">
            <a href="http://puppetlabs.com/company/">
              <span>Company</span>
              <span class="drop-down-trigger"></span>
            </a>
            <ul>
              <li class="page_item page-item-2316"><a href="http://puppetlabs.com/company/overview/">Overview</a></li>
<li class="page_item page-item-2179"><a href="http://puppetlabs.com/company/news/">News</a>
<ul class='children'>
	<li class="page_item page-item-2338"><a href="http://puppetlabs.com/company/news/press-releases/">Press Releases</a></li>
	<li class="page_item page-item-2383"><a href="http://puppetlabs.com/company/news/media-kit/">Media Kit</a></li>
</ul>
</li>
<li class="page_item page-item-1571"><a href="http://puppetlabs.com/company/careers/">Careers</a></li>
<li class="page_item page-item-10372"><a href="http://puppetlabs.com/company/management/">Management</a></li>
<li class="page_item page-item-10311"><a href="http://puppetlabs.com/company/board-and-advisors/">Board and Advisors</a></li>
<li class="page_item page-item-10367"><a href="http://puppetlabs.com/company/investors/">Investors</a></li>
<li class="page_item page-item-2313"><a href="http://puppetlabs.com/company/contact-us/">Contact Us</a></li>
<li class="page_item page-item-10579"><a href="http://puppetlabs.com/company/awards/">Awards</a></li>
            </ul>
          </li>
    		</ul>
          <div id="misc-navigation">
			  <ul>
				<li><a href="http://puppetlabs.com/security/">Security</a></li>
				<li><a href="http://docs.puppetlabs.com">Documentation</a></li>
				<li><a href="http://puppetlabs.com/resources/customer-support/">Support</a></li>
			        <li><a href="http://projects.puppetlabs.com/">Bug Tracker</a></li>
				<li><a href="http://puppetlabs.com/company/contact/contact-us">Contact Us</a></li>
				<li><a href="http://info.puppetlabs.com/download-pe2.html" class="gateway">Download</a></li>
			  </ul>
			<form action="http://www.google.com/cse" id="cse-search-box">
			  <div>
				<input type="hidden" name="cx" value="017668764424496204839:ubligvgbenm" />
				<input type="hidden" name="ie" value="UTF-8" />
				<input type="text" name="q" class="gsc-input" size="31" />
				<input type="submit" name="sa" class="searchbtn" value="Search" />
			  </div>
			</form>
			<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&lang=en"></script>
          </div>
      </nav>
    	</div>
    </header>

      <section id="masthead">
        <div class="site-width">
          <h1>Docs: <span class="section-name">PE 2.6  » Orchestration » Usage</span></h1>
          <ul id="doc-navigation">
            <li><a href="./../../index.html">Docs Home</a></li>
            <li class="with-submenu">
              <a href="#">
                <span>Quick Nav</span>
                <span class="drop-down-trigger"></span>
              </a>
               <!-- the following links can't be relative, unfortunately -->
               <!-- future: add some JS to disable this if running from file:// -->
                               <dl>
                  <dt>Puppet Documentation</dt>
                      <dd><a href="./../../puppet/3/reference/index.html">Puppet 3 Reference Manual</a></dd>
                      <dd><a href="./../../puppet/2.7/reference/index.html">Puppet 2.7 Reference Manual</a></dd>
                      <dd><a href="./../../pe/latest/index.html">Puppet Enterprise User's Guide</a></dd>
                      <dd><a href="./../../learning/index.html">Learning Puppet</a></dd>
                      <dd><a href="./../../references/latest/type.html">Resource Types</a></dd>
                      <dd><a href="./../../references/latest/function.html">Functions</a></dd>
                      <dd><a href="./../../references/latest/configuration.html">Configuration</a></dd>
                      <dd><a href="./../../references/latest/developer/index.html">Developer</a></dd>
                      <dd><a href="./../../references/glossary.html">Glossary of Puppet Terms</a></dd>
                      <dd><a href="./../../references/index.html">Older References</a></dd>
                  <dt>Facter</dt>
                      <dd><a href="./../../facter/latest/core_facts.html">Core Facts Reference</a></dd>
                  <dt>PuppetDB</dt>
                      <dd><a href="./../../puppetdb/1/index.html">PuppetDB 1 Manual</a></dd>
                  <dt>MCollective</dt>
                      <dd><a href="./../../mcollective/index.html">Index</a></dd>
                      <dd><a href="./../../mcollective/reference/index.html">References</a></dd>
                      <dd><a href="./../../mcollective/simplerpc/index.html">Writing Plugins</a></dd>
                      <dd><a href="./../../mcollective/releasenotes.html">Release Notes</a></dd>
                </dl>

            </li>
            <li><a href="./../../contribute.html">Contribute</a></li>
          </ul>
        </div>
        <br />
      </section>

      <section id="content">
        <div class="site-width">
          <div class="primary-secondary-content">
            <div class="primary-content">
              <h1>Orchestration for New PE Users: Usage and Examples</h1>
              <nav class="in-page" id="page-nav">
<ol class="toc">
  <li class="toc-lv2"><a href="#running-actions">Running Actions</a></li>
  <li class="toc-lv2"><a href="#available-actions">Available Actions</a></li>
  <li class="toc-lv2"><a href="#filtering-nodes">Filtering Nodes</a></li>
  <li class="toc-lv2"><a href="#examples">Examples</a>
<ol class="toc">
   <li class="toc-lv3"><a href="#ping">Ping</a></li>
   <li class="toc-lv3"><a href="#find">Find</a></li>
   <li class="toc-lv3"><a href="#inventory">Inventory</a></li>
   <li class="toc-lv3"><a href="#puppetd">Puppetd</a></li>
   <li class="toc-lv3"><a href="#puppetral">PuppetRAL</a></li>
   <li class="toc-lv3"><a href="#service">Service</a></li>
   <li class="toc-lv3"><a href="#package">Package</a></li>
   <li class="toc-lv3"><a href="#controller">Controller</a></li>
</ol></li>
</ol></nav>
              <blockquote>
  <p><img src="./images/windows-logo-small.jpg" alt="windows-only" /> <strong>NOTE:</strong> Orchestration and MCollective are not yet supported on Windows nodes.</p>
</blockquote>

<h2 id="running-actions">Running Actions</h2>

<p>Orchestration actions are grouped and distributed as MCollective
plugins. In the default installation of Puppet Enterprise, you can run any orchestration action from any plugin while logged in as the <code>peadmin</code> user on the puppet master node.</p>

<p>To open a shell as the <code>peadmin</code> user, run:</p>

<pre><code>$ sudo -i -u peadmin
</code></pre>

<p>To run orchestration actions, use the <code>mco</code> command:</p>

<pre><code>$ mco &lt;PLUGIN&gt; &lt;FILTER&gt; &lt;ACTION&gt; &lt;ARGUMENT&gt; &lt;OPTIONS&gt;
</code></pre>

<h2 id="available-actions">Available Actions</h2>

<p>The following orchestration actions are available in PE 2.0:</p>

<ul>
  <li><code>rpcutil</code> plugin
    <ul>
      <li><code>find</code> action returns a list of all nodes matching a search filter</li>
      <li><code>ping</code> action returns a list of all nodes and their latencies</li>
      <li><code>inventory</code> action returns a list of Facts, Classes, and other information from all nodes</li>
      <li>this plugin&#8217;s actions are exposed via higher-level wrappers, such as the <code>mco ping</code> command</li>
    </ul>
  </li>
  <li><code>puppetral</code> plugin
    <ul>
      <li><code>find</code> action returns a Puppet resource of a given type and title and its variations across all nodes</li>
      <li><code>search</code> action returns all Puppet resources of a given type across all nodes</li>
      <li><code>create</code> action creates a given resource across all nodes
        <ul>
          <li>creating an exec resource allows for arbitrary management of nodes</li>
        </ul>
      </li>
    </ul>
  </li>
  <li><code>puppetd</code> plugin
    <ul>
      <li><code>enable</code> and <code>disable</code> actions will enable and disable puppet agent on a node or nodes</li>
      <li><code>runonce</code> action initiates a puppet agent run on all nodes</li>
      <li><code>last_run_summary</code> action retrieves the most recent Puppet run summary from all nodes</li>
      <li><code>status</code> action returns puppet agent&#8217;s run status on all nodes</li>
    </ul>
  </li>
  <li><code>service</code> plugin
    <ul>
      <li><code>start, stop, restart,</code> and <code>status</code> actions allow direct management of services across the deployment</li>
    </ul>
  </li>
  <li><code>package</code> plugin
    <ul>
      <li><code>install, purge, checkupdate, update,</code> and <code>status</code> actions work through the system package manager to query and ensure the state of software packages across the deployment</li>
    </ul>
  </li>
  <li><code>controller</code> plugin
    <ul>
      <li><code>stats</code> action returns cumulative statistics about MCollective messages passed between nodes</li>
      <li><code>reload_agent</code> action refreshes from disk the code for a specific plugin</li>
      <li><code>reload_agents</code> action refreshes from disk the code for all plugins</li>
      <li><code>exit</code> action removes nodes from the MCollective network</li>
    </ul>
  </li>
</ul>

<h2 id="filtering-nodes">Filtering Nodes</h2>

<p>Most orchestration actions in Puppet Enterprise 2.6 can be executed
on a set of nodes determined by meta-data about the deployment.
This filtering provides a much more convenient way to manage nodes
than the traditional approach of using host names or fully
qualified domain names to identify and access machines. Node sets
can be created by filtering based on Facter facts, Puppet classes,
and host names. Filters can be specified by passing options to the
<code>mco</code> command. For example:</p>

<pre><code>$ mco find --with-fact osfamily=RedHat
</code></pre>

<p>This command forces the find action to only return nodes which have a
fact named osfamily with a value of RedHat.  Filter options are
case sensitive and support regular expression syntax.</p>

<h2 id="examples">Examples</h2>

<h3 id="ping">Ping</h3>

<p>The <code>ping</code> action of the rpcutil plugin is wrapped to be available at
a higher level than the <code>mco ping</code> command. This command returns a list
of all the nodes and their network latencies.  In a typical Puppet
Enterprise deployment, latencies for issuing an orchestration
action are less than half a second:</p>

<pre><code>peadmin@puppetmaster:~$ mco ping
puppetmaster.example.com               time=135.94 ms
agent.example.com                      time=136.55 ms
---- ping statistics ----
2 replies max: 136.55 min: 135.94 avg: 136.25
</code></pre>

<h3 id="find">Find</h3>

<p>The <code>find</code> action of the rpcutil plugin is wrapped to be available at
a higher level than the <code>mco find</code> command. This command returns a list
of all the nodes in the network:</p>

<pre><code>peadmin@puppetmaster:~$ mco find
puppetmaster.example.com
agent.example.com
</code></pre>

<h3 id="inventory">Inventory</h3>

<p>The <code>inventory</code> action of the rpcutil plugin is wrapped to be
available at a higher level than the <code>mco inventory</code> command. This
command returns facts and classes, among other information:</p>

<pre><code>peadmin@puppetmaster:~$ mco inventory agent.example.com
Inventory for agent.example.com:
 Server Statistics:
   Version: 1.2.1
   Start Time: Mon Nov 14 15:25:33 -0800 2011
   Config File: /etc/puppetlabs/mcollective/server.cfg
   Collectives: mcollective
   Main Collective: mcollective
   Process ID: 5553
   Total Messages: 86
   Messages Passed Filters: 74
   Messages Filtered: 12
   Replies Sent: 73
   Total Processor Time: 1.34 seconds
   System Time: 0.59 seconds
 Agents:
   discovery       package         puppetd
   puppetral       rpcutil         service
 Configuration Management Classes:
   default                        helloworld
   helloworld                     pe_accounts
   pe_accounts                    pe_accounts::data
   pe_accounts::groups            pe_compliance
   pe_compliance                  pe_compliance::agent
   pe_mcollective                 pe_mcollective
   pe_mcollective::metadata       pe_mcollective::plugins
   settings
Facts:
   architecture =&gt; i386
   augeasversion =&gt; 0.7.2
   ...
</code></pre>

<h3 id="puppetd">Puppetd</h3>

<p>The puppetd plugin orchestrates Puppet itself across the
deployment. This plugin is capable of kicking off Puppet
configuration runs on each node in the deployment all at the same
time, on a subset of the deployment using filtering, or using a
maximum concurrency level. The maximum concurrency feature is
particularly noteworthy as it allows the execution of a
configuration run on all nodes in the population, but sets an upper
limit on the number of nodes that are performing their run at any
given time, thus mitigating the network load and resource demands
on the puppet master. This example performs a configuration run on
all nodes, but only one node at a time:</p>

<pre><code>peadmin@puppetmaster:~$ mco puppetd runall 1
Tue Nov 15 11:17:11 -0800 2011&gt; Running all machines with a concurrency of 1
Tue Nov 15 11:17:11 -0800 2011&gt; Discovering hosts to run
Tue Nov 15 11:17:13 -0800 2011&gt; Found 2 hosts
Tue Nov 15 11:17:13 -0800 2011&gt; Running agent.example.com, concurrency is 0
Tue Nov 15 11:17:14 -0800 2011&gt; agent.example.com schedule status: OK
Tue Nov 15 11:17:15 -0800 2011&gt; Currently 1 nodes running; waiting
Tue Nov 15 11:17:21 -0800 2011&gt; Running puppetmaster.example.com, concurrency is 0
Tue Nov 15 11:17:22 -0800 2011&gt; puppetmaster.example.com schedule status: OK
Finished processing 1 / 1 hosts in 98.98 ms
</code></pre>

<p>Note, the &#8220;1 / 1 hosts&#8221; is an indication that one host was actually
performing the orchestration of the Puppet configuration run.  This
does not mean only one host in the deployment performed the
configuration run.  The message &#8220;Found 2 hosts&#8221; indicates that two
nodes carried out this action.</p>

<p>Once finished with the Puppet configuration run, the <code>status</code> action
can be used to see the last Puppet configuration run for each node
in the deployment.</p>

<pre><code>peadmin@puppetmaster:~$ mco puppetd status
[ =============================================&gt; ] 2 / 2
agent.example.com  Enabled, not running, last run 10 seconds ago
puppetmaster.example.com  Enabled, not running, last run 2 seconds ago

Finished processing 2 / 2 hosts in 105.29 ms
</code></pre>

<h3 id="puppetral">PuppetRAL</h3>

<p>The puppetral plugin provides a command line tool to work with any
resource Puppet is capable of managing.  A common use case for the
puppetral plugin is to execute arbitrary commands on the deployment
using the exec resource. This example creates a new file on all
nodes in the deployment:</p>

<pre><code>peadmin@puppetmaster:~$ mco rpc puppetral \
create type=exec title="/bin/bash -c 'echo Hello &gt; /tmp/hello'"
Determining the amount of hosts matching filter for 2 seconds .... 2

[ =================================================&gt; ] 2 / 2

agent.example.com
Status: Resource was created
Resource:
  {"exported"=&gt;false,
   "title"=&gt;"/bin/bash -c 'echo Hello &gt; /tmp/hello'",
   "parameters"=&gt;{:returns=&gt;:notrun},
   "tags"=&gt;["exec"],
   "type"=&gt;"Exec"}

 puppetmaster.example.com
 Status: Resource was created
 Resource:
   {"exported"=&gt;false,
    "title"=&gt;"/bin/bash -c 'echo Hello &gt; /tmp/hello'",
    "parameters"=&gt;{:returns=&gt;:notrun},
    "tags"=&gt;["exec"],
    "type"=&gt;"Exec"}

 Finished processing 2 / 2 hosts in 249.21 ms
</code></pre>

<p>The creation of this file can be verified with the <code>find</code> action:</p>

<pre><code> peadmin@puppetmaster:~$ mco rpc puppetral find type=file title=/tmp/hello

 Determining the amount of hosts matching filter for 2 seconds .... 2

 [ ================================================&gt; ] 2 / 2

 agent.example.com
   exported: false
   managed: false
   title: /tmp/hello
   parameters:
     {:ctime=&gt;Tue Nov 15 11:32:10 -0800 2011,
      :type=&gt;"file",
      :ensure=&gt;:file,
      :group=&gt;0,
      :owner=&gt;0,
      :mtime=&gt;Tue Nov 15 11:32:10 -0800 2011,
      :mode=&gt;"644",
      :content=&gt;"{md5}09f7e02f1290be211da707a266f153b3"}
  tags: ["file"]
  type: File

 puppetmaster.example.com
   managed: false
   exported: false
   title: /tmp/hello
   parameters:
     {:ctime=&gt;Tue Nov 15 11:32:10 -0800 2011,
      :type=&gt;"file",
      :group=&gt;0,
      :ensure=&gt;:file,
      :owner=&gt;0,
      :mtime=&gt;Tue Nov 15 11:32:10 -0800 2011,
      :mode=&gt;"644",
      :content=&gt;"{md5}09f7e02f1290be211da707a266f153b3"}
   tags: ["file"]
   type: File

 Finished processing 2 / 2 hosts in 166.12 ms
</code></pre>

<p>The puppetral plugin can manage any resource Puppet itself is
capable of managing. In particular, user, group, host, and
package resources are exposed directly in the console&#8217;s live management page.</p>

<h3 id="service">Service</h3>

<p>Puppet agent will automatically restart a service it manages when related
resources are changed, but sometimes services need to be restarted outside of a normal Puppet
configuration run. The <code>mco service</code> command can be used in these cases.
This example restarts the SSH daemon on all
nodes running RedHat:</p>

<pre><code>peadmin@puppetmaster:~$ mco service sshd restart -W osfamily=RedHat
[ ==================================================&gt; ] 2/ 2
---- service summary ----
Nodes: 2 / 2
Statuses: started=2
Elapsed Time: 1.45 s
</code></pre>

<p>The status of the restarted services can be shown with:</p>

<pre><code>peadmin@puppetmaster:~$ mco service sshd status -W osfamily=RedHat
[ ==================================================&gt; ] 2 / 2
puppetmaster.example.com               status=running
agent.example.com                      status=running
---- service summary ----
Nodes: 2 / 2
Statuses: started=2
Elapsed Time: 0.26 s
</code></pre>

<h3 id="package">Package</h3>

<p>Similar to the service plugin, the <code>package</code> plugin manages software
packages outside of a normal Puppet configuration run. The
following is the trimmed output from running the
<code>checkupdates</code> action:</p>

<pre><code>peadmin@puppetmaster:~$ mco rpc package checkupdates -W fqdn=agent.example.com
Determining the amount of hosts matching filter for 2 seconds .... 1
 * [ ============================================================&gt; ] 1 / 1
agent.example.com
   Outdated Packages: [{:package=&gt;"glibc.i686", :version=&gt;"2.5-65.el5_7.1", :repo=&gt;"base_local"},
                       {:package=&gt;"nscd.i386", :version=&gt;"2.5-65.el5_7.1", :repo=&gt;"base_local"},
                       {:package=&gt;"ntp.i386",
                        :version=&gt;"4.2.2p1-15.el5.centos.1",
                        :repo=&gt;"base_local"},
                       {:package=&gt;"openssh.i386", :version=&gt;"4.3p2-72.el5_7.5", :repo=&gt;"base_local"},
                       {:package=&gt;"openssh-clients.i386",
                        :version=&gt;"4.3p2-72.el5_7.5",
                        :repo=&gt;"base_local"},
                       {:package=&gt;"openssh-server.i386",
                        :version=&gt;"4.3p2-72.el5_7.5",
                        :repo=&gt;"base_local"}]
              Output:
glibc.i686                       2.5-65.el5_7.1                       base_local
nscd.i386                        2.5-65.el5_7.1                       base_local
ntp.i386                         4.2.2p1-15.el5.centos.1              base_local
openssh.i386                     4.3p2-72.el5_7.5                     base_local
openssh-clients.i386             4.3p2-72.el5_7.5                     base_local
openssh-server.i386              4.3p2-72.el5_7.5                     base_local
           Exit Code: 100
     Package Manager: yum

Finished processing 1 / 1 hosts in 409.14 ms
</code></pre>

<h3 id="controller">Controller</h3>

<p>The <code>mco controller</code> command manages the underlying MCollective
infrastructure. This can be used to load plugins obtained outside
of Puppet Enterprise or custom written for the deployment. This
example reloads all plugins across the Puppet Enterprise
deployment:</p>

<pre><code> peadmin@puppetmaster:~$ mco controller reload_agents
 Determining the amount of hosts matching filter for 2 seconds .... 2
 agent.example.com&gt; reloaded all agents
 puppetmaster.example.com&gt; reloaded all agents
 Finished processing 2 / 2 hosts in 137.86 ms
</code></pre>

<hr />

<ul>
  <li><a href="./cloudprovisioner_overview.html">Next: Cloud Provisioning Overview</a> </li>
</ul>

              <blockquote><p style="font-size: 1.3em; text-align: center;"><a href="#content">↑ Back to top</a></p></blockquote>
            </div>
            <nav class="main">
                  <div id="subCol">


<p class="versionnote">A newer version of Puppet Enterprise has been released!</p>
<ul class="versionnote">
  <li><a href="http://info.puppetlabs.com/download-pe.html">Download PE 3.0</a>.</li>
  <li><a href="./../../pe/3.0/index.html">PE 3.0 user's guide</a></li>
  <li><a href="./../../pe/latest/orchestration_invoke_cli.html">Jump to newest version of this page</a></li>
</ul>


<h3><a href="./index.html">Puppet Enterprise 2.6</a></h3>

<ul>
  <li><strong>Overview</strong>
    <ul>
      <li><a href="./overview_about_pe.html">About Puppet Enterprise</a></li>
      <li><a href="./overview_whats_new.html">New Features</a></li>
      <li><a href="./overview_getting_support.html">Getting Support</a></li>
    </ul>
  </li>
  <li><strong>Quick Start</strong>
    <ul>
        <li><a href="./quick_start.html">Quick Start: Using PE</a></li>
        <li><a href="./quick_writing.html">Quick Start: Writing Modules</a></li>
    </ul>
  </li>
  <li><strong>Installing Puppet Enterprise</strong>
    <ul>
      <li><a href="./install_system_requirements.html">System Requirements</a></li>
      <li><a href="./install_basic.html">Installing PE</a></li>
      <li><a href="./install_windows.html">Installing Windows Agents</a></li>
      <li><a href="./install_upgrading.html">Upgrading</a></li>
      <li><a href="./install_uninstalling.html">Uninstalling</a></li>
      <li><a href="./install_automated.html">Automated Installation</a></li>
      <li><a href="./install_answer_file_reference.html">Answer File Reference</a></li>
      <li><a href="./install_what_and_where.html">What gets installed where?</a></li>
    </ul>
  </li>
  <li><strong>The Console</strong>
    <ul>
      <li><a href="./console_accessing.html">Accessing the Console</a></li>
      <li><a href="./console_navigating.html">Navigating the Console</a></li>
      <li><a href="./console_reports.html">Viewing Reports and Inventory Data</a></li>
      <li><a href="./console_auth.html">Managing Users</a></li>
      <li><a href="./console_classes_groups.html">Grouping and Classifying Nodes</a></li>
      <li><a href="./console_live.html">Live Management</a></li>
      <li><a href="./console_live_resources.html">Live Management: Managing Resources</a></li>
      <li><a href="./console_live_puppet.html">Live Management: Controlling Puppet</a></li>
      <li><a href="./console_live_advanced.html">Live Management: Advanced Tasks</a></li>
      <li><a href="./console_maintenance.html">Console Maintenance</a></li>
    </ul>
  </li>
  <li><strong>Puppet</strong>
    <ul>
      <li><a href="./puppet_overview.html">Overview</a></li>
      <li><a href="./puppet_tools.html">Tools</a></li>
      <li><a href="./puppet_modules_manifests.html">Modules and Manifests</a></li>
      <li><a href="./puppet_data_library.html">Puppet Data Library</a></li>
      <li><a href="./puppet_references.html">References</a></li>
    </ul>
  </li>
   <li><strong>Configuring Puppet Enterprise</strong>
    <ul>
     <li><a href="./config_advanced.html">Advanced Configuration</a></li>
     <li><a href="./config_installing_additional.html">Installing Additional Components</a></li>
    </ul>
  </li>
  <li><strong>Orchestration</strong>
    <ul>
      <li><a href="./orchestration_overview.html">Overview</a></li>
      <li><span class="currentpage">Usage and Examples</span></li>
    </ul>
  </li>
  <li><strong>Cloud Provisioning</strong>
    <ul>
      <li><a href="./cloudprovisioner_overview.html">Overview</a></li>
      <li><a href="./cloudprovisioner_configuring.html">Installing & Configuring Cloud Provisioner</a></li>
      <li><a href="./cloudprovisioner_classifying_installing.html">Classifying Nodes & Remotely Installing Puppet</a></li>
      <li><a href="./cloudprovisioner_vmware.html">Provisioning with VMware</a></li>
      <li><a href="./cloudprovisioner_aws.html">Provisioning with AWS</a></li>
      <li><a href="./cloudprovisioner_workflow.html">Sample Workflow</a></li>
      <li><a href="./cloudprovisioner_troubleshooting.html">Troubleshooting</a></li>
    </ul>
  </li>
  <li><strong>The Compliance Workflow</strong>
    <ul>
      <li><a href="./compliance_basics.html">Basics and UI</a></li>
      <li><a href="./compliance_using.html">Using the Compliance Workflow</a></li>
      <li><a href="./compliance_tutorial.html">Tutorial</a></li>
    </ul>
  </li>
  <li><strong>The PE Accounts Module</strong>
    <ul>
      <li><a href="./accounts_user_type.html">The pe_accounts::user Type</a></li>
      <li><a href="./accounts_class.html">The pe_accounts Class</a></li>
    </ul>
  </li>
  <li><strong>Troubleshooting</strong>
    <ul>
     <li> <a href="./trouble_common_problems.html">Common Problems & Solutions</a></li>
    </ul>
  </li>
  <li><strong>Appendix</strong>
    <ul>
      <li><a href="./appendix.html#release-notes">Release Notes</a></li>
      <li><a href="./appendix.html#known-issues">Known Issues</a></li>
    </ul>
  </li>
</ul>




                      <div style="margin-top: 1.5em; padding-bottom: 10px;">
                          <p style="font-family: 'Lucida Grande',Lucida,Verdana,sans-serif;font-size: 16px; font-weight: bold; line-height: 22px; margin-bottom: 10px;">Download the Docs</p>
                          <a href="http://info.puppetlabs.com/download-pdfs.html"><img src="./../../images/smallbits_small_docs.png" alt="Puppet docs download"></a>
                      </div>
                      <div style="margin-top: 0; padding-bottom: 10px;">
                          <p style="font-family: 'Lucida Grande',Lucida,Verdana,sans-serif;font-size: 16px; font-weight: bold; line-height: 22px; margin-bottom: 10px;">Download Puppet Enterprise</p>
                          <a href="http://info.puppetlabs.com/download-pe.html"><img src="./../../images/puppet_cert_home.jpg" alt="Puppet Enterprise promo"></a>
                      </div>
                  </div>
            </nav>
          </div>
        </div>
      </section>

		<footer id="footer">
      <div class="site-width">

        <div class="primary-secondary-content">
          <div class="primary-content">
            <section id="newsletter">
                 <h4>Puppet Labs is Hiring</h4>
                 <p><a href="http://www.puppetlabs.com/company/jobs/">Engineers, developers & consultants</a>
                  <p>
		<h4>Newsletter</h4>

              <p>Stay up to date on all things puppet</p>

				<form class="lpeRegForm formNotEmpty" method="post" enctype="application/x-www-form-urlencoded" action="http://info.puppetlabs.com/index.php/leadCapture/save"; id="mktForm_1013" name="mktForm_1013">

				<label>Email Address:</label><span class='mktInput'><input class='mktFormText mktFormEmail' name="Email" id="Email" type='text' value="" maxlength='255'  /><span class='mktFormMsg'></span></span>

				<input id='mktFrmSubmit' type='submit' class='btn' style="width: auto; overflow: visible; padding-left: .25em; padding-right: .25em;" value='Subscribe' name='submitButton' onclick='formSubmit(document.getElementById("mktForm_1013")); return false;' />

				<input style='display: none;' id='mktFrmReset' type='reset' value='Clear' name='resetButton' onclick='formReset(document.getElementById("mktForm_1013")); return false;' />

				<span style="display:none;"><input type="text" name="_marketo_comments" value="" /></span>
				<input type="hidden" name="lpId" value="-1" />
				<input type="hidden" name="subId" value="100" />

				<input type="hidden" name="kw" value="" />
				<input type="hidden" name="cr" value="" />

				<input type="hidden" name="searchstr" value="" />
				<input type="hidden" name="lpurl" value="http://info.puppetlabs.com/testsubscription.html?cr={creative}&kw={keyword}"; />
				<input type="hidden" name="formid" value="1013" />
				<input type="hidden" name="returnURL" value="http://www.puppetlabs.com/misc/subscription-thank-you/"; />
				<input type="hidden" name="retURL" value="http://www.puppetlabs.com/misc/subscription-thank-you/"; />
				<input type="hidden" name="_mkt_disp" value="return" />
				<input type="hidden" name="_mkt_trk" value="" />

				</form>
				<script type="text/javascript" src="http://info.puppetlabs.com/js/mktFormSupport.js"></script>

				<script type="text/javascript">
				function formSubmit(elt) {
				return Mkto.formSubmit(elt);
				}
				function formReset(elt) {
				return Mkto.formReset(elt);
				}
				</script>

<a href="http://info.puppetlabs.com/puppet-enterprise" class="fbtn">Try Puppet Enterprise FREE</a>

            </section>
            <section id="elsewhere">
              <h4>Get Involved</h4>
              <ul>

                <li class="chat"><a href="http://webchat.freenode.net/?channels=puppet" rel="external"><span class="indicator"></span><span>Chat with us on IRC</span></a></li>
		<li class="discussion"><a href="http://groups.google.com/group/puppet-dev" rel="external"><span class="indicator"></span><span>Join the Puppet Developer List</span></a></li>
                <li class="discussion"><a href="http://groups.google.com/group/puppet-users?pli=1" rel="external"><span class="indicator"></span><span>Join the Puppet User List</span></a></li>

                <li class="linkedin"><a href="http://www.linkedin.com/groups?about=&gid=696467&trk=anet_ug_grppro" rel="external"><span class="indicator"></span><span>Join the Puppet Users LinkedIn group</span></a></li>

              </ul>
		<p>
		              		<h4>Follow us&#8230;</h4>

              		<ul class="followus">


			<li><a href="http://feeds.feedburner.com/PuppetLabs" target="_blank"><img src="http://www.puppetlabs.com/wp-content/plugins/my-profiles/images/rss.png" border="0"></a></li>
			<li><a href="http://www.facebook.com/pages/Puppet-Labs/219089920711" target="_blank"><img src="http://www.puppetlabs.com//wp-content/plugins/my-profiles/images/facebook.png" border="0"></a></li>
			<li><a href="http://www.twitter.com/puppetlabs" target="_blank"><img src="http://www.puppetlabs.com//wp-content/plugins/my-profiles/images/twitter.png" border="0"></a></li>
			<li><a href="http://www.linkedin.com/groups?about=&amp;gid=696467&amp;trk=anet_ug_grppro" target="_blank"><img src="http://www.puppetlabs.com//wp-content/uploads/2011/01/LinkedIn_IN_Icon_32px.png" border="0"></a></li>    <li><a href="https://github.com/puppetlabs" target="_blank"><img src="http://www.puppetlabs.com//wp-content/uploads/2011/01/github_icon.png" border="0"></a></li>
			<li><a href="https://plus.google.com/112682055028218091774?rel=author" target="_blank"><img src="https://puppetlabs.com/wp-content/uploads/2013/05/google_plus32x32.png" alt="Find Us on Google+" border="0"></a></li>
					</ul>

              	</p>

            </section>
          </div>
          <div class="secondary-content">
            <section id="book-it">
              <h4>Get the book!</h4>

              <p>James Turnbull and Jeff McCune's book <a href="http://www.apress.com/9781430230571" rel="nofollow">Pro Puppet</a> is a comprehensive and up-to-date look at Puppet and MCollective. </p>
              <a href="http://www.apress.com/9781430230571" rel="nofollow"><img src="http://www.puppetlabs.com/wp-content/uploads/2011/05/propuppetthumb.png" /></a>
            </section>
          </div>
        </div>
      </div>
		</footer>

    <div id="copyright">
      <div class="site-width">
        &copy; 2011 <a href="http://www.puppetlabs.com/" title="Puppet Labs">Puppet Labs</a>
        <span class="vcard">
         <span class="org"></span>
         <a class="email" href="mailto:info@puppetlabs.com">info@puppetlabs.com</a>

          <span class="adr">
           <span class="street-address">926 NW 13th Avenue #210</span>
           /
           <span class="locality">Portland</span>,
           <span class="region">OR</span>
           <span class="postal-code">97209</span>

          </span>

         <span class="tel">1-877-575-9775</span>
        </span>
      </div>
    </div>

  	<script type="text/javascript">Cufon.now();</script>
  	<style type="text/css">h1, h2, .btn { visibility : visible; }</style>


	</body>
</html>
