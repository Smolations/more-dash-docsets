<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=US-ASCII" />
    <title> Packaging and Distribution - Plugin Development - Vagrant Documentation</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <link href="./../../stylesheets/bootstrap-2bdef9a2.css" media="screen" rel="stylesheet" />
    <link href="./../../stylesheets/vagrantup-d5d54c59.css" media="screen" rel="stylesheet" />
    <script src="./../../javascripts/jquery-08c11650.js"></script>
    <script src="./../../javascripts/modernizr-84c0465a.js"></script>
    <script src="./../../javascripts/bootstrap.min-98cc7a22.js"></script>
    <script src="./../../javascripts/backstretch-3d1212ad.js"></script>
    <script src="./../../javascripts/vagrantup-03aae2a8.js"></script>
    <link href="./../..//fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet" />
    <script src="./../..//use.typekit.net/xfs6zus.js"></script>
    <script>
<![CDATA[try{Typekit.load();}catch(e){}]]>
    </script>
  </head>
  <body>
    <div class="wrapper">
      <nav class="docs">
        <a class="vagrant-docs-logo" href="./../../">Vagrant Documentation</a>
        <ul class="pull-right unstyled">
          <li>
            <a href="./../..//www.vagrantup.com/">Home</a>
          </li>
        </ul>
      </nav>
      <div class="page docs docs-home">
        <div class="container">
          <div class="row">
            <div class="sidebar span3">
              <aside class="sidebar-nav">
                <div class="toggle hidden-desktop">
                  <div class="open-close open"></div>
                  <a href="#">Contents</a>
                </div>
                <ul class="unstyled">
                  <li>
                    <a href="./../../v2/">Overview</a>
                  </li>
                  <li>
                    <a href="./../../v2/why-vagrant/index.html">Why Vagrant?</a>
                  </li>
                  <li>
                    <a href="./../../v2/installation/index.html">Installation</a>
                  </li>
                  <li>
                    <a href="./../../v2/getting-started/index.html">Getting Started</a>
                  </li>
                  <li>
                    <a href="./../../v2/cli/index.html">Command-Line Interface</a>
                  </li>
                  <li>
                    <a href="./../../v2/vagrantfile/index.html">Vagrantfile</a>
                  </li>
                  <li>
                    <a href="./../../v2/boxes.html">Boxes</a>
                  </li>
                  <li>
                    <a href="./../../v2/provisioning/index.html">Provisioning</a>
                  </li>
                  <li>
                    <a href="./../../v2/networking/index.html">Networking</a>
                  </li>
                  <li>
                    <a href="./../../v2/synced-folders/index.html">Synced Folders</a>
                  </li>
                  <li>
                    <a href="./../../v2/multi-machine/index.html">Multi-Machine</a>
                  </li>
                  <li>
                    <a href="./../../v2/providers/index.html">Providers</a>
                  </li>
                  <li>
                    <a href="./../../v2/virtualbox/index.html">VirtualBox</a>
                  </li>
                  <li>
                    <a href="./../../v2/vmware/index.html">VMware</a>
                  </li>
                  <li class="current">
                    <a href="./../../v2/plugins/index.html">Plugins</a>
                  </li>
                  <ul class="sub unstyled">
                    <li>
                      <a href="./../../v2/plugins/usage.html">Usage</a>
                    </li>
                    <li>
                      <a href="./../../v2/plugins/development-basics.html">Plugin Development Basics</a>
                    </li>
                    <li>
                      <a href="./../../v2/plugins/commands.html">Commands</a>
                    </li>
                    <li>
                      <a href="./../../v2/plugins/configuration.html">Configuration</a>
                    </li>
                    <li>
                      <a href="./../../v2/plugins/guests.html">Guests</a>
                    </li>
                    <li>
                      <a href="./../../v2/plugins/guest-capabilities.html">Guest Capabilities</a>
                    </li>
                    <li>
                      <a href="./../../v2/plugins/hosts.html">Hosts</a>
                    </li>
                    <li>
                      <a href="./../../v2/plugins/providers.html">Providers</a>
                    </li>
                    <li>
                      <a href="./../../v2/plugins/provisioners.html">Provisioners</a>
                    </li>
                    <li class="current">
                      <a href="./../../v2/plugins/packaging.html">Packaging &amp; Distribution</a>
                    </li>
                  </ul>
                  <li>
                    <a href="./../../v2/debugging.html">Debugging</a>
                  </li>
                </ul>
              </aside>
            </div>
            <div class="page-contents span9">
              <div class="page-background"></div>
              <div class="row">
                <div class="span8 offset1">
                  <h1>Plugin Development: Packaging &amp; Distribution</h1>
                  <p>This page documents how to add new commands to Vagrant, invokable. This page documents how to organize the file structure of your plugin and distribute it so that it is installable using <a href="./../../v2/plugins/usage.html">standard installation methods</a>. Prior to reading this, you should be familiar with the <a href="./../../v2/plugins/development-basics.html">plugin development basics</a>.</p>
                  <div class="alert alert-warn">
                    <p><strong>Warning: Advanced Topic!</strong> Developing plugins is an advanced topic that only experienced Vagrant users who are reasonably comfortable with Ruby should approach. </p>
                  </div>
                  <h2>Example Plugin</h2>
                  <p>The best way to describe packaging and distribution is to look at how another plugin does it. The best example plugin available for this is <a href="https://github.com/mitchellh/vagrant-aws">vagrant-aws</a>.</p>
                  <p>By using <a href="./../..//gembundler.com">Bundler</a> and Rake, building a new vagrant-aws package is easy. By simply calling <code>rake package</code>, a <code>gem</code> file is dropped into the directory. By calling <code>rake release</code>, the gem is built and it is uploaded to the central <a href="./../..//rubygems.org">RubyGems</a> repository so that it can be installed using <code>vagrant plugin install</code>.</p>
                  <p>Your plugin can and should be this easy, too, since you basically get this for free by using Bundler.</p>
                  <h2>Setting Up Your Project</h2>
                  <p>To setup your project, run <code>bundle gem vagrant-my-plugin</code>. This will create a <code>vagrant-my-plugin</code> directory that has the initial layout to be a RubyGem.</p>
                  <p>You should modify the <code>vagrant-my-plugin.gemspec</code> file to add any dependencies and change any metadata. View the <a href="https://github.com/mitchellh/vagrant-aws/blob/master/vagrant-aws.gemspec">vagrant-aws.gemspec</a> for a good example.</p>
                  <div class="alert alert-warn">
                    <p><strong>Do not depend on Vagrant</strong> for your gem. Vagrant is no longer distributed as a gem, and you can assume that it will always be available when your plugin is installed. </p>
                  </div>
                  <p>Next, create a <code>Rakefile</code> that has at the very least, the following contents:</p>
                  <pre>
                    <code class="ruby">require 'rubygems'
require 'bundler/setup'
Bundler::GemHelper.install_tasks
</code>
                  </pre>
                  <p>If you run <code>rake -T</code> now, which lists all the available rake tasks, you should see that you have the <code>package</code> and <code>release</code> tasks. You can now develop your plugin and build it!</p>
                  <p>You can view the <a href="https://github.com/mitchellh/vagrant-aws/blob/master/Rakefile">vagrant-aws Rakefile</a> for a more comprehensive example that includes testing.</p>
                  <h2>Testing Your Plugin</h2>
                  <p>You have a couple options for testing your plugin. First, you can run <code>rake package</code>, then <code>vagrant plugin install</code> the resulting file to test it. The downside of this is that there is a pretty slow feedback loop every time you want to test the plugin.</p>
                  <p>Alternatively, you can depend on Vagrant from your Gemfile for development purposes only. Then you can use <code>bundle exec vagrant</code> and a Vagrantfile in your own directory to test it. This has a fast feedback loop, but requires that Vagrant has all the dependencies it needs installed on your system.</p>
                  <p>vagrant-aws uses the second option. You can see the dependency in the <a href="https://github.com/mitchellh/vagrant-aws/blob/master/Gemfile">Gemfile</a>. The Vagrantfile is gitignored so that sensitive and volatile test information can be put into it. The important bit is that the Vagrantfile must have a <code>Vagrant.require_plugin</code> call so that it is loaded, since Vagrant doesn't automatically know about plugins not installed using <code>vagrant plugin</code>.</p>
                  <p>For example, a vagrant-aws development Vagrantfile might look like this:</p>
                  <pre>
                    <code class="ruby">Vagrant.require_plugin "vagrant-aws"

Vagrant.configure("2") do |config|
  config.vm.box = "test"
end
</code>
                  </pre>
                  <p>Then you can run <code>bundle exec vagrant up</code> to test it. Note the "bundle exec" is required so that Bundler uses the proper Vagrant installation.</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <footer>
        <div class="container">
          <div class="row">
            <div class="span12">
              <ul class="unstyled footer-nav">
                <li>
                  <a href="./../..//docs.vagrantup.com/">Documentation</a>
                </li>
                <li>
                  <a href="./../..//www.vagrantup.com/about">About</a>
                </li>
                <li>
                  <a href="./../..//www.vagrantup.com/support">Support</a>
                </li>
                <a href="./../..//downloads.vagrantup.com/">
                  <li class="button inline-button">Download</li>
                </a>
              </ul>
              <ul class="unstyled logos">
                <a href="./../..//www.vagrantup.com">
                  <li class="vagrant-logo-monochrome"></li>
                </a>
                <li>
                  <span>by</span>
                </li>
                <a href="./../..//www.hashicorp.com">
                  <li class="hashi-logo-monochrome "></li>
                </a>
              </ul>
            </div>
          </div>
          <div class="row">
            <h6 class="legal"> &#169; 2013 HashiCorp </h6>
          </div>
        </div>
      </footer>
    </div>
    <script>
<![CDATA[
			$(".big-background").backstretch("assets/photos/full_width.jpg");
		]]>
    </script>
  </body>
</html>
